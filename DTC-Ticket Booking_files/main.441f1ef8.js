/*! For license information please see main.441f1ef8.js.LICENSE.txt */
(()=>{var g={8177:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3713),C(3074),C(8228),C(3650),function(){var g=A,I=g.lib.BlockCipher,C=g.algo,e=[],l=[],t=[],n=[],o=[],a=[],c=[],d=[],i=[],s=[];!function(){for(var g=[],I=0;I<256;I++)g[I]=I<128?I<<1:I<<1^283;var C=0,A=0;for(I=0;I<256;I++){var r=A^A<<1^A<<2^A<<3^A<<4;r=r>>>8^255&r^99,e[C]=r,l[r]=C;var b=g[C],m=g[b],Z=g[m],u=257*g[r]^16843008*r;t[C]=u<<24|u>>>8,n[C]=u<<16|u>>>16,o[C]=u<<8|u>>>24,a[C]=u,u=16843009*Z^65537*m^257*b^16843008*C,c[r]=u<<24|u>>>8,d[r]=u<<16|u>>>16,i[r]=u<<8|u>>>24,s[r]=u,C?(C=b^g[g[g[Z^b]]],A^=g[g[A]]):C=A=1}}();var r=[0,1,2,4,8,16,32,64,128,27,54],b=C.AES=I.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var g=this._keyPriorReset=this._key,I=g.words,C=g.sigBytes/4,l=4*((this._nRounds=C+6)+1),A=this._keySchedule=[],t=0;t<l;t++)t<C?A[t]=I[t]:(a=A[t-1],t%C?C>6&&t%C==4&&(a=e[a>>>24]<<24|e[a>>>16&255]<<16|e[a>>>8&255]<<8|e[255&a]):(a=e[(a=a<<8|a>>>24)>>>24]<<24|e[a>>>16&255]<<16|e[a>>>8&255]<<8|e[255&a],a^=r[t/C|0]<<24),A[t]=A[t-C]^a);for(var n=this._invKeySchedule=[],o=0;o<l;o++){if(t=l-o,o%4)var a=A[t];else a=A[t-4];n[o]=o<4||t<=4?a:c[e[a>>>24]]^d[e[a>>>16&255]]^i[e[a>>>8&255]]^s[e[255&a]]}}},encryptBlock:function(g,I){this._doCryptBlock(g,I,this._keySchedule,t,n,o,a,e)},decryptBlock:function(g,I){var C=g[I+1];g[I+1]=g[I+3],g[I+3]=C,this._doCryptBlock(g,I,this._invKeySchedule,c,d,i,s,l),C=g[I+1],g[I+1]=g[I+3],g[I+3]=C},_doCryptBlock:function(g,I,C,e,l,A,t,n){for(var o=this._nRounds,a=g[I]^C[0],c=g[I+1]^C[1],d=g[I+2]^C[2],i=g[I+3]^C[3],s=4,r=1;r<o;r++){var b=e[a>>>24]^l[c>>>16&255]^A[d>>>8&255]^t[255&i]^C[s++],m=e[c>>>24]^l[d>>>16&255]^A[i>>>8&255]^t[255&a]^C[s++],Z=e[d>>>24]^l[i>>>16&255]^A[a>>>8&255]^t[255&c]^C[s++],u=e[i>>>24]^l[a>>>16&255]^A[c>>>8&255]^t[255&d]^C[s++];a=b,c=m,d=Z,i=u}b=(n[a>>>24]<<24|n[c>>>16&255]<<16|n[d>>>8&255]<<8|n[255&i])^C[s++],m=(n[c>>>24]<<24|n[d>>>16&255]<<16|n[i>>>8&255]<<8|n[255&a])^C[s++],Z=(n[d>>>24]<<24|n[i>>>16&255]<<16|n[a>>>8&255]<<8|n[255&c])^C[s++],u=(n[i>>>24]<<24|n[a>>>16&255]<<16|n[c>>>8&255]<<8|n[255&d])^C[s++],g[I]=b,g[I+1]=m,g[I+2]=Z,g[I+3]=u},keySize:8});g.AES=I._createHelper(b)}(),A.AES)}()},3068:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3713),C(3074),C(8228),C(3650),function(){var g=A,I=g.lib.BlockCipher,C=g.algo;const e=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],t=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var n={pbox:[],sbox:[]};function o(g,I){let C=I>>24&255,e=I>>16&255,l=I>>8&255,A=255&I,t=g.sbox[0][C]+g.sbox[1][e];return t^=g.sbox[2][l],t+=g.sbox[3][A],t}function a(g,I,C){let l,A=I,t=C;for(let n=0;n<e;++n)A^=g.pbox[n],t=o(g,A)^t,l=A,A=t,t=l;return l=A,A=t,t=l,t^=g.pbox[e],A^=g.pbox[e+1],{left:A,right:t}}function c(g,I,C){let l,A=I,t=C;for(let n=e+1;n>1;--n)A^=g.pbox[n],t=o(g,A)^t,l=A,A=t,t=l;return l=A,A=t,t=l,t^=g.pbox[1],A^=g.pbox[0],{left:A,right:t}}function d(g,I,C){for(let e=0;e<4;e++){g.sbox[e]=[];for(let I=0;I<256;I++)g.sbox[e][I]=t[e][I]}let A=0;for(let t=0;t<e+2;t++)g.pbox[t]=l[t]^I[A],A++,A>=C&&(A=0);let n=0,o=0,c=0;for(let l=0;l<e+2;l+=2)c=a(g,n,o),n=c.left,o=c.right,g.pbox[l]=n,g.pbox[l+1]=o;for(let e=0;e<4;e++)for(let I=0;I<256;I+=2)c=a(g,n,o),n=c.left,o=c.right,g.sbox[e][I]=n,g.sbox[e][I+1]=o;return!0}var i=C.Blowfish=I.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var g=this._keyPriorReset=this._key,I=g.words,C=g.sigBytes/4;d(n,I,C)}},encryptBlock:function(g,I){var C=a(n,g[I],g[I+1]);g[I]=C.left,g[I+1]=C.right},decryptBlock:function(g,I){var C=c(n,g[I],g[I+1]);g[I]=C.left,g[I+1]=C.right},blockSize:2,keySize:4,ivSize:2});g.Blowfish=I._createHelper(i)}(),A.Blowfish)}()},3650:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(8228),void(A.lib.Cipher||function(g){var I=A,C=I.lib,e=C.Base,l=C.WordArray,t=C.BufferedBlockAlgorithm,n=I.enc,o=(n.Utf8,n.Base64),a=I.algo.EvpKDF,c=C.Cipher=t.extend({cfg:e.extend(),createEncryptor:function(g,I){return this.create(this._ENC_XFORM_MODE,g,I)},createDecryptor:function(g,I){return this.create(this._DEC_XFORM_MODE,g,I)},init:function(g,I,C){this.cfg=this.cfg.extend(C),this._xformMode=g,this._key=I,this.reset()},reset:function(){t.reset.call(this),this._doReset()},process:function(g){return this._append(g),this._process()},finalize:function(g){return g&&this._append(g),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function g(g){return"string"==typeof g?G:Z}return function(I){return{encrypt:function(C,e,l){return g(e).encrypt(I,C,e,l)},decrypt:function(C,e,l){return g(e).decrypt(I,C,e,l)}}}}()}),d=(C.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),I.mode={}),i=C.BlockCipherMode=e.extend({createEncryptor:function(g,I){return this.Encryptor.create(g,I)},createDecryptor:function(g,I){return this.Decryptor.create(g,I)},init:function(g,I){this._cipher=g,this._iv=I}}),s=d.CBC=function(){var I=i.extend();function C(I,C,e){var l,A=this._iv;A?(l=A,this._iv=g):l=this._prevBlock;for(var t=0;t<e;t++)I[C+t]^=l[t]}return I.Encryptor=I.extend({processBlock:function(g,I){var e=this._cipher,l=e.blockSize;C.call(this,g,I,l),e.encryptBlock(g,I),this._prevBlock=g.slice(I,I+l)}}),I.Decryptor=I.extend({processBlock:function(g,I){var e=this._cipher,l=e.blockSize,A=g.slice(I,I+l);e.decryptBlock(g,I),C.call(this,g,I,l),this._prevBlock=A}}),I}(),r=(I.pad={}).Pkcs7={pad:function(g,I){for(var C=4*I,e=C-g.sigBytes%C,A=e<<24|e<<16|e<<8|e,t=[],n=0;n<e;n+=4)t.push(A);var o=l.create(t,e);g.concat(o)},unpad:function(g){var I=255&g.words[g.sigBytes-1>>>2];g.sigBytes-=I}},b=(C.BlockCipher=c.extend({cfg:c.cfg.extend({mode:s,padding:r}),reset:function(){var g;c.reset.call(this);var I=this.cfg,C=I.iv,e=I.mode;this._xformMode==this._ENC_XFORM_MODE?g=e.createEncryptor:(g=e.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==g?this._mode.init(this,C&&C.words):(this._mode=g.call(e,this,C&&C.words),this._mode.__creator=g)},_doProcessBlock:function(g,I){this._mode.processBlock(g,I)},_doFinalize:function(){var g,I=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(I.pad(this._data,this.blockSize),g=this._process(!0)):(g=this._process(!0),I.unpad(g)),g},blockSize:4}),C.CipherParams=e.extend({init:function(g){this.mixIn(g)},toString:function(g){return(g||this.formatter).stringify(this)}})),m=(I.format={}).OpenSSL={stringify:function(g){var I=g.ciphertext,C=g.salt;return(C?l.create([1398893684,1701076831]).concat(C).concat(I):I).toString(o)},parse:function(g){var I,C=o.parse(g),e=C.words;return 1398893684==e[0]&&1701076831==e[1]&&(I=l.create(e.slice(2,4)),e.splice(0,4),C.sigBytes-=16),b.create({ciphertext:C,salt:I})}},Z=C.SerializableCipher=e.extend({cfg:e.extend({format:m}),encrypt:function(g,I,C,e){e=this.cfg.extend(e);var l=g.createEncryptor(C,e),A=l.finalize(I),t=l.cfg;return b.create({ciphertext:A,key:C,iv:t.iv,algorithm:g,mode:t.mode,padding:t.padding,blockSize:g.blockSize,formatter:e.format})},decrypt:function(g,I,C,e){return e=this.cfg.extend(e),I=this._parse(I,e.format),g.createDecryptor(C,e).finalize(I.ciphertext)},_parse:function(g,I){return"string"==typeof g?I.parse(g,this):g}}),u=(I.kdf={}).OpenSSL={execute:function(g,I,C,e,A){if(e||(e=l.random(8)),A)t=a.create({keySize:I+C,hasher:A}).compute(g,e);else var t=a.create({keySize:I+C}).compute(g,e);var n=l.create(t.words.slice(I),4*C);return t.sigBytes=4*I,b.create({key:t,iv:n,salt:e})}},G=C.PasswordBasedCipher=Z.extend({cfg:Z.cfg.extend({kdf:u}),encrypt:function(g,I,C,e){var l=(e=this.cfg.extend(e)).kdf.execute(C,g.keySize,g.ivSize,e.salt,e.hasher);e.iv=l.iv;var A=Z.encrypt.call(this,g,I,l.key,e);return A.mixIn(l),A},decrypt:function(g,I,C,e){e=this.cfg.extend(e),I=this._parse(I,e.format);var l=e.kdf.execute(C,g.keySize,g.ivSize,I.salt,e.hasher);return e.iv=l.iv,Z.decrypt.call(this,g,I,l.key,e)}})}()))}()},8926:function(g,I,C){g.exports=function(){var g=g||function(g,I){var e;if("undefined"!==typeof window&&window.crypto&&(e=window.crypto),"undefined"!==typeof self&&self.crypto&&(e=self.crypto),"undefined"!==typeof globalThis&&globalThis.crypto&&(e=globalThis.crypto),!e&&"undefined"!==typeof window&&window.msCrypto&&(e=window.msCrypto),!e&&"undefined"!==typeof C.g&&C.g.crypto&&(e=C.g.crypto),!e)try{e=C(2480)}catch(m){}var l=function(){if(e){if("function"===typeof e.getRandomValues)try{return e.getRandomValues(new Uint32Array(1))[0]}catch(m){}if("function"===typeof e.randomBytes)try{return e.randomBytes(4).readInt32LE()}catch(m){}}throw new Error("Native crypto module could not be used to get secure random number.")},A=Object.create||function(){function g(){}return function(I){var C;return g.prototype=I,C=new g,g.prototype=null,C}}(),t={},n=t.lib={},o=n.Base={extend:function(g){var I=A(this);return g&&I.mixIn(g),I.hasOwnProperty("init")&&this.init!==I.init||(I.init=function(){I.$super.init.apply(this,arguments)}),I.init.prototype=I,I.$super=this,I},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var I in g)g.hasOwnProperty(I)&&(this[I]=g[I]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}},a=n.WordArray=o.extend({init:function(g,C){g=this.words=g||[],this.sigBytes=C!=I?C:4*g.length},toString:function(g){return(g||d).stringify(this)},concat:function(g){var I=this.words,C=g.words,e=this.sigBytes,l=g.sigBytes;if(this.clamp(),e%4)for(var A=0;A<l;A++){var t=C[A>>>2]>>>24-A%4*8&255;I[e+A>>>2]|=t<<24-(e+A)%4*8}else for(var n=0;n<l;n+=4)I[e+n>>>2]=C[n>>>2];return this.sigBytes+=l,this},clamp:function(){var I=this.words,C=this.sigBytes;I[C>>>2]&=4294967295<<32-C%4*8,I.length=g.ceil(C/4)},clone:function(){var g=o.clone.call(this);return g.words=this.words.slice(0),g},random:function(g){for(var I=[],C=0;C<g;C+=4)I.push(l());return new a.init(I,g)}}),c=t.enc={},d=c.Hex={stringify:function(g){for(var I=g.words,C=g.sigBytes,e=[],l=0;l<C;l++){var A=I[l>>>2]>>>24-l%4*8&255;e.push((A>>>4).toString(16)),e.push((15&A).toString(16))}return e.join("")},parse:function(g){for(var I=g.length,C=[],e=0;e<I;e+=2)C[e>>>3]|=parseInt(g.substr(e,2),16)<<24-e%8*4;return new a.init(C,I/2)}},i=c.Latin1={stringify:function(g){for(var I=g.words,C=g.sigBytes,e=[],l=0;l<C;l++){var A=I[l>>>2]>>>24-l%4*8&255;e.push(String.fromCharCode(A))}return e.join("")},parse:function(g){for(var I=g.length,C=[],e=0;e<I;e++)C[e>>>2]|=(255&g.charCodeAt(e))<<24-e%4*8;return new a.init(C,I)}},s=c.Utf8={stringify:function(g){try{return decodeURIComponent(escape(i.stringify(g)))}catch(I){throw new Error("Malformed UTF-8 data")}},parse:function(g){return i.parse(unescape(encodeURIComponent(g)))}},r=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(g){"string"==typeof g&&(g=s.parse(g)),this._data.concat(g),this._nDataBytes+=g.sigBytes},_process:function(I){var C,e=this._data,l=e.words,A=e.sigBytes,t=this.blockSize,n=A/(4*t),o=(n=I?g.ceil(n):g.max((0|n)-this._minBufferSize,0))*t,c=g.min(4*o,A);if(o){for(var d=0;d<o;d+=t)this._doProcessBlock(l,d);C=l.splice(0,o),e.sigBytes-=c}return new a.init(C,c)},clone:function(){var g=o.clone.call(this);return g._data=this._data.clone(),g},_minBufferSize:0}),b=(n.Hasher=r.extend({cfg:o.extend(),init:function(g){this.cfg=this.cfg.extend(g),this.reset()},reset:function(){r.reset.call(this),this._doReset()},update:function(g){return this._append(g),this._process(),this},finalize:function(g){return g&&this._append(g),this._doFinalize()},blockSize:16,_createHelper:function(g){return function(I,C){return new g.init(C).finalize(I)}},_createHmacHelper:function(g){return function(I,C){return new b.HMAC.init(g,C).finalize(I)}}}),t.algo={});return t}(Math);return g}()},3713:function(g,I,C){!function(I,e){var l;g.exports=(l=C(8926),function(){var g=l,I=g.lib.WordArray;function C(g,C,e){for(var l=[],A=0,t=0;t<C;t++)if(t%4){var n=e[g.charCodeAt(t-1)]<<t%4*2|e[g.charCodeAt(t)]>>>6-t%4*2;l[A>>>2]|=n<<24-A%4*8,A++}return I.create(l,A)}g.enc.Base64={stringify:function(g){var I=g.words,C=g.sigBytes,e=this._map;g.clamp();for(var l=[],A=0;A<C;A+=3)for(var t=(I[A>>>2]>>>24-A%4*8&255)<<16|(I[A+1>>>2]>>>24-(A+1)%4*8&255)<<8|I[A+2>>>2]>>>24-(A+2)%4*8&255,n=0;n<4&&A+.75*n<C;n++)l.push(e.charAt(t>>>6*(3-n)&63));var o=e.charAt(64);if(o)for(;l.length%4;)l.push(o);return l.join("")},parse:function(g){var I=g.length,e=this._map,l=this._reverseMap;if(!l){l=this._reverseMap=[];for(var A=0;A<e.length;A++)l[e.charCodeAt(A)]=A}var t=e.charAt(64);if(t){var n=g.indexOf(t);-1!==n&&(I=n)}return C(g,I,l)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),l.enc.Base64)}()},4728:function(g,I,C){!function(I,e){var l;g.exports=(l=C(8926),function(){var g=l,I=g.lib.WordArray;function C(g,C,e){for(var l=[],A=0,t=0;t<C;t++)if(t%4){var n=e[g.charCodeAt(t-1)]<<t%4*2|e[g.charCodeAt(t)]>>>6-t%4*2;l[A>>>2]|=n<<24-A%4*8,A++}return I.create(l,A)}g.enc.Base64url={stringify:function(g,I){void 0===I&&(I=!0);var C=g.words,e=g.sigBytes,l=I?this._safe_map:this._map;g.clamp();for(var A=[],t=0;t<e;t+=3)for(var n=(C[t>>>2]>>>24-t%4*8&255)<<16|(C[t+1>>>2]>>>24-(t+1)%4*8&255)<<8|C[t+2>>>2]>>>24-(t+2)%4*8&255,o=0;o<4&&t+.75*o<e;o++)A.push(l.charAt(n>>>6*(3-o)&63));var a=l.charAt(64);if(a)for(;A.length%4;)A.push(a);return A.join("")},parse:function(g,I){void 0===I&&(I=!0);var e=g.length,l=I?this._safe_map:this._map,A=this._reverseMap;if(!A){A=this._reverseMap=[];for(var t=0;t<l.length;t++)A[l.charCodeAt(t)]=t}var n=l.charAt(64);if(n){var o=g.indexOf(n);-1!==o&&(e=o)}return C(g,e,A)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),l.enc.Base64url)}()},1551:function(g,I,C){!function(I,e){var l;g.exports=(l=C(8926),function(){var g=l,I=g.lib.WordArray,C=g.enc;function e(g){return g<<8&4278255360|g>>>8&16711935}C.Utf16=C.Utf16BE={stringify:function(g){for(var I=g.words,C=g.sigBytes,e=[],l=0;l<C;l+=2){var A=I[l>>>2]>>>16-l%4*8&65535;e.push(String.fromCharCode(A))}return e.join("")},parse:function(g){for(var C=g.length,e=[],l=0;l<C;l++)e[l>>>1]|=g.charCodeAt(l)<<16-l%2*16;return I.create(e,2*C)}},C.Utf16LE={stringify:function(g){for(var I=g.words,C=g.sigBytes,l=[],A=0;A<C;A+=2){var t=e(I[A>>>2]>>>16-A%4*8&65535);l.push(String.fromCharCode(t))}return l.join("")},parse:function(g){for(var C=g.length,l=[],A=0;A<C;A++)l[A>>>1]|=e(g.charCodeAt(A)<<16-A%2*16);return I.create(l,2*C)}}}(),l.enc.Utf16)}()},8228:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(5590),C(5086),function(){var g=A,I=g.lib,C=I.Base,e=I.WordArray,l=g.algo,t=l.MD5,n=l.EvpKDF=C.extend({cfg:C.extend({keySize:4,hasher:t,iterations:1}),init:function(g){this.cfg=this.cfg.extend(g)},compute:function(g,I){for(var C,l=this.cfg,A=l.hasher.create(),t=e.create(),n=t.words,o=l.keySize,a=l.iterations;n.length<o;){C&&A.update(C),C=A.update(g).finalize(I),A.reset();for(var c=1;c<a;c++)C=A.finalize(C),A.reset();t.concat(C)}return t.sigBytes=4*o,t}});g.EvpKDF=function(g,I,C){return n.create(C).compute(g,I)}}(),A.EvpKDF)}()},1863:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),function(g){var I=A,C=I.lib.CipherParams,e=I.enc.Hex;I.format.Hex={stringify:function(g){return g.ciphertext.toString(e)},parse:function(g){var I=e.parse(g);return C.create({ciphertext:I})}}}(),A.format.Hex)}()},5086:function(g,I,C){!function(I,e){var l;g.exports=(l=C(8926),void function(){var g=l,I=g.lib.Base,C=g.enc.Utf8;g.algo.HMAC=I.extend({init:function(g,I){g=this._hasher=new g.init,"string"==typeof I&&(I=C.parse(I));var e=g.blockSize,l=4*e;I.sigBytes>l&&(I=g.finalize(I)),I.clamp();for(var A=this._oKey=I.clone(),t=this._iKey=I.clone(),n=A.words,o=t.words,a=0;a<e;a++)n[a]^=1549556828,o[a]^=909522486;A.sigBytes=t.sigBytes=l,this.reset()},reset:function(){var g=this._hasher;g.reset(),g.update(this._iKey)},update:function(g){return this._hasher.update(g),this},finalize:function(g){var I=this._hasher,C=I.finalize(g);return I.reset(),I.finalize(this._oKey.clone().concat(C))}})}())}()},9704:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3646),C(5533),C(1551),C(3713),C(4728),C(3074),C(5590),C(9517),C(3183),C(4345),C(6319),C(6853),C(77),C(5086),C(3822),C(8228),C(3650),C(5152),C(2992),C(7223),C(5858),C(130),C(2409),C(4823),C(6644),C(1181),C(8413),C(1863),C(8177),C(2550),C(1325),C(2639),C(2130),C(3068),A)}()},5533:function(g,I,C){!function(I,e){var l;g.exports=(l=C(8926),function(){if("function"==typeof ArrayBuffer){var g=l.lib.WordArray,I=g.init,C=g.init=function(g){if(g instanceof ArrayBuffer&&(g=new Uint8Array(g)),(g instanceof Int8Array||"undefined"!==typeof Uint8ClampedArray&&g instanceof Uint8ClampedArray||g instanceof Int16Array||g instanceof Uint16Array||g instanceof Int32Array||g instanceof Uint32Array||g instanceof Float32Array||g instanceof Float64Array)&&(g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength)),g instanceof Uint8Array){for(var C=g.byteLength,e=[],l=0;l<C;l++)e[l>>>2]|=g[l]<<24-l%4*8;I.call(this,e,C)}else I.apply(this,arguments)};C.prototype=g}}(),l.lib.WordArray)}()},3074:function(g,I,C){!function(I,e){var l;g.exports=(l=C(8926),function(g){var I=l,C=I.lib,e=C.WordArray,A=C.Hasher,t=I.algo,n=[];!function(){for(var I=0;I<64;I++)n[I]=4294967296*g.abs(g.sin(I+1))|0}();var o=t.MD5=A.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,I){for(var C=0;C<16;C++){var e=I+C,l=g[e];g[e]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var A=this._hash.words,t=g[I+0],o=g[I+1],s=g[I+2],r=g[I+3],b=g[I+4],m=g[I+5],Z=g[I+6],u=g[I+7],G=g[I+8],B=g[I+9],h=g[I+10],p=g[I+11],y=g[I+12],W=g[I+13],V=g[I+14],S=g[I+15],X=A[0],R=A[1],k=A[2],J=A[3];X=a(X,R,k,J,t,7,n[0]),J=a(J,X,R,k,o,12,n[1]),k=a(k,J,X,R,s,17,n[2]),R=a(R,k,J,X,r,22,n[3]),X=a(X,R,k,J,b,7,n[4]),J=a(J,X,R,k,m,12,n[5]),k=a(k,J,X,R,Z,17,n[6]),R=a(R,k,J,X,u,22,n[7]),X=a(X,R,k,J,G,7,n[8]),J=a(J,X,R,k,B,12,n[9]),k=a(k,J,X,R,h,17,n[10]),R=a(R,k,J,X,p,22,n[11]),X=a(X,R,k,J,y,7,n[12]),J=a(J,X,R,k,W,12,n[13]),k=a(k,J,X,R,V,17,n[14]),X=c(X,R=a(R,k,J,X,S,22,n[15]),k,J,o,5,n[16]),J=c(J,X,R,k,Z,9,n[17]),k=c(k,J,X,R,p,14,n[18]),R=c(R,k,J,X,t,20,n[19]),X=c(X,R,k,J,m,5,n[20]),J=c(J,X,R,k,h,9,n[21]),k=c(k,J,X,R,S,14,n[22]),R=c(R,k,J,X,b,20,n[23]),X=c(X,R,k,J,B,5,n[24]),J=c(J,X,R,k,V,9,n[25]),k=c(k,J,X,R,r,14,n[26]),R=c(R,k,J,X,G,20,n[27]),X=c(X,R,k,J,W,5,n[28]),J=c(J,X,R,k,s,9,n[29]),k=c(k,J,X,R,u,14,n[30]),X=d(X,R=c(R,k,J,X,y,20,n[31]),k,J,m,4,n[32]),J=d(J,X,R,k,G,11,n[33]),k=d(k,J,X,R,p,16,n[34]),R=d(R,k,J,X,V,23,n[35]),X=d(X,R,k,J,o,4,n[36]),J=d(J,X,R,k,b,11,n[37]),k=d(k,J,X,R,u,16,n[38]),R=d(R,k,J,X,h,23,n[39]),X=d(X,R,k,J,W,4,n[40]),J=d(J,X,R,k,t,11,n[41]),k=d(k,J,X,R,r,16,n[42]),R=d(R,k,J,X,Z,23,n[43]),X=d(X,R,k,J,B,4,n[44]),J=d(J,X,R,k,y,11,n[45]),k=d(k,J,X,R,S,16,n[46]),X=i(X,R=d(R,k,J,X,s,23,n[47]),k,J,t,6,n[48]),J=i(J,X,R,k,u,10,n[49]),k=i(k,J,X,R,V,15,n[50]),R=i(R,k,J,X,m,21,n[51]),X=i(X,R,k,J,y,6,n[52]),J=i(J,X,R,k,r,10,n[53]),k=i(k,J,X,R,h,15,n[54]),R=i(R,k,J,X,o,21,n[55]),X=i(X,R,k,J,G,6,n[56]),J=i(J,X,R,k,S,10,n[57]),k=i(k,J,X,R,Z,15,n[58]),R=i(R,k,J,X,W,21,n[59]),X=i(X,R,k,J,b,6,n[60]),J=i(J,X,R,k,p,10,n[61]),k=i(k,J,X,R,s,15,n[62]),R=i(R,k,J,X,B,21,n[63]),A[0]=A[0]+X|0,A[1]=A[1]+R|0,A[2]=A[2]+k|0,A[3]=A[3]+J|0},_doFinalize:function(){var I=this._data,C=I.words,e=8*this._nDataBytes,l=8*I.sigBytes;C[l>>>5]|=128<<24-l%32;var A=g.floor(e/4294967296),t=e;C[15+(l+64>>>9<<4)]=16711935&(A<<8|A>>>24)|4278255360&(A<<24|A>>>8),C[14+(l+64>>>9<<4)]=16711935&(t<<8|t>>>24)|4278255360&(t<<24|t>>>8),I.sigBytes=4*(C.length+1),this._process();for(var n=this._hash,o=n.words,a=0;a<4;a++){var c=o[a];o[a]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return n},clone:function(){var g=A.clone.call(this);return g._hash=this._hash.clone(),g}});function a(g,I,C,e,l,A,t){var n=g+(I&C|~I&e)+l+t;return(n<<A|n>>>32-A)+I}function c(g,I,C,e,l,A,t){var n=g+(I&e|C&~e)+l+t;return(n<<A|n>>>32-A)+I}function d(g,I,C,e,l,A,t){var n=g+(I^C^e)+l+t;return(n<<A|n>>>32-A)+I}function i(g,I,C,e,l,A,t){var n=g+(C^(I|~e))+l+t;return(n<<A|n>>>32-A)+I}I.MD5=A._createHelper(o),I.HmacMD5=A._createHmacHelper(o)}(Math),l.MD5)}()},5152:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),A.mode.CFB=function(){var g=A.lib.BlockCipherMode.extend();function I(g,I,C,e){var l,A=this._iv;A?(l=A.slice(0),this._iv=void 0):l=this._prevBlock,e.encryptBlock(l,0);for(var t=0;t<C;t++)g[I+t]^=l[t]}return g.Encryptor=g.extend({processBlock:function(g,C){var e=this._cipher,l=e.blockSize;I.call(this,g,C,l,e),this._prevBlock=g.slice(C,C+l)}}),g.Decryptor=g.extend({processBlock:function(g,C){var e=this._cipher,l=e.blockSize,A=g.slice(C,C+l);I.call(this,g,C,l,e),this._prevBlock=A}}),g}(),A.mode.CFB)}()},7223:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),A.mode.CTRGladman=function(){var g=A.lib.BlockCipherMode.extend();function I(g){if(255===(g>>24&255)){var I=g>>16&255,C=g>>8&255,e=255&g;255===I?(I=0,255===C?(C=0,255===e?e=0:++e):++C):++I,g=0,g+=I<<16,g+=C<<8,g+=e}else g+=1<<24;return g}function C(g){return 0===(g[0]=I(g[0]))&&(g[1]=I(g[1])),g}var e=g.Encryptor=g.extend({processBlock:function(g,I){var e=this._cipher,l=e.blockSize,A=this._iv,t=this._counter;A&&(t=this._counter=A.slice(0),this._iv=void 0),C(t);var n=t.slice(0);e.encryptBlock(n,0);for(var o=0;o<l;o++)g[I+o]^=n[o]}});return g.Decryptor=e,g}(),A.mode.CTRGladman)}()},2992:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),A.mode.CTR=function(){var g=A.lib.BlockCipherMode.extend(),I=g.Encryptor=g.extend({processBlock:function(g,I){var C=this._cipher,e=C.blockSize,l=this._iv,A=this._counter;l&&(A=this._counter=l.slice(0),this._iv=void 0);var t=A.slice(0);C.encryptBlock(t,0),A[e-1]=A[e-1]+1|0;for(var n=0;n<e;n++)g[I+n]^=t[n]}});return g.Decryptor=I,g}(),A.mode.CTR)}()},130:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),A.mode.ECB=function(){var g=A.lib.BlockCipherMode.extend();return g.Encryptor=g.extend({processBlock:function(g,I){this._cipher.encryptBlock(g,I)}}),g.Decryptor=g.extend({processBlock:function(g,I){this._cipher.decryptBlock(g,I)}}),g}(),A.mode.ECB)}()},5858:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),A.mode.OFB=function(){var g=A.lib.BlockCipherMode.extend(),I=g.Encryptor=g.extend({processBlock:function(g,I){var C=this._cipher,e=C.blockSize,l=this._iv,A=this._keystream;l&&(A=this._keystream=l.slice(0),this._iv=void 0),C.encryptBlock(A,0);for(var t=0;t<e;t++)g[I+t]^=A[t]}});return g.Decryptor=I,g}(),A.mode.OFB)}()},2409:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),A.pad.AnsiX923={pad:function(g,I){var C=g.sigBytes,e=4*I,l=e-C%e,A=C+l-1;g.clamp(),g.words[A>>>2]|=l<<24-A%4*8,g.sigBytes+=l},unpad:function(g){var I=255&g.words[g.sigBytes-1>>>2];g.sigBytes-=I}},A.pad.Ansix923)}()},4823:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),A.pad.Iso10126={pad:function(g,I){var C=4*I,e=C-g.sigBytes%C;g.concat(A.lib.WordArray.random(e-1)).concat(A.lib.WordArray.create([e<<24],1))},unpad:function(g){var I=255&g.words[g.sigBytes-1>>>2];g.sigBytes-=I}},A.pad.Iso10126)}()},6644:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),A.pad.Iso97971={pad:function(g,I){g.concat(A.lib.WordArray.create([2147483648],1)),A.pad.ZeroPadding.pad(g,I)},unpad:function(g){A.pad.ZeroPadding.unpad(g),g.sigBytes--}},A.pad.Iso97971)}()},8413:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),A.pad.NoPadding={pad:function(){},unpad:function(){}},A.pad.NoPadding)}()},1181:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3650),A.pad.ZeroPadding={pad:function(g,I){var C=4*I;g.clamp(),g.sigBytes+=C-(g.sigBytes%C||C)},unpad:function(g){var I=g.words,C=g.sigBytes-1;for(C=g.sigBytes-1;C>=0;C--)if(I[C>>>2]>>>24-C%4*8&255){g.sigBytes=C+1;break}}},A.pad.ZeroPadding)}()},3822:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(9517),C(5086),function(){var g=A,I=g.lib,C=I.Base,e=I.WordArray,l=g.algo,t=l.SHA256,n=l.HMAC,o=l.PBKDF2=C.extend({cfg:C.extend({keySize:4,hasher:t,iterations:25e4}),init:function(g){this.cfg=this.cfg.extend(g)},compute:function(g,I){for(var C=this.cfg,l=n.create(C.hasher,g),A=e.create(),t=e.create([1]),o=A.words,a=t.words,c=C.keySize,d=C.iterations;o.length<c;){var i=l.update(I).finalize(t);l.reset();for(var s=i.words,r=s.length,b=i,m=1;m<d;m++){b=l.finalize(b),l.reset();for(var Z=b.words,u=0;u<r;u++)s[u]^=Z[u]}A.concat(i),a[0]++}return A.sigBytes=4*c,A}});g.PBKDF2=function(g,I,C){return o.create(C).compute(g,I)}}(),A.PBKDF2)}()},2130:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3713),C(3074),C(8228),C(3650),function(){var g=A,I=g.lib.StreamCipher,C=g.algo,e=[],l=[],t=[],n=C.RabbitLegacy=I.extend({_doReset:function(){var g=this._key.words,I=this.cfg.iv,C=this._X=[g[0],g[3]<<16|g[2]>>>16,g[1],g[0]<<16|g[3]>>>16,g[2],g[1]<<16|g[0]>>>16,g[3],g[2]<<16|g[1]>>>16],e=this._C=[g[2]<<16|g[2]>>>16,4294901760&g[0]|65535&g[1],g[3]<<16|g[3]>>>16,4294901760&g[1]|65535&g[2],g[0]<<16|g[0]>>>16,4294901760&g[2]|65535&g[3],g[1]<<16|g[1]>>>16,4294901760&g[3]|65535&g[0]];this._b=0;for(var l=0;l<4;l++)o.call(this);for(l=0;l<8;l++)e[l]^=C[l+4&7];if(I){var A=I.words,t=A[0],n=A[1],a=16711935&(t<<8|t>>>24)|4278255360&(t<<24|t>>>8),c=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),d=a>>>16|4294901760&c,i=c<<16|65535&a;for(e[0]^=a,e[1]^=d,e[2]^=c,e[3]^=i,e[4]^=a,e[5]^=d,e[6]^=c,e[7]^=i,l=0;l<4;l++)o.call(this)}},_doProcessBlock:function(g,I){var C=this._X;o.call(this),e[0]=C[0]^C[5]>>>16^C[3]<<16,e[1]=C[2]^C[7]>>>16^C[5]<<16,e[2]=C[4]^C[1]>>>16^C[7]<<16,e[3]=C[6]^C[3]>>>16^C[1]<<16;for(var l=0;l<4;l++)e[l]=16711935&(e[l]<<8|e[l]>>>24)|4278255360&(e[l]<<24|e[l]>>>8),g[I+l]^=e[l]},blockSize:4,ivSize:2});function o(){for(var g=this._X,I=this._C,C=0;C<8;C++)l[C]=I[C];for(I[0]=I[0]+1295307597+this._b|0,I[1]=I[1]+3545052371+(I[0]>>>0<l[0]>>>0?1:0)|0,I[2]=I[2]+886263092+(I[1]>>>0<l[1]>>>0?1:0)|0,I[3]=I[3]+1295307597+(I[2]>>>0<l[2]>>>0?1:0)|0,I[4]=I[4]+3545052371+(I[3]>>>0<l[3]>>>0?1:0)|0,I[5]=I[5]+886263092+(I[4]>>>0<l[4]>>>0?1:0)|0,I[6]=I[6]+1295307597+(I[5]>>>0<l[5]>>>0?1:0)|0,I[7]=I[7]+3545052371+(I[6]>>>0<l[6]>>>0?1:0)|0,this._b=I[7]>>>0<l[7]>>>0?1:0,C=0;C<8;C++){var e=g[C]+I[C],A=65535&e,n=e>>>16,o=((A*A>>>17)+A*n>>>15)+n*n,a=((4294901760&e)*e|0)+((65535&e)*e|0);t[C]=o^a}g[0]=t[0]+(t[7]<<16|t[7]>>>16)+(t[6]<<16|t[6]>>>16)|0,g[1]=t[1]+(t[0]<<8|t[0]>>>24)+t[7]|0,g[2]=t[2]+(t[1]<<16|t[1]>>>16)+(t[0]<<16|t[0]>>>16)|0,g[3]=t[3]+(t[2]<<8|t[2]>>>24)+t[1]|0,g[4]=t[4]+(t[3]<<16|t[3]>>>16)+(t[2]<<16|t[2]>>>16)|0,g[5]=t[5]+(t[4]<<8|t[4]>>>24)+t[3]|0,g[6]=t[6]+(t[5]<<16|t[5]>>>16)+(t[4]<<16|t[4]>>>16)|0,g[7]=t[7]+(t[6]<<8|t[6]>>>24)+t[5]|0}g.RabbitLegacy=I._createHelper(n)}(),A.RabbitLegacy)}()},2639:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3713),C(3074),C(8228),C(3650),function(){var g=A,I=g.lib.StreamCipher,C=g.algo,e=[],l=[],t=[],n=C.Rabbit=I.extend({_doReset:function(){for(var g=this._key.words,I=this.cfg.iv,C=0;C<4;C++)g[C]=16711935&(g[C]<<8|g[C]>>>24)|4278255360&(g[C]<<24|g[C]>>>8);var e=this._X=[g[0],g[3]<<16|g[2]>>>16,g[1],g[0]<<16|g[3]>>>16,g[2],g[1]<<16|g[0]>>>16,g[3],g[2]<<16|g[1]>>>16],l=this._C=[g[2]<<16|g[2]>>>16,4294901760&g[0]|65535&g[1],g[3]<<16|g[3]>>>16,4294901760&g[1]|65535&g[2],g[0]<<16|g[0]>>>16,4294901760&g[2]|65535&g[3],g[1]<<16|g[1]>>>16,4294901760&g[3]|65535&g[0]];for(this._b=0,C=0;C<4;C++)o.call(this);for(C=0;C<8;C++)l[C]^=e[C+4&7];if(I){var A=I.words,t=A[0],n=A[1],a=16711935&(t<<8|t>>>24)|4278255360&(t<<24|t>>>8),c=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),d=a>>>16|4294901760&c,i=c<<16|65535&a;for(l[0]^=a,l[1]^=d,l[2]^=c,l[3]^=i,l[4]^=a,l[5]^=d,l[6]^=c,l[7]^=i,C=0;C<4;C++)o.call(this)}},_doProcessBlock:function(g,I){var C=this._X;o.call(this),e[0]=C[0]^C[5]>>>16^C[3]<<16,e[1]=C[2]^C[7]>>>16^C[5]<<16,e[2]=C[4]^C[1]>>>16^C[7]<<16,e[3]=C[6]^C[3]>>>16^C[1]<<16;for(var l=0;l<4;l++)e[l]=16711935&(e[l]<<8|e[l]>>>24)|4278255360&(e[l]<<24|e[l]>>>8),g[I+l]^=e[l]},blockSize:4,ivSize:2});function o(){for(var g=this._X,I=this._C,C=0;C<8;C++)l[C]=I[C];for(I[0]=I[0]+1295307597+this._b|0,I[1]=I[1]+3545052371+(I[0]>>>0<l[0]>>>0?1:0)|0,I[2]=I[2]+886263092+(I[1]>>>0<l[1]>>>0?1:0)|0,I[3]=I[3]+1295307597+(I[2]>>>0<l[2]>>>0?1:0)|0,I[4]=I[4]+3545052371+(I[3]>>>0<l[3]>>>0?1:0)|0,I[5]=I[5]+886263092+(I[4]>>>0<l[4]>>>0?1:0)|0,I[6]=I[6]+1295307597+(I[5]>>>0<l[5]>>>0?1:0)|0,I[7]=I[7]+3545052371+(I[6]>>>0<l[6]>>>0?1:0)|0,this._b=I[7]>>>0<l[7]>>>0?1:0,C=0;C<8;C++){var e=g[C]+I[C],A=65535&e,n=e>>>16,o=((A*A>>>17)+A*n>>>15)+n*n,a=((4294901760&e)*e|0)+((65535&e)*e|0);t[C]=o^a}g[0]=t[0]+(t[7]<<16|t[7]>>>16)+(t[6]<<16|t[6]>>>16)|0,g[1]=t[1]+(t[0]<<8|t[0]>>>24)+t[7]|0,g[2]=t[2]+(t[1]<<16|t[1]>>>16)+(t[0]<<16|t[0]>>>16)|0,g[3]=t[3]+(t[2]<<8|t[2]>>>24)+t[1]|0,g[4]=t[4]+(t[3]<<16|t[3]>>>16)+(t[2]<<16|t[2]>>>16)|0,g[5]=t[5]+(t[4]<<8|t[4]>>>24)+t[3]|0,g[6]=t[6]+(t[5]<<16|t[5]>>>16)+(t[4]<<16|t[4]>>>16)|0,g[7]=t[7]+(t[6]<<8|t[6]>>>24)+t[5]|0}g.Rabbit=I._createHelper(n)}(),A.Rabbit)}()},1325:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3713),C(3074),C(8228),C(3650),function(){var g=A,I=g.lib.StreamCipher,C=g.algo,e=C.RC4=I.extend({_doReset:function(){for(var g=this._key,I=g.words,C=g.sigBytes,e=this._S=[],l=0;l<256;l++)e[l]=l;l=0;for(var A=0;l<256;l++){var t=l%C,n=I[t>>>2]>>>24-t%4*8&255;A=(A+e[l]+n)%256;var o=e[l];e[l]=e[A],e[A]=o}this._i=this._j=0},_doProcessBlock:function(g,I){g[I]^=l.call(this)},keySize:8,ivSize:0});function l(){for(var g=this._S,I=this._i,C=this._j,e=0,l=0;l<4;l++){C=(C+g[I=(I+1)%256])%256;var A=g[I];g[I]=g[C],g[C]=A,e|=g[(g[I]+g[C])%256]<<24-8*l}return this._i=I,this._j=C,e}g.RC4=I._createHelper(e);var t=C.RC4Drop=e.extend({cfg:e.cfg.extend({drop:192}),_doReset:function(){e._doReset.call(this);for(var g=this.cfg.drop;g>0;g--)l.call(this)}});g.RC4Drop=I._createHelper(t)}(),A.RC4)}()},77:function(g,I,C){!function(I,e){var l;g.exports=(l=C(8926),function(g){var I=l,C=I.lib,e=C.WordArray,A=C.Hasher,t=I.algo,n=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),o=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),a=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),c=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=e.create([0,1518500249,1859775393,2400959708,2840853838]),i=e.create([1352829926,1548603684,1836072691,2053994217,0]),s=t.RIPEMD160=A.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(g,I){for(var C=0;C<16;C++){var e=I+C,l=g[e];g[e]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var A,t,s,B,h,p,y,W,V,S,X,R=this._hash.words,k=d.words,J=i.words,Y=n.words,v=o.words,H=a.words,N=c.words;for(p=A=R[0],y=t=R[1],W=s=R[2],V=B=R[3],S=h=R[4],C=0;C<80;C+=1)X=A+g[I+Y[C]]|0,X+=C<16?r(t,s,B)+k[0]:C<32?b(t,s,B)+k[1]:C<48?m(t,s,B)+k[2]:C<64?Z(t,s,B)+k[3]:u(t,s,B)+k[4],X=(X=G(X|=0,H[C]))+h|0,A=h,h=B,B=G(s,10),s=t,t=X,X=p+g[I+v[C]]|0,X+=C<16?u(y,W,V)+J[0]:C<32?Z(y,W,V)+J[1]:C<48?m(y,W,V)+J[2]:C<64?b(y,W,V)+J[3]:r(y,W,V)+J[4],X=(X=G(X|=0,N[C]))+S|0,p=S,S=V,V=G(W,10),W=y,y=X;X=R[1]+s+V|0,R[1]=R[2]+B+S|0,R[2]=R[3]+h+p|0,R[3]=R[4]+A+y|0,R[4]=R[0]+t+W|0,R[0]=X},_doFinalize:function(){var g=this._data,I=g.words,C=8*this._nDataBytes,e=8*g.sigBytes;I[e>>>5]|=128<<24-e%32,I[14+(e+64>>>9<<4)]=16711935&(C<<8|C>>>24)|4278255360&(C<<24|C>>>8),g.sigBytes=4*(I.length+1),this._process();for(var l=this._hash,A=l.words,t=0;t<5;t++){var n=A[t];A[t]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}return l},clone:function(){var g=A.clone.call(this);return g._hash=this._hash.clone(),g}});function r(g,I,C){return g^I^C}function b(g,I,C){return g&I|~g&C}function m(g,I,C){return(g|~I)^C}function Z(g,I,C){return g&C|I&~C}function u(g,I,C){return g^(I|~C)}function G(g,I){return g<<I|g>>>32-I}I.RIPEMD160=A._createHelper(s),I.HmacRIPEMD160=A._createHmacHelper(s)}(Math),l.RIPEMD160)}()},5590:function(g,I,C){!function(I,e){var l;g.exports=(l=C(8926),function(){var g=l,I=g.lib,C=I.WordArray,e=I.Hasher,A=g.algo,t=[],n=A.SHA1=e.extend({_doReset:function(){this._hash=new C.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(g,I){for(var C=this._hash.words,e=C[0],l=C[1],A=C[2],n=C[3],o=C[4],a=0;a<80;a++){if(a<16)t[a]=0|g[I+a];else{var c=t[a-3]^t[a-8]^t[a-14]^t[a-16];t[a]=c<<1|c>>>31}var d=(e<<5|e>>>27)+o+t[a];d+=a<20?1518500249+(l&A|~l&n):a<40?1859775393+(l^A^n):a<60?(l&A|l&n|A&n)-1894007588:(l^A^n)-899497514,o=n,n=A,A=l<<30|l>>>2,l=e,e=d}C[0]=C[0]+e|0,C[1]=C[1]+l|0,C[2]=C[2]+A|0,C[3]=C[3]+n|0,C[4]=C[4]+o|0},_doFinalize:function(){var g=this._data,I=g.words,C=8*this._nDataBytes,e=8*g.sigBytes;return I[e>>>5]|=128<<24-e%32,I[14+(e+64>>>9<<4)]=Math.floor(C/4294967296),I[15+(e+64>>>9<<4)]=C,g.sigBytes=4*I.length,this._process(),this._hash},clone:function(){var g=e.clone.call(this);return g._hash=this._hash.clone(),g}});g.SHA1=e._createHelper(n),g.HmacSHA1=e._createHmacHelper(n)}(),l.SHA1)}()},3183:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(9517),function(){var g=A,I=g.lib.WordArray,C=g.algo,e=C.SHA256,l=C.SHA224=e.extend({_doReset:function(){this._hash=new I.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var g=e._doFinalize.call(this);return g.sigBytes-=4,g}});g.SHA224=e._createHelper(l),g.HmacSHA224=e._createHmacHelper(l)}(),A.SHA224)}()},9517:function(g,I,C){!function(I,e){var l;g.exports=(l=C(8926),function(g){var I=l,C=I.lib,e=C.WordArray,A=C.Hasher,t=I.algo,n=[],o=[];!function(){function I(I){for(var C=g.sqrt(I),e=2;e<=C;e++)if(!(I%e))return!1;return!0}function C(g){return 4294967296*(g-(0|g))|0}for(var e=2,l=0;l<64;)I(e)&&(l<8&&(n[l]=C(g.pow(e,.5))),o[l]=C(g.pow(e,1/3)),l++),e++}();var a=[],c=t.SHA256=A.extend({_doReset:function(){this._hash=new e.init(n.slice(0))},_doProcessBlock:function(g,I){for(var C=this._hash.words,e=C[0],l=C[1],A=C[2],t=C[3],n=C[4],c=C[5],d=C[6],i=C[7],s=0;s<64;s++){if(s<16)a[s]=0|g[I+s];else{var r=a[s-15],b=(r<<25|r>>>7)^(r<<14|r>>>18)^r>>>3,m=a[s-2],Z=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;a[s]=b+a[s-7]+Z+a[s-16]}var u=e&l^e&A^l&A,G=(e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22),B=i+((n<<26|n>>>6)^(n<<21|n>>>11)^(n<<7|n>>>25))+(n&c^~n&d)+o[s]+a[s];i=d,d=c,c=n,n=t+B|0,t=A,A=l,l=e,e=B+(G+u)|0}C[0]=C[0]+e|0,C[1]=C[1]+l|0,C[2]=C[2]+A|0,C[3]=C[3]+t|0,C[4]=C[4]+n|0,C[5]=C[5]+c|0,C[6]=C[6]+d|0,C[7]=C[7]+i|0},_doFinalize:function(){var I=this._data,C=I.words,e=8*this._nDataBytes,l=8*I.sigBytes;return C[l>>>5]|=128<<24-l%32,C[14+(l+64>>>9<<4)]=g.floor(e/4294967296),C[15+(l+64>>>9<<4)]=e,I.sigBytes=4*C.length,this._process(),this._hash},clone:function(){var g=A.clone.call(this);return g._hash=this._hash.clone(),g}});I.SHA256=A._createHelper(c),I.HmacSHA256=A._createHmacHelper(c)}(Math),l.SHA256)}()},6853:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3646),function(g){var I=A,C=I.lib,e=C.WordArray,l=C.Hasher,t=I.x64.Word,n=I.algo,o=[],a=[],c=[];!function(){for(var g=1,I=0,C=0;C<24;C++){o[g+5*I]=(C+1)*(C+2)/2%64;var e=(2*g+3*I)%5;g=I%5,I=e}for(g=0;g<5;g++)for(I=0;I<5;I++)a[g+5*I]=I+(2*g+3*I)%5*5;for(var l=1,A=0;A<24;A++){for(var n=0,d=0,i=0;i<7;i++){if(1&l){var s=(1<<i)-1;s<32?d^=1<<s:n^=1<<s-32}128&l?l=l<<1^113:l<<=1}c[A]=t.create(n,d)}}();var d=[];!function(){for(var g=0;g<25;g++)d[g]=t.create()}();var i=n.SHA3=l.extend({cfg:l.cfg.extend({outputLength:512}),_doReset:function(){for(var g=this._state=[],I=0;I<25;I++)g[I]=new t.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(g,I){for(var C=this._state,e=this.blockSize/2,l=0;l<e;l++){var A=g[I+2*l],t=g[I+2*l+1];A=16711935&(A<<8|A>>>24)|4278255360&(A<<24|A>>>8),t=16711935&(t<<8|t>>>24)|4278255360&(t<<24|t>>>8),(R=C[l]).high^=t,R.low^=A}for(var n=0;n<24;n++){for(var i=0;i<5;i++){for(var s=0,r=0,b=0;b<5;b++)s^=(R=C[i+5*b]).high,r^=R.low;var m=d[i];m.high=s,m.low=r}for(i=0;i<5;i++){var Z=d[(i+4)%5],u=d[(i+1)%5],G=u.high,B=u.low;for(s=Z.high^(G<<1|B>>>31),r=Z.low^(B<<1|G>>>31),b=0;b<5;b++)(R=C[i+5*b]).high^=s,R.low^=r}for(var h=1;h<25;h++){var p=(R=C[h]).high,y=R.low,W=o[h];W<32?(s=p<<W|y>>>32-W,r=y<<W|p>>>32-W):(s=y<<W-32|p>>>64-W,r=p<<W-32|y>>>64-W);var V=d[a[h]];V.high=s,V.low=r}var S=d[0],X=C[0];for(S.high=X.high,S.low=X.low,i=0;i<5;i++)for(b=0;b<5;b++){var R=C[h=i+5*b],k=d[h],J=d[(i+1)%5+5*b],Y=d[(i+2)%5+5*b];R.high=k.high^~J.high&Y.high,R.low=k.low^~J.low&Y.low}R=C[0];var v=c[n];R.high^=v.high,R.low^=v.low}},_doFinalize:function(){var I=this._data,C=I.words,l=(this._nDataBytes,8*I.sigBytes),A=32*this.blockSize;C[l>>>5]|=1<<24-l%32,C[(g.ceil((l+1)/A)*A>>>5)-1]|=128,I.sigBytes=4*C.length,this._process();for(var t=this._state,n=this.cfg.outputLength/8,o=n/8,a=[],c=0;c<o;c++){var d=t[c],i=d.high,s=d.low;i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),a.push(s),a.push(i)}return new e.init(a,n)},clone:function(){for(var g=l.clone.call(this),I=g._state=this._state.slice(0),C=0;C<25;C++)I[C]=I[C].clone();return g}});I.SHA3=l._createHelper(i),I.HmacSHA3=l._createHmacHelper(i)}(Math),A.SHA3)}()},6319:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3646),C(4345),function(){var g=A,I=g.x64,C=I.Word,e=I.WordArray,l=g.algo,t=l.SHA512,n=l.SHA384=t.extend({_doReset:function(){this._hash=new e.init([new C.init(3418070365,3238371032),new C.init(1654270250,914150663),new C.init(2438529370,812702999),new C.init(355462360,4144912697),new C.init(1731405415,4290775857),new C.init(2394180231,1750603025),new C.init(3675008525,1694076839),new C.init(1203062813,3204075428)])},_doFinalize:function(){var g=t._doFinalize.call(this);return g.sigBytes-=16,g}});g.SHA384=t._createHelper(n),g.HmacSHA384=t._createHmacHelper(n)}(),A.SHA384)}()},4345:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3646),function(){var g=A,I=g.lib.Hasher,C=g.x64,e=C.Word,l=C.WordArray,t=g.algo;function n(){return e.create.apply(e,arguments)}var o=[n(1116352408,3609767458),n(1899447441,602891725),n(3049323471,3964484399),n(3921009573,2173295548),n(961987163,4081628472),n(1508970993,3053834265),n(2453635748,2937671579),n(2870763221,3664609560),n(3624381080,2734883394),n(310598401,1164996542),n(607225278,1323610764),n(1426881987,3590304994),n(1925078388,4068182383),n(2162078206,991336113),n(2614888103,633803317),n(3248222580,3479774868),n(3835390401,2666613458),n(4022224774,944711139),n(264347078,2341262773),n(604807628,2007800933),n(770255983,1495990901),n(1249150122,1856431235),n(1555081692,3175218132),n(1996064986,2198950837),n(2554220882,3999719339),n(2821834349,766784016),n(2952996808,2566594879),n(3210313671,3203337956),n(3336571891,1034457026),n(3584528711,2466948901),n(113926993,3758326383),n(338241895,168717936),n(666307205,1188179964),n(773529912,1546045734),n(1294757372,1522805485),n(1396182291,2643833823),n(1695183700,2343527390),n(1986661051,1014477480),n(2177026350,1206759142),n(2456956037,344077627),n(2730485921,1290863460),n(2820302411,3158454273),n(3259730800,3505952657),n(3345764771,106217008),n(3516065817,3606008344),n(3600352804,1432725776),n(4094571909,1467031594),n(275423344,851169720),n(430227734,3100823752),n(506948616,1363258195),n(659060556,3750685593),n(883997877,3785050280),n(958139571,3318307427),n(1322822218,3812723403),n(1537002063,2003034995),n(1747873779,3602036899),n(1955562222,1575990012),n(2024104815,1125592928),n(2227730452,2716904306),n(2361852424,442776044),n(2428436474,593698344),n(2756734187,3733110249),n(3204031479,2999351573),n(3329325298,3815920427),n(3391569614,3928383900),n(3515267271,566280711),n(3940187606,3454069534),n(4118630271,4000239992),n(116418474,1914138554),n(174292421,2731055270),n(289380356,3203993006),n(460393269,320620315),n(685471733,587496836),n(852142971,1086792851),n(1017036298,365543100),n(1126000580,2618297676),n(1288033470,3409855158),n(1501505948,4234509866),n(1607167915,987167468),n(1816402316,1246189591)],a=[];!function(){for(var g=0;g<80;g++)a[g]=n()}();var c=t.SHA512=I.extend({_doReset:function(){this._hash=new l.init([new e.init(1779033703,4089235720),new e.init(3144134277,2227873595),new e.init(1013904242,4271175723),new e.init(2773480762,1595750129),new e.init(1359893119,2917565137),new e.init(2600822924,725511199),new e.init(528734635,4215389547),new e.init(1541459225,327033209)])},_doProcessBlock:function(g,I){for(var C=this._hash.words,e=C[0],l=C[1],A=C[2],t=C[3],n=C[4],c=C[5],d=C[6],i=C[7],s=e.high,r=e.low,b=l.high,m=l.low,Z=A.high,u=A.low,G=t.high,B=t.low,h=n.high,p=n.low,y=c.high,W=c.low,V=d.high,S=d.low,X=i.high,R=i.low,k=s,J=r,Y=b,v=m,H=Z,N=u,f=G,K=B,w=h,F=p,x=y,z=W,U=V,Q=S,E=X,L=R,M=0;M<80;M++){var D,T,j=a[M];if(M<16)T=j.high=0|g[I+2*M],D=j.low=0|g[I+2*M+1];else{var P=a[M-15],O=P.high,q=P.low,_=(O>>>1|q<<31)^(O>>>8|q<<24)^O>>>7,$=(q>>>1|O<<31)^(q>>>8|O<<24)^(q>>>7|O<<25),gg=a[M-2],Ig=gg.high,Cg=gg.low,eg=(Ig>>>19|Cg<<13)^(Ig<<3|Cg>>>29)^Ig>>>6,lg=(Cg>>>19|Ig<<13)^(Cg<<3|Ig>>>29)^(Cg>>>6|Ig<<26),Ag=a[M-7],tg=Ag.high,ng=Ag.low,og=a[M-16],ag=og.high,cg=og.low;T=(T=(T=_+tg+((D=$+ng)>>>0<$>>>0?1:0))+eg+((D+=lg)>>>0<lg>>>0?1:0))+ag+((D+=cg)>>>0<cg>>>0?1:0),j.high=T,j.low=D}var dg,ig=w&x^~w&U,sg=F&z^~F&Q,rg=k&Y^k&H^Y&H,bg=J&v^J&N^v&N,mg=(k>>>28|J<<4)^(k<<30|J>>>2)^(k<<25|J>>>7),Zg=(J>>>28|k<<4)^(J<<30|k>>>2)^(J<<25|k>>>7),ug=(w>>>14|F<<18)^(w>>>18|F<<14)^(w<<23|F>>>9),Gg=(F>>>14|w<<18)^(F>>>18|w<<14)^(F<<23|w>>>9),Bg=o[M],hg=Bg.high,pg=Bg.low,yg=E+ug+((dg=L+Gg)>>>0<L>>>0?1:0),Wg=Zg+bg;E=U,L=Q,U=x,Q=z,x=w,z=F,w=f+(yg=(yg=(yg=yg+ig+((dg+=sg)>>>0<sg>>>0?1:0))+hg+((dg+=pg)>>>0<pg>>>0?1:0))+T+((dg+=D)>>>0<D>>>0?1:0))+((F=K+dg|0)>>>0<K>>>0?1:0)|0,f=H,K=N,H=Y,N=v,Y=k,v=J,k=yg+(mg+rg+(Wg>>>0<Zg>>>0?1:0))+((J=dg+Wg|0)>>>0<dg>>>0?1:0)|0}r=e.low=r+J,e.high=s+k+(r>>>0<J>>>0?1:0),m=l.low=m+v,l.high=b+Y+(m>>>0<v>>>0?1:0),u=A.low=u+N,A.high=Z+H+(u>>>0<N>>>0?1:0),B=t.low=B+K,t.high=G+f+(B>>>0<K>>>0?1:0),p=n.low=p+F,n.high=h+w+(p>>>0<F>>>0?1:0),W=c.low=W+z,c.high=y+x+(W>>>0<z>>>0?1:0),S=d.low=S+Q,d.high=V+U+(S>>>0<Q>>>0?1:0),R=i.low=R+L,i.high=X+E+(R>>>0<L>>>0?1:0)},_doFinalize:function(){var g=this._data,I=g.words,C=8*this._nDataBytes,e=8*g.sigBytes;return I[e>>>5]|=128<<24-e%32,I[30+(e+128>>>10<<5)]=Math.floor(C/4294967296),I[31+(e+128>>>10<<5)]=C,g.sigBytes=4*I.length,this._process(),this._hash.toX32()},clone:function(){var g=I.clone.call(this);return g._hash=this._hash.clone(),g},blockSize:32});g.SHA512=I._createHelper(c),g.HmacSHA512=I._createHmacHelper(c)}(),A.SHA512)}()},2550:function(g,I,C){!function(I,e,l){var A;g.exports=(A=C(8926),C(3713),C(3074),C(8228),C(3650),function(){var g=A,I=g.lib,C=I.WordArray,e=I.BlockCipher,l=g.algo,t=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],n=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],o=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],a=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],c=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=l.DES=e.extend({_doReset:function(){for(var g=this._key.words,I=[],C=0;C<56;C++){var e=t[C]-1;I[C]=g[e>>>5]>>>31-e%32&1}for(var l=this._subKeys=[],A=0;A<16;A++){var a=l[A]=[],c=o[A];for(C=0;C<24;C++)a[C/6|0]|=I[(n[C]-1+c)%28]<<31-C%6,a[4+(C/6|0)]|=I[28+(n[C+24]-1+c)%28]<<31-C%6;for(a[0]=a[0]<<1|a[0]>>>31,C=1;C<7;C++)a[C]=a[C]>>>4*(C-1)+3;a[7]=a[7]<<5|a[7]>>>27}var d=this._invSubKeys=[];for(C=0;C<16;C++)d[C]=l[15-C]},encryptBlock:function(g,I){this._doCryptBlock(g,I,this._subKeys)},decryptBlock:function(g,I){this._doCryptBlock(g,I,this._invSubKeys)},_doCryptBlock:function(g,I,C){this._lBlock=g[I],this._rBlock=g[I+1],i.call(this,4,252645135),i.call(this,16,65535),s.call(this,2,858993459),s.call(this,8,16711935),i.call(this,1,1431655765);for(var e=0;e<16;e++){for(var l=C[e],A=this._lBlock,t=this._rBlock,n=0,o=0;o<8;o++)n|=a[o][((t^l[o])&c[o])>>>0];this._lBlock=t,this._rBlock=A^n}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,i.call(this,1,1431655765),s.call(this,8,16711935),s.call(this,2,858993459),i.call(this,16,65535),i.call(this,4,252645135),g[I]=this._lBlock,g[I+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function i(g,I){var C=(this._lBlock>>>g^this._rBlock)&I;this._rBlock^=C,this._lBlock^=C<<g}function s(g,I){var C=(this._rBlock>>>g^this._lBlock)&I;this._lBlock^=C,this._rBlock^=C<<g}g.DES=e._createHelper(d);var r=l.TripleDES=e.extend({_doReset:function(){var g=this._key.words;if(2!==g.length&&4!==g.length&&g.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var I=g.slice(0,2),e=g.length<4?g.slice(0,2):g.slice(2,4),l=g.length<6?g.slice(0,2):g.slice(4,6);this._des1=d.createEncryptor(C.create(I)),this._des2=d.createEncryptor(C.create(e)),this._des3=d.createEncryptor(C.create(l))},encryptBlock:function(g,I){this._des1.encryptBlock(g,I),this._des2.decryptBlock(g,I),this._des3.encryptBlock(g,I)},decryptBlock:function(g,I){this._des3.decryptBlock(g,I),this._des2.encryptBlock(g,I),this._des1.decryptBlock(g,I)},keySize:6,ivSize:2,blockSize:2});g.TripleDES=e._createHelper(r)}(),A.TripleDES)}()},3646:function(g,I,C){!function(I,e){var l;g.exports=(l=C(8926),function(g){var I=l,C=I.lib,e=C.Base,A=C.WordArray,t=I.x64={};t.Word=e.extend({init:function(g,I){this.high=g,this.low=I}}),t.WordArray=e.extend({init:function(I,C){I=this.words=I||[],this.sigBytes=C!=g?C:8*I.length},toX32:function(){for(var g=this.words,I=g.length,C=[],e=0;e<I;e++){var l=g[e];C.push(l.high),C.push(l.low)}return A.create(C,this.sigBytes)},clone:function(){for(var g=e.clone.call(this),I=g.words=this.words.slice(0),C=I.length,l=0;l<C;l++)I[l]=I[l].clone();return g}})}(),l)}()},2110:(g,I,C)=>{"use strict";var e=C(8309),l={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},A={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},t={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},n={};function o(g){return e.isMemo(g)?t:n[g.$$typeof]||l}n[e.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},n[e.Memo]=t;var a=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,i=Object.getOwnPropertyDescriptor,s=Object.getPrototypeOf,r=Object.prototype;g.exports=function g(I,C,e){if("string"!==typeof C){if(r){var l=s(C);l&&l!==r&&g(I,l,e)}var t=c(C);d&&(t=t.concat(d(C)));for(var n=o(I),b=o(C),m=0;m<t.length;++m){var Z=t[m];if(!A[Z]&&(!e||!e[Z])&&(!b||!b[Z])&&(!n||!n[Z])){var u=i(C,Z);try{a(I,Z,u)}catch(G){}}}}return I}},746:(g,I)=>{"use strict";var C="function"===typeof Symbol&&Symbol.for,e=C?Symbol.for("react.element"):60103,l=C?Symbol.for("react.portal"):60106,A=C?Symbol.for("react.fragment"):60107,t=C?Symbol.for("react.strict_mode"):60108,n=C?Symbol.for("react.profiler"):60114,o=C?Symbol.for("react.provider"):60109,a=C?Symbol.for("react.context"):60110,c=C?Symbol.for("react.async_mode"):60111,d=C?Symbol.for("react.concurrent_mode"):60111,i=C?Symbol.for("react.forward_ref"):60112,s=C?Symbol.for("react.suspense"):60113,r=C?Symbol.for("react.suspense_list"):60120,b=C?Symbol.for("react.memo"):60115,m=C?Symbol.for("react.lazy"):60116,Z=C?Symbol.for("react.block"):60121,u=C?Symbol.for("react.fundamental"):60117,G=C?Symbol.for("react.responder"):60118,B=C?Symbol.for("react.scope"):60119;function h(g){if("object"===typeof g&&null!==g){var I=g.$$typeof;switch(I){case e:switch(g=g.type){case c:case d:case A:case n:case t:case s:return g;default:switch(g=g&&g.$$typeof){case a:case i:case m:case b:case o:return g;default:return I}}case l:return I}}}function p(g){return h(g)===d}I.AsyncMode=c,I.ConcurrentMode=d,I.ContextConsumer=a,I.ContextProvider=o,I.Element=e,I.ForwardRef=i,I.Fragment=A,I.Lazy=m,I.Memo=b,I.Portal=l,I.Profiler=n,I.StrictMode=t,I.Suspense=s,I.isAsyncMode=function(g){return p(g)||h(g)===c},I.isConcurrentMode=p,I.isContextConsumer=function(g){return h(g)===a},I.isContextProvider=function(g){return h(g)===o},I.isElement=function(g){return"object"===typeof g&&null!==g&&g.$$typeof===e},I.isForwardRef=function(g){return h(g)===i},I.isFragment=function(g){return h(g)===A},I.isLazy=function(g){return h(g)===m},I.isMemo=function(g){return h(g)===b},I.isPortal=function(g){return h(g)===l},I.isProfiler=function(g){return h(g)===n},I.isStrictMode=function(g){return h(g)===t},I.isSuspense=function(g){return h(g)===s},I.isValidElementType=function(g){return"string"===typeof g||"function"===typeof g||g===A||g===d||g===n||g===t||g===s||g===r||"object"===typeof g&&null!==g&&(g.$$typeof===m||g.$$typeof===b||g.$$typeof===o||g.$$typeof===a||g.$$typeof===i||g.$$typeof===u||g.$$typeof===G||g.$$typeof===B||g.$$typeof===Z)},I.typeOf=h},8309:(g,I,C)=>{"use strict";g.exports=C(746)},2176:g=>{"use strict";g.exports=function(g,I,C,e,l,A,t,n){if(!g){var o;if(void 0===I)o=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var a=[C,e,l,A,t,n],c=0;(o=new Error(I.replace(/%s/g,(function(){return a[c++]})))).name="Invariant Violation"}throw o.framesToPop=1,o}}},888:(g,I,C)=>{"use strict";var e=C(9047);function l(){}function A(){}A.resetWarningCache=l,g.exports=function(){function g(g,I,C,l,A,t){if(t!==e){var n=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw n.name="Invariant Violation",n}}function I(){return g}g.isRequired=g;var C={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:I,element:g,elementType:g,instanceOf:I,node:g,objectOf:I,oneOf:I,oneOfType:I,shape:I,exact:I,checkPropTypes:A,resetWarningCache:l};return C.PropTypes=C,C}},2007:(g,I,C)=>{g.exports=C(888)()},9047:g=>{"use strict";g.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},4463:(g,I,C)=>{"use strict";var e=C(2791),l=C(5296);function A(g){for(var I="https://reactjs.org/docs/error-decoder.html?invariant="+g,C=1;C<arguments.length;C++)I+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+g+"; visit "+I+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t=new Set,n={};function o(g,I){a(g,I),a(g+"Capture",I)}function a(g,I){for(n[g]=I,g=0;g<I.length;g++)t.add(I[g])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,i=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,s={},r={};function b(g,I,C,e,l,A,t){this.acceptsBooleans=2===I||3===I||4===I,this.attributeName=e,this.attributeNamespace=l,this.mustUseProperty=C,this.propertyName=g,this.type=I,this.sanitizeURL=A,this.removeEmptyString=t}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(g){m[g]=new b(g,0,!1,g,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(g){var I=g[0];m[I]=new b(I,1,!1,g[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(g){m[g]=new b(g,2,!1,g.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(g){m[g]=new b(g,2,!1,g,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(g){m[g]=new b(g,3,!1,g.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(g){m[g]=new b(g,3,!0,g,null,!1,!1)})),["capture","download"].forEach((function(g){m[g]=new b(g,4,!1,g,null,!1,!1)})),["cols","rows","size","span"].forEach((function(g){m[g]=new b(g,6,!1,g,null,!1,!1)})),["rowSpan","start"].forEach((function(g){m[g]=new b(g,5,!1,g.toLowerCase(),null,!1,!1)}));var Z=/[\-:]([a-z])/g;function u(g){return g[1].toUpperCase()}function G(g,I,C,e){var l=m.hasOwnProperty(I)?m[I]:null;(null!==l?0!==l.type:e||!(2<I.length)||"o"!==I[0]&&"O"!==I[0]||"n"!==I[1]&&"N"!==I[1])&&(function(g,I,C,e){if(null===I||"undefined"===typeof I||function(g,I,C,e){if(null!==C&&0===C.type)return!1;switch(typeof I){case"function":case"symbol":return!0;case"boolean":return!e&&(null!==C?!C.acceptsBooleans:"data-"!==(g=g.toLowerCase().slice(0,5))&&"aria-"!==g);default:return!1}}(g,I,C,e))return!0;if(e)return!1;if(null!==C)switch(C.type){case 3:return!I;case 4:return!1===I;case 5:return isNaN(I);case 6:return isNaN(I)||1>I}return!1}(I,C,l,e)&&(C=null),e||null===l?function(g){return!!d.call(r,g)||!d.call(s,g)&&(i.test(g)?r[g]=!0:(s[g]=!0,!1))}(I)&&(null===C?g.removeAttribute(I):g.setAttribute(I,""+C)):l.mustUseProperty?g[l.propertyName]=null===C?3!==l.type&&"":C:(I=l.attributeName,e=l.attributeNamespace,null===C?g.removeAttribute(I):(C=3===(l=l.type)||4===l&&!0===C?"":""+C,e?g.setAttributeNS(e,I,C):g.setAttribute(I,C))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(g){var I=g.replace(Z,u);m[I]=new b(I,1,!1,g,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(g){var I=g.replace(Z,u);m[I]=new b(I,1,!1,g,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(g){var I=g.replace(Z,u);m[I]=new b(I,1,!1,g,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(g){m[g]=new b(g,1,!1,g.toLowerCase(),null,!1,!1)})),m.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(g){m[g]=new b(g,1,!1,g.toLowerCase(),null,!0,!0)}));var B=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,h=Symbol.for("react.element"),p=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),X=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),Y=Symbol.for("react.memo"),v=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var H=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function f(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=N&&g[N]||g["@@iterator"])?g:null}var K,w=Object.assign;function F(g){if(void 0===K)try{throw Error()}catch(C){var I=C.stack.trim().match(/\n( *(at )?)/);K=I&&I[1]||""}return"\n"+K+g}var x=!1;function z(g,I){if(!g||x)return"";x=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(I)if(I=function(){throw Error()},Object.defineProperty(I.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(I,[])}catch(a){var e=a}Reflect.construct(g,[],I)}else{try{I.call()}catch(a){e=a}g.call(I.prototype)}else{try{throw Error()}catch(a){e=a}g()}}catch(a){if(a&&e&&"string"===typeof a.stack){for(var l=a.stack.split("\n"),A=e.stack.split("\n"),t=l.length-1,n=A.length-1;1<=t&&0<=n&&l[t]!==A[n];)n--;for(;1<=t&&0<=n;t--,n--)if(l[t]!==A[n]){if(1!==t||1!==n)do{if(t--,0>--n||l[t]!==A[n]){var o="\n"+l[t].replace(" at new "," at ");return g.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",g.displayName)),o}}while(1<=t&&0<=n);break}}}finally{x=!1,Error.prepareStackTrace=C}return(g=g?g.displayName||g.name:"")?F(g):""}function U(g){switch(g.tag){case 5:return F(g.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return g=z(g.type,!1);case 11:return g=z(g.type.render,!1);case 1:return g=z(g.type,!0);default:return""}}function Q(g){if(null==g)return null;if("function"===typeof g)return g.displayName||g.name||null;if("string"===typeof g)return g;switch(g){case y:return"Fragment";case p:return"Portal";case V:return"Profiler";case W:return"StrictMode";case k:return"Suspense";case J:return"SuspenseList"}if("object"===typeof g)switch(g.$$typeof){case X:return(g.displayName||"Context")+".Consumer";case S:return(g._context.displayName||"Context")+".Provider";case R:var I=g.render;return(g=g.displayName)||(g=""!==(g=I.displayName||I.name||"")?"ForwardRef("+g+")":"ForwardRef"),g;case Y:return null!==(I=g.displayName||null)?I:Q(g.type)||"Memo";case v:I=g._payload,g=g._init;try{return Q(g(I))}catch(C){}}return null}function E(g){var I=g.type;switch(g.tag){case 24:return"Cache";case 9:return(I.displayName||"Context")+".Consumer";case 10:return(I._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=(g=I.render).displayName||g.name||"",I.displayName||(""!==g?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return I;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q(I);case 8:return I===W?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof I)return I.displayName||I.name||null;if("string"===typeof I)return I}return null}function L(g){switch(typeof g){case"boolean":case"number":case"string":case"undefined":case"object":return g;default:return""}}function M(g){var I=g.type;return(g=g.nodeName)&&"input"===g.toLowerCase()&&("checkbox"===I||"radio"===I)}function D(g){g._valueTracker||(g._valueTracker=function(g){var I=M(g)?"checked":"value",C=Object.getOwnPropertyDescriptor(g.constructor.prototype,I),e=""+g[I];if(!g.hasOwnProperty(I)&&"undefined"!==typeof C&&"function"===typeof C.get&&"function"===typeof C.set){var l=C.get,A=C.set;return Object.defineProperty(g,I,{configurable:!0,get:function(){return l.call(this)},set:function(g){e=""+g,A.call(this,g)}}),Object.defineProperty(g,I,{enumerable:C.enumerable}),{getValue:function(){return e},setValue:function(g){e=""+g},stopTracking:function(){g._valueTracker=null,delete g[I]}}}}(g))}function T(g){if(!g)return!1;var I=g._valueTracker;if(!I)return!0;var C=I.getValue(),e="";return g&&(e=M(g)?g.checked?"true":"false":g.value),(g=e)!==C&&(I.setValue(g),!0)}function j(g){if("undefined"===typeof(g=g||("undefined"!==typeof document?document:void 0)))return null;try{return g.activeElement||g.body}catch(I){return g.body}}function P(g,I){var C=I.checked;return w({},I,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=C?C:g._wrapperState.initialChecked})}function O(g,I){var C=null==I.defaultValue?"":I.defaultValue,e=null!=I.checked?I.checked:I.defaultChecked;C=L(null!=I.value?I.value:C),g._wrapperState={initialChecked:e,initialValue:C,controlled:"checkbox"===I.type||"radio"===I.type?null!=I.checked:null!=I.value}}function q(g,I){null!=(I=I.checked)&&G(g,"checked",I,!1)}function _(g,I){q(g,I);var C=L(I.value),e=I.type;if(null!=C)"number"===e?(0===C&&""===g.value||g.value!=C)&&(g.value=""+C):g.value!==""+C&&(g.value=""+C);else if("submit"===e||"reset"===e)return void g.removeAttribute("value");I.hasOwnProperty("value")?gg(g,I.type,C):I.hasOwnProperty("defaultValue")&&gg(g,I.type,L(I.defaultValue)),null==I.checked&&null!=I.defaultChecked&&(g.defaultChecked=!!I.defaultChecked)}function $(g,I,C){if(I.hasOwnProperty("value")||I.hasOwnProperty("defaultValue")){var e=I.type;if(!("submit"!==e&&"reset"!==e||void 0!==I.value&&null!==I.value))return;I=""+g._wrapperState.initialValue,C||I===g.value||(g.value=I),g.defaultValue=I}""!==(C=g.name)&&(g.name=""),g.defaultChecked=!!g._wrapperState.initialChecked,""!==C&&(g.name=C)}function gg(g,I,C){"number"===I&&j(g.ownerDocument)===g||(null==C?g.defaultValue=""+g._wrapperState.initialValue:g.defaultValue!==""+C&&(g.defaultValue=""+C))}var Ig=Array.isArray;function Cg(g,I,C,e){if(g=g.options,I){I={};for(var l=0;l<C.length;l++)I["$"+C[l]]=!0;for(C=0;C<g.length;C++)l=I.hasOwnProperty("$"+g[C].value),g[C].selected!==l&&(g[C].selected=l),l&&e&&(g[C].defaultSelected=!0)}else{for(C=""+L(C),I=null,l=0;l<g.length;l++){if(g[l].value===C)return g[l].selected=!0,void(e&&(g[l].defaultSelected=!0));null!==I||g[l].disabled||(I=g[l])}null!==I&&(I.selected=!0)}}function eg(g,I){if(null!=I.dangerouslySetInnerHTML)throw Error(A(91));return w({},I,{value:void 0,defaultValue:void 0,children:""+g._wrapperState.initialValue})}function lg(g,I){var C=I.value;if(null==C){if(C=I.children,I=I.defaultValue,null!=C){if(null!=I)throw Error(A(92));if(Ig(C)){if(1<C.length)throw Error(A(93));C=C[0]}I=C}null==I&&(I=""),C=I}g._wrapperState={initialValue:L(C)}}function Ag(g,I){var C=L(I.value),e=L(I.defaultValue);null!=C&&((C=""+C)!==g.value&&(g.value=C),null==I.defaultValue&&g.defaultValue!==C&&(g.defaultValue=C)),null!=e&&(g.defaultValue=""+e)}function tg(g){var I=g.textContent;I===g._wrapperState.initialValue&&""!==I&&null!==I&&(g.value=I)}function ng(g){switch(g){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function og(g,I){return null==g||"http://www.w3.org/1999/xhtml"===g?ng(I):"http://www.w3.org/2000/svg"===g&&"foreignObject"===I?"http://www.w3.org/1999/xhtml":g}var ag,cg,dg=(cg=function(g,I){if("http://www.w3.org/2000/svg"!==g.namespaceURI||"innerHTML"in g)g.innerHTML=I;else{for((ag=ag||document.createElement("div")).innerHTML="<svg>"+I.valueOf().toString()+"</svg>",I=ag.firstChild;g.firstChild;)g.removeChild(g.firstChild);for(;I.firstChild;)g.appendChild(I.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(g,I,C,e){MSApp.execUnsafeLocalFunction((function(){return cg(g,I)}))}:cg);function ig(g,I){if(I){var C=g.firstChild;if(C&&C===g.lastChild&&3===C.nodeType)return void(C.nodeValue=I)}g.textContent=I}var sg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rg=["Webkit","ms","Moz","O"];function bg(g,I,C){return null==I||"boolean"===typeof I||""===I?"":C||"number"!==typeof I||0===I||sg.hasOwnProperty(g)&&sg[g]?(""+I).trim():I+"px"}function mg(g,I){for(var C in g=g.style,I)if(I.hasOwnProperty(C)){var e=0===C.indexOf("--"),l=bg(C,I[C],e);"float"===C&&(C="cssFloat"),e?g.setProperty(C,l):g[C]=l}}Object.keys(sg).forEach((function(g){rg.forEach((function(I){I=I+g.charAt(0).toUpperCase()+g.substring(1),sg[I]=sg[g]}))}));var Zg=w({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ug(g,I){if(I){if(Zg[g]&&(null!=I.children||null!=I.dangerouslySetInnerHTML))throw Error(A(137,g));if(null!=I.dangerouslySetInnerHTML){if(null!=I.children)throw Error(A(60));if("object"!==typeof I.dangerouslySetInnerHTML||!("__html"in I.dangerouslySetInnerHTML))throw Error(A(61))}if(null!=I.style&&"object"!==typeof I.style)throw Error(A(62))}}function Gg(g,I){if(-1===g.indexOf("-"))return"string"===typeof I.is;switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bg=null;function hg(g){return(g=g.target||g.srcElement||window).correspondingUseElement&&(g=g.correspondingUseElement),3===g.nodeType?g.parentNode:g}var pg=null,yg=null,Wg=null;function Vg(g){if(g=ul(g)){if("function"!==typeof pg)throw Error(A(280));var I=g.stateNode;I&&(I=Bl(I),pg(g.stateNode,g.type,I))}}function Sg(g){yg?Wg?Wg.push(g):Wg=[g]:yg=g}function Xg(){if(yg){var g=yg,I=Wg;if(Wg=yg=null,Vg(g),I)for(g=0;g<I.length;g++)Vg(I[g])}}function Rg(g,I){return g(I)}function kg(){}var Jg=!1;function Yg(g,I,C){if(Jg)return g(I,C);Jg=!0;try{return Rg(g,I,C)}finally{Jg=!1,(null!==yg||null!==Wg)&&(kg(),Xg())}}function vg(g,I){var C=g.stateNode;if(null===C)return null;var e=Bl(C);if(null===e)return null;C=e[I];g:switch(I){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(e=!e.disabled)||(e=!("button"===(g=g.type)||"input"===g||"select"===g||"textarea"===g)),g=!e;break g;default:g=!1}if(g)return null;if(C&&"function"!==typeof C)throw Error(A(231,I,typeof C));return C}var Hg=!1;if(c)try{var Ng={};Object.defineProperty(Ng,"passive",{get:function(){Hg=!0}}),window.addEventListener("test",Ng,Ng),window.removeEventListener("test",Ng,Ng)}catch(cg){Hg=!1}function fg(g,I,C,e,l,A,t,n,o){var a=Array.prototype.slice.call(arguments,3);try{I.apply(C,a)}catch(c){this.onError(c)}}var Kg=!1,wg=null,Fg=!1,xg=null,zg={onError:function(g){Kg=!0,wg=g}};function Ug(g,I,C,e,l,A,t,n,o){Kg=!1,wg=null,fg.apply(zg,arguments)}function Qg(g){var I=g,C=g;if(g.alternate)for(;I.return;)I=I.return;else{g=I;do{0!==(4098&(I=g).flags)&&(C=I.return),g=I.return}while(g)}return 3===I.tag?C:null}function Eg(g){if(13===g.tag){var I=g.memoizedState;if(null===I&&(null!==(g=g.alternate)&&(I=g.memoizedState)),null!==I)return I.dehydrated}return null}function Lg(g){if(Qg(g)!==g)throw Error(A(188))}function Mg(g){return null!==(g=function(g){var I=g.alternate;if(!I){if(null===(I=Qg(g)))throw Error(A(188));return I!==g?null:g}for(var C=g,e=I;;){var l=C.return;if(null===l)break;var t=l.alternate;if(null===t){if(null!==(e=l.return)){C=e;continue}break}if(l.child===t.child){for(t=l.child;t;){if(t===C)return Lg(l),g;if(t===e)return Lg(l),I;t=t.sibling}throw Error(A(188))}if(C.return!==e.return)C=l,e=t;else{for(var n=!1,o=l.child;o;){if(o===C){n=!0,C=l,e=t;break}if(o===e){n=!0,e=l,C=t;break}o=o.sibling}if(!n){for(o=t.child;o;){if(o===C){n=!0,C=t,e=l;break}if(o===e){n=!0,e=t,C=l;break}o=o.sibling}if(!n)throw Error(A(189))}}if(C.alternate!==e)throw Error(A(190))}if(3!==C.tag)throw Error(A(188));return C.stateNode.current===C?g:I}(g))?Dg(g):null}function Dg(g){if(5===g.tag||6===g.tag)return g;for(g=g.child;null!==g;){var I=Dg(g);if(null!==I)return I;g=g.sibling}return null}var Tg=l.unstable_scheduleCallback,jg=l.unstable_cancelCallback,Pg=l.unstable_shouldYield,Og=l.unstable_requestPaint,qg=l.unstable_now,_g=l.unstable_getCurrentPriorityLevel,$g=l.unstable_ImmediatePriority,gI=l.unstable_UserBlockingPriority,II=l.unstable_NormalPriority,CI=l.unstable_LowPriority,eI=l.unstable_IdlePriority,lI=null,AI=null;var tI=Math.clz32?Math.clz32:function(g){return g>>>=0,0===g?32:31-(nI(g)/oI|0)|0},nI=Math.log,oI=Math.LN2;var aI=64,cI=4194304;function dI(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&g;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&g;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function iI(g,I){var C=g.pendingLanes;if(0===C)return 0;var e=0,l=g.suspendedLanes,A=g.pingedLanes,t=268435455&C;if(0!==t){var n=t&~l;0!==n?e=dI(n):0!==(A&=t)&&(e=dI(A))}else 0!==(t=C&~l)?e=dI(t):0!==A&&(e=dI(A));if(0===e)return 0;if(0!==I&&I!==e&&0===(I&l)&&((l=e&-e)>=(A=I&-I)||16===l&&0!==(4194240&A)))return I;if(0!==(4&e)&&(e|=16&C),0!==(I=g.entangledLanes))for(g=g.entanglements,I&=e;0<I;)l=1<<(C=31-tI(I)),e|=g[C],I&=~l;return e}function sI(g,I){switch(g){case 1:case 2:case 4:return I+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return I+5e3;default:return-1}}function rI(g){return 0!==(g=-1073741825&g.pendingLanes)?g:1073741824&g?1073741824:0}function bI(){var g=aI;return 0===(4194240&(aI<<=1))&&(aI=64),g}function mI(g){for(var I=[],C=0;31>C;C++)I.push(g);return I}function ZI(g,I,C){g.pendingLanes|=I,536870912!==I&&(g.suspendedLanes=0,g.pingedLanes=0),(g=g.eventTimes)[I=31-tI(I)]=C}function uI(g,I){var C=g.entangledLanes|=I;for(g=g.entanglements;C;){var e=31-tI(C),l=1<<e;l&I|g[e]&I&&(g[e]|=I),C&=~l}}var GI=0;function BI(g){return 1<(g&=-g)?4<g?0!==(268435455&g)?16:536870912:4:1}var hI,pI,yI,WI,VI,SI=!1,XI=[],RI=null,kI=null,JI=null,YI=new Map,vI=new Map,HI=[],NI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fI(g,I){switch(g){case"focusin":case"focusout":RI=null;break;case"dragenter":case"dragleave":kI=null;break;case"mouseover":case"mouseout":JI=null;break;case"pointerover":case"pointerout":YI.delete(I.pointerId);break;case"gotpointercapture":case"lostpointercapture":vI.delete(I.pointerId)}}function KI(g,I,C,e,l,A){return null===g||g.nativeEvent!==A?(g={blockedOn:I,domEventName:C,eventSystemFlags:e,nativeEvent:A,targetContainers:[l]},null!==I&&(null!==(I=ul(I))&&pI(I)),g):(g.eventSystemFlags|=e,I=g.targetContainers,null!==l&&-1===I.indexOf(l)&&I.push(l),g)}function wI(g){var I=Zl(g.target);if(null!==I){var C=Qg(I);if(null!==C)if(13===(I=C.tag)){if(null!==(I=Eg(C)))return g.blockedOn=I,void VI(g.priority,(function(){yI(C)}))}else if(3===I&&C.stateNode.current.memoizedState.isDehydrated)return void(g.blockedOn=3===C.tag?C.stateNode.containerInfo:null)}g.blockedOn=null}function FI(g){if(null!==g.blockedOn)return!1;for(var I=g.targetContainers;0<I.length;){var C=PI(g.domEventName,g.eventSystemFlags,I[0],g.nativeEvent);if(null!==C)return null!==(I=ul(C))&&pI(I),g.blockedOn=C,!1;var e=new(C=g.nativeEvent).constructor(C.type,C);Bg=e,C.target.dispatchEvent(e),Bg=null,I.shift()}return!0}function xI(g,I,C){FI(g)&&C.delete(I)}function zI(){SI=!1,null!==RI&&FI(RI)&&(RI=null),null!==kI&&FI(kI)&&(kI=null),null!==JI&&FI(JI)&&(JI=null),YI.forEach(xI),vI.forEach(xI)}function UI(g,I){g.blockedOn===I&&(g.blockedOn=null,SI||(SI=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,zI)))}function QI(g){function I(I){return UI(I,g)}if(0<XI.length){UI(XI[0],g);for(var C=1;C<XI.length;C++){var e=XI[C];e.blockedOn===g&&(e.blockedOn=null)}}for(null!==RI&&UI(RI,g),null!==kI&&UI(kI,g),null!==JI&&UI(JI,g),YI.forEach(I),vI.forEach(I),C=0;C<HI.length;C++)(e=HI[C]).blockedOn===g&&(e.blockedOn=null);for(;0<HI.length&&null===(C=HI[0]).blockedOn;)wI(C),null===C.blockedOn&&HI.shift()}var EI=B.ReactCurrentBatchConfig,LI=!0;function MI(g,I,C,e){var l=GI,A=EI.transition;EI.transition=null;try{GI=1,TI(g,I,C,e)}finally{GI=l,EI.transition=A}}function DI(g,I,C,e){var l=GI,A=EI.transition;EI.transition=null;try{GI=4,TI(g,I,C,e)}finally{GI=l,EI.transition=A}}function TI(g,I,C,e){if(LI){var l=PI(g,I,C,e);if(null===l)Ee(g,I,e,jI,C),fI(g,e);else if(function(g,I,C,e,l){switch(I){case"focusin":return RI=KI(RI,g,I,C,e,l),!0;case"dragenter":return kI=KI(kI,g,I,C,e,l),!0;case"mouseover":return JI=KI(JI,g,I,C,e,l),!0;case"pointerover":var A=l.pointerId;return YI.set(A,KI(YI.get(A)||null,g,I,C,e,l)),!0;case"gotpointercapture":return A=l.pointerId,vI.set(A,KI(vI.get(A)||null,g,I,C,e,l)),!0}return!1}(l,g,I,C,e))e.stopPropagation();else if(fI(g,e),4&I&&-1<NI.indexOf(g)){for(;null!==l;){var A=ul(l);if(null!==A&&hI(A),null===(A=PI(g,I,C,e))&&Ee(g,I,e,jI,C),A===l)break;l=A}null!==l&&e.stopPropagation()}else Ee(g,I,e,null,C)}}var jI=null;function PI(g,I,C,e){if(jI=null,null!==(g=Zl(g=hg(e))))if(null===(I=Qg(g)))g=null;else if(13===(C=I.tag)){if(null!==(g=Eg(I)))return g;g=null}else if(3===C){if(I.stateNode.current.memoizedState.isDehydrated)return 3===I.tag?I.stateNode.containerInfo:null;g=null}else I!==g&&(g=null);return jI=g,null}function OI(g){switch(g){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_g()){case $g:return 1;case gI:return 4;case II:case CI:return 16;case eI:return 536870912;default:return 16}default:return 16}}var qI=null,_I=null,$I=null;function gC(){if($I)return $I;var g,I,C=_I,e=C.length,l="value"in qI?qI.value:qI.textContent,A=l.length;for(g=0;g<e&&C[g]===l[g];g++);var t=e-g;for(I=1;I<=t&&C[e-I]===l[A-I];I++);return $I=l.slice(g,1<I?1-I:void 0)}function IC(g){var I=g.keyCode;return"charCode"in g?0===(g=g.charCode)&&13===I&&(g=13):g=I,10===g&&(g=13),32<=g||13===g?g:0}function CC(){return!0}function eC(){return!1}function lC(g){function I(I,C,e,l,A){for(var t in this._reactName=I,this._targetInst=e,this.type=C,this.nativeEvent=l,this.target=A,this.currentTarget=null,g)g.hasOwnProperty(t)&&(I=g[t],this[t]=I?I(l):l[t]);return this.isDefaultPrevented=(null!=l.defaultPrevented?l.defaultPrevented:!1===l.returnValue)?CC:eC,this.isPropagationStopped=eC,this}return w(I.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():"unknown"!==typeof g.returnValue&&(g.returnValue=!1),this.isDefaultPrevented=CC)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():"unknown"!==typeof g.cancelBubble&&(g.cancelBubble=!0),this.isPropagationStopped=CC)},persist:function(){},isPersistent:CC}),I}var AC,tC,nC,oC={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},aC=lC(oC),cC=w({},oC,{view:0,detail:0}),dC=lC(cC),iC=w({},cC,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:WC,button:0,buttons:0,relatedTarget:function(g){return void 0===g.relatedTarget?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){return"movementX"in g?g.movementX:(g!==nC&&(nC&&"mousemove"===g.type?(AC=g.screenX-nC.screenX,tC=g.screenY-nC.screenY):tC=AC=0,nC=g),AC)},movementY:function(g){return"movementY"in g?g.movementY:tC}}),sC=lC(iC),rC=lC(w({},iC,{dataTransfer:0})),bC=lC(w({},cC,{relatedTarget:0})),mC=lC(w({},oC,{animationName:0,elapsedTime:0,pseudoElement:0})),ZC=w({},oC,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),uC=lC(ZC),GC=lC(w({},oC,{data:0})),BC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yC(g){var I=this.nativeEvent;return I.getModifierState?I.getModifierState(g):!!(g=pC[g])&&!!I[g]}function WC(){return yC}var VC=w({},cC,{key:function(g){if(g.key){var I=BC[g.key]||g.key;if("Unidentified"!==I)return I}return"keypress"===g.type?13===(g=IC(g))?"Enter":String.fromCharCode(g):"keydown"===g.type||"keyup"===g.type?hC[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:WC,charCode:function(g){return"keypress"===g.type?IC(g):0},keyCode:function(g){return"keydown"===g.type||"keyup"===g.type?g.keyCode:0},which:function(g){return"keypress"===g.type?IC(g):"keydown"===g.type||"keyup"===g.type?g.keyCode:0}}),SC=lC(VC),XC=lC(w({},iC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),RC=lC(w({},cC,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:WC})),kC=lC(w({},oC,{propertyName:0,elapsedTime:0,pseudoElement:0})),JC=w({},iC,{deltaX:function(g){return"deltaX"in g?g.deltaX:"wheelDeltaX"in g?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:"wheelDeltaY"in g?-g.wheelDeltaY:"wheelDelta"in g?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),YC=lC(JC),vC=[9,13,27,32],HC=c&&"CompositionEvent"in window,NC=null;c&&"documentMode"in document&&(NC=document.documentMode);var fC=c&&"TextEvent"in window&&!NC,KC=c&&(!HC||NC&&8<NC&&11>=NC),wC=String.fromCharCode(32),FC=!1;function xC(g,I){switch(g){case"keyup":return-1!==vC.indexOf(I.keyCode);case"keydown":return 229!==I.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zC(g){return"object"===typeof(g=g.detail)&&"data"in g?g.data:null}var UC=!1;var QC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function EC(g){var I=g&&g.nodeName&&g.nodeName.toLowerCase();return"input"===I?!!QC[g.type]:"textarea"===I}function LC(g,I,C,e){Sg(e),0<(I=Me(I,"onChange")).length&&(C=new aC("onChange","change",null,C,e),g.push({event:C,listeners:I}))}var MC=null,DC=null;function TC(g){we(g,0)}function jC(g){if(T(Gl(g)))return g}function PC(g,I){if("change"===g)return I}var OC=!1;if(c){var qC;if(c){var _C="oninput"in document;if(!_C){var $C=document.createElement("div");$C.setAttribute("oninput","return;"),_C="function"===typeof $C.oninput}qC=_C}else qC=!1;OC=qC&&(!document.documentMode||9<document.documentMode)}function ge(){MC&&(MC.detachEvent("onpropertychange",Ie),DC=MC=null)}function Ie(g){if("value"===g.propertyName&&jC(DC)){var I=[];LC(I,DC,g,hg(g)),Yg(TC,I)}}function Ce(g,I,C){"focusin"===g?(ge(),DC=C,(MC=I).attachEvent("onpropertychange",Ie)):"focusout"===g&&ge()}function ee(g){if("selectionchange"===g||"keyup"===g||"keydown"===g)return jC(DC)}function le(g,I){if("click"===g)return jC(I)}function Ae(g,I){if("input"===g||"change"===g)return jC(I)}var te="function"===typeof Object.is?Object.is:function(g,I){return g===I&&(0!==g||1/g===1/I)||g!==g&&I!==I};function ne(g,I){if(te(g,I))return!0;if("object"!==typeof g||null===g||"object"!==typeof I||null===I)return!1;var C=Object.keys(g),e=Object.keys(I);if(C.length!==e.length)return!1;for(e=0;e<C.length;e++){var l=C[e];if(!d.call(I,l)||!te(g[l],I[l]))return!1}return!0}function oe(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function ae(g,I){var C,e=oe(g);for(g=0;e;){if(3===e.nodeType){if(C=g+e.textContent.length,g<=I&&C>=I)return{node:e,offset:I-g};g=C}g:{for(;e;){if(e.nextSibling){e=e.nextSibling;break g}e=e.parentNode}e=void 0}e=oe(e)}}function ce(g,I){return!(!g||!I)&&(g===I||(!g||3!==g.nodeType)&&(I&&3===I.nodeType?ce(g,I.parentNode):"contains"in g?g.contains(I):!!g.compareDocumentPosition&&!!(16&g.compareDocumentPosition(I))))}function de(){for(var g=window,I=j();I instanceof g.HTMLIFrameElement;){try{var C="string"===typeof I.contentWindow.location.href}catch(e){C=!1}if(!C)break;I=j((g=I.contentWindow).document)}return I}function ie(g){var I=g&&g.nodeName&&g.nodeName.toLowerCase();return I&&("input"===I&&("text"===g.type||"search"===g.type||"tel"===g.type||"url"===g.type||"password"===g.type)||"textarea"===I||"true"===g.contentEditable)}function se(g){var I=de(),C=g.focusedElem,e=g.selectionRange;if(I!==C&&C&&C.ownerDocument&&ce(C.ownerDocument.documentElement,C)){if(null!==e&&ie(C))if(I=e.start,void 0===(g=e.end)&&(g=I),"selectionStart"in C)C.selectionStart=I,C.selectionEnd=Math.min(g,C.value.length);else if((g=(I=C.ownerDocument||document)&&I.defaultView||window).getSelection){g=g.getSelection();var l=C.textContent.length,A=Math.min(e.start,l);e=void 0===e.end?A:Math.min(e.end,l),!g.extend&&A>e&&(l=e,e=A,A=l),l=ae(C,A);var t=ae(C,e);l&&t&&(1!==g.rangeCount||g.anchorNode!==l.node||g.anchorOffset!==l.offset||g.focusNode!==t.node||g.focusOffset!==t.offset)&&((I=I.createRange()).setStart(l.node,l.offset),g.removeAllRanges(),A>e?(g.addRange(I),g.extend(t.node,t.offset)):(I.setEnd(t.node,t.offset),g.addRange(I)))}for(I=[],g=C;g=g.parentNode;)1===g.nodeType&&I.push({element:g,left:g.scrollLeft,top:g.scrollTop});for("function"===typeof C.focus&&C.focus(),C=0;C<I.length;C++)(g=I[C]).element.scrollLeft=g.left,g.element.scrollTop=g.top}}var re=c&&"documentMode"in document&&11>=document.documentMode,be=null,me=null,Ze=null,ue=!1;function Ge(g,I,C){var e=C.window===C?C.document:9===C.nodeType?C:C.ownerDocument;ue||null==be||be!==j(e)||("selectionStart"in(e=be)&&ie(e)?e={start:e.selectionStart,end:e.selectionEnd}:e={anchorNode:(e=(e.ownerDocument&&e.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:e.anchorOffset,focusNode:e.focusNode,focusOffset:e.focusOffset},Ze&&ne(Ze,e)||(Ze=e,0<(e=Me(me,"onSelect")).length&&(I=new aC("onSelect","select",null,I,C),g.push({event:I,listeners:e}),I.target=be)))}function Be(g,I){var C={};return C[g.toLowerCase()]=I.toLowerCase(),C["Webkit"+g]="webkit"+I,C["Moz"+g]="moz"+I,C}var he={animationend:Be("Animation","AnimationEnd"),animationiteration:Be("Animation","AnimationIteration"),animationstart:Be("Animation","AnimationStart"),transitionend:Be("Transition","TransitionEnd")},pe={},ye={};function We(g){if(pe[g])return pe[g];if(!he[g])return g;var I,C=he[g];for(I in C)if(C.hasOwnProperty(I)&&I in ye)return pe[g]=C[I];return g}c&&(ye=document.createElement("div").style,"AnimationEvent"in window||(delete he.animationend.animation,delete he.animationiteration.animation,delete he.animationstart.animation),"TransitionEvent"in window||delete he.transitionend.transition);var Ve=We("animationend"),Se=We("animationiteration"),Xe=We("animationstart"),Re=We("transitionend"),ke=new Map,Je="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ye(g,I){ke.set(g,I),o(I,[g])}for(var ve=0;ve<Je.length;ve++){var He=Je[ve];Ye(He.toLowerCase(),"on"+(He[0].toUpperCase()+He.slice(1)))}Ye(Ve,"onAnimationEnd"),Ye(Se,"onAnimationIteration"),Ye(Xe,"onAnimationStart"),Ye("dblclick","onDoubleClick"),Ye("focusin","onFocus"),Ye("focusout","onBlur"),Ye(Re,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ne="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ne));function Ke(g,I,C){var e=g.type||"unknown-event";g.currentTarget=C,function(g,I,C,e,l,t,n,o,a){if(Ug.apply(this,arguments),Kg){if(!Kg)throw Error(A(198));var c=wg;Kg=!1,wg=null,Fg||(Fg=!0,xg=c)}}(e,I,void 0,g),g.currentTarget=null}function we(g,I){I=0!==(4&I);for(var C=0;C<g.length;C++){var e=g[C],l=e.event;e=e.listeners;g:{var A=void 0;if(I)for(var t=e.length-1;0<=t;t--){var n=e[t],o=n.instance,a=n.currentTarget;if(n=n.listener,o!==A&&l.isPropagationStopped())break g;Ke(l,n,a),A=o}else for(t=0;t<e.length;t++){if(o=(n=e[t]).instance,a=n.currentTarget,n=n.listener,o!==A&&l.isPropagationStopped())break g;Ke(l,n,a),A=o}}}if(Fg)throw g=xg,Fg=!1,xg=null,g}function Fe(g,I){var C=I[rl];void 0===C&&(C=I[rl]=new Set);var e=g+"__bubble";C.has(e)||(Qe(I,g,2,!1),C.add(e))}function xe(g,I,C){var e=0;I&&(e|=4),Qe(C,g,e,I)}var ze="_reactListening"+Math.random().toString(36).slice(2);function Ue(g){if(!g[ze]){g[ze]=!0,t.forEach((function(I){"selectionchange"!==I&&(fe.has(I)||xe(I,!1,g),xe(I,!0,g))}));var I=9===g.nodeType?g:g.ownerDocument;null===I||I[ze]||(I[ze]=!0,xe("selectionchange",!1,I))}}function Qe(g,I,C,e){switch(OI(I)){case 1:var l=MI;break;case 4:l=DI;break;default:l=TI}C=l.bind(null,I,C,g),l=void 0,!Hg||"touchstart"!==I&&"touchmove"!==I&&"wheel"!==I||(l=!0),e?void 0!==l?g.addEventListener(I,C,{capture:!0,passive:l}):g.addEventListener(I,C,!0):void 0!==l?g.addEventListener(I,C,{passive:l}):g.addEventListener(I,C,!1)}function Ee(g,I,C,e,l){var A=e;if(0===(1&I)&&0===(2&I)&&null!==e)g:for(;;){if(null===e)return;var t=e.tag;if(3===t||4===t){var n=e.stateNode.containerInfo;if(n===l||8===n.nodeType&&n.parentNode===l)break;if(4===t)for(t=e.return;null!==t;){var o=t.tag;if((3===o||4===o)&&((o=t.stateNode.containerInfo)===l||8===o.nodeType&&o.parentNode===l))return;t=t.return}for(;null!==n;){if(null===(t=Zl(n)))return;if(5===(o=t.tag)||6===o){e=A=t;continue g}n=n.parentNode}}e=e.return}Yg((function(){var e=A,l=hg(C),t=[];g:{var n=ke.get(g);if(void 0!==n){var o=aC,a=g;switch(g){case"keypress":if(0===IC(C))break g;case"keydown":case"keyup":o=SC;break;case"focusin":a="focus",o=bC;break;case"focusout":a="blur",o=bC;break;case"beforeblur":case"afterblur":o=bC;break;case"click":if(2===C.button)break g;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=sC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=rC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=RC;break;case Ve:case Se:case Xe:o=mC;break;case Re:o=kC;break;case"scroll":o=dC;break;case"wheel":o=YC;break;case"copy":case"cut":case"paste":o=uC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=XC}var c=0!==(4&I),d=!c&&"scroll"===g,i=c?null!==n?n+"Capture":null:n;c=[];for(var s,r=e;null!==r;){var b=(s=r).stateNode;if(5===s.tag&&null!==b&&(s=b,null!==i&&(null!=(b=vg(r,i))&&c.push(Le(r,b,s)))),d)break;r=r.return}0<c.length&&(n=new o(n,a,null,C,l),t.push({event:n,listeners:c}))}}if(0===(7&I)){if(o="mouseout"===g||"pointerout"===g,(!(n="mouseover"===g||"pointerover"===g)||C===Bg||!(a=C.relatedTarget||C.fromElement)||!Zl(a)&&!a[sl])&&(o||n)&&(n=l.window===l?l:(n=l.ownerDocument)?n.defaultView||n.parentWindow:window,o?(o=e,null!==(a=(a=C.relatedTarget||C.toElement)?Zl(a):null)&&(a!==(d=Qg(a))||5!==a.tag&&6!==a.tag)&&(a=null)):(o=null,a=e),o!==a)){if(c=sC,b="onMouseLeave",i="onMouseEnter",r="mouse","pointerout"!==g&&"pointerover"!==g||(c=XC,b="onPointerLeave",i="onPointerEnter",r="pointer"),d=null==o?n:Gl(o),s=null==a?n:Gl(a),(n=new c(b,r+"leave",o,C,l)).target=d,n.relatedTarget=s,b=null,Zl(l)===e&&((c=new c(i,r+"enter",a,C,l)).target=s,c.relatedTarget=d,b=c),d=b,o&&a)g:{for(i=a,r=0,s=c=o;s;s=De(s))r++;for(s=0,b=i;b;b=De(b))s++;for(;0<r-s;)c=De(c),r--;for(;0<s-r;)i=De(i),s--;for(;r--;){if(c===i||null!==i&&c===i.alternate)break g;c=De(c),i=De(i)}c=null}else c=null;null!==o&&Te(t,n,o,c,!1),null!==a&&null!==d&&Te(t,d,a,c,!0)}if("select"===(o=(n=e?Gl(e):window).nodeName&&n.nodeName.toLowerCase())||"input"===o&&"file"===n.type)var m=PC;else if(EC(n))if(OC)m=Ae;else{m=ee;var Z=Ce}else(o=n.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===n.type||"radio"===n.type)&&(m=le);switch(m&&(m=m(g,e))?LC(t,m,C,l):(Z&&Z(g,n,e),"focusout"===g&&(Z=n._wrapperState)&&Z.controlled&&"number"===n.type&&gg(n,"number",n.value)),Z=e?Gl(e):window,g){case"focusin":(EC(Z)||"true"===Z.contentEditable)&&(be=Z,me=e,Ze=null);break;case"focusout":Ze=me=be=null;break;case"mousedown":ue=!0;break;case"contextmenu":case"mouseup":case"dragend":ue=!1,Ge(t,C,l);break;case"selectionchange":if(re)break;case"keydown":case"keyup":Ge(t,C,l)}var u;if(HC)g:{switch(g){case"compositionstart":var G="onCompositionStart";break g;case"compositionend":G="onCompositionEnd";break g;case"compositionupdate":G="onCompositionUpdate";break g}G=void 0}else UC?xC(g,C)&&(G="onCompositionEnd"):"keydown"===g&&229===C.keyCode&&(G="onCompositionStart");G&&(KC&&"ko"!==C.locale&&(UC||"onCompositionStart"!==G?"onCompositionEnd"===G&&UC&&(u=gC()):(_I="value"in(qI=l)?qI.value:qI.textContent,UC=!0)),0<(Z=Me(e,G)).length&&(G=new GC(G,g,null,C,l),t.push({event:G,listeners:Z}),u?G.data=u:null!==(u=zC(C))&&(G.data=u))),(u=fC?function(g,I){switch(g){case"compositionend":return zC(I);case"keypress":return 32!==I.which?null:(FC=!0,wC);case"textInput":return(g=I.data)===wC&&FC?null:g;default:return null}}(g,C):function(g,I){if(UC)return"compositionend"===g||!HC&&xC(g,I)?(g=gC(),$I=_I=qI=null,UC=!1,g):null;switch(g){case"paste":default:return null;case"keypress":if(!(I.ctrlKey||I.altKey||I.metaKey)||I.ctrlKey&&I.altKey){if(I.char&&1<I.char.length)return I.char;if(I.which)return String.fromCharCode(I.which)}return null;case"compositionend":return KC&&"ko"!==I.locale?null:I.data}}(g,C))&&(0<(e=Me(e,"onBeforeInput")).length&&(l=new GC("onBeforeInput","beforeinput",null,C,l),t.push({event:l,listeners:e}),l.data=u))}we(t,I)}))}function Le(g,I,C){return{instance:g,listener:I,currentTarget:C}}function Me(g,I){for(var C=I+"Capture",e=[];null!==g;){var l=g,A=l.stateNode;5===l.tag&&null!==A&&(l=A,null!=(A=vg(g,C))&&e.unshift(Le(g,A,l)),null!=(A=vg(g,I))&&e.push(Le(g,A,l))),g=g.return}return e}function De(g){if(null===g)return null;do{g=g.return}while(g&&5!==g.tag);return g||null}function Te(g,I,C,e,l){for(var A=I._reactName,t=[];null!==C&&C!==e;){var n=C,o=n.alternate,a=n.stateNode;if(null!==o&&o===e)break;5===n.tag&&null!==a&&(n=a,l?null!=(o=vg(C,A))&&t.unshift(Le(C,o,n)):l||null!=(o=vg(C,A))&&t.push(Le(C,o,n))),C=C.return}0!==t.length&&g.push({event:I,listeners:t})}var je=/\r\n?/g,Pe=/\u0000|\uFFFD/g;function Oe(g){return("string"===typeof g?g:""+g).replace(je,"\n").replace(Pe,"")}function qe(g,I,C){if(I=Oe(I),Oe(g)!==I&&C)throw Error(A(425))}function _e(){}var $e=null,gl=null;function Il(g,I){return"textarea"===g||"noscript"===g||"string"===typeof I.children||"number"===typeof I.children||"object"===typeof I.dangerouslySetInnerHTML&&null!==I.dangerouslySetInnerHTML&&null!=I.dangerouslySetInnerHTML.__html}var Cl="function"===typeof setTimeout?setTimeout:void 0,el="function"===typeof clearTimeout?clearTimeout:void 0,ll="function"===typeof Promise?Promise:void 0,Al="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ll?function(g){return ll.resolve(null).then(g).catch(tl)}:Cl;function tl(g){setTimeout((function(){throw g}))}function nl(g,I){var C=I,e=0;do{var l=C.nextSibling;if(g.removeChild(C),l&&8===l.nodeType)if("/$"===(C=l.data)){if(0===e)return g.removeChild(l),void QI(I);e--}else"$"!==C&&"$?"!==C&&"$!"!==C||e++;C=l}while(C);QI(I)}function ol(g){for(;null!=g;g=g.nextSibling){var I=g.nodeType;if(1===I||3===I)break;if(8===I){if("$"===(I=g.data)||"$!"===I||"$?"===I)break;if("/$"===I)return null}}return g}function al(g){g=g.previousSibling;for(var I=0;g;){if(8===g.nodeType){var C=g.data;if("$"===C||"$!"===C||"$?"===C){if(0===I)return g;I--}else"/$"===C&&I++}g=g.previousSibling}return null}var cl=Math.random().toString(36).slice(2),dl="__reactFiber$"+cl,il="__reactProps$"+cl,sl="__reactContainer$"+cl,rl="__reactEvents$"+cl,bl="__reactListeners$"+cl,ml="__reactHandles$"+cl;function Zl(g){var I=g[dl];if(I)return I;for(var C=g.parentNode;C;){if(I=C[sl]||C[dl]){if(C=I.alternate,null!==I.child||null!==C&&null!==C.child)for(g=al(g);null!==g;){if(C=g[dl])return C;g=al(g)}return I}C=(g=C).parentNode}return null}function ul(g){return!(g=g[dl]||g[sl])||5!==g.tag&&6!==g.tag&&13!==g.tag&&3!==g.tag?null:g}function Gl(g){if(5===g.tag||6===g.tag)return g.stateNode;throw Error(A(33))}function Bl(g){return g[il]||null}var hl=[],pl=-1;function yl(g){return{current:g}}function Wl(g){0>pl||(g.current=hl[pl],hl[pl]=null,pl--)}function Vl(g,I){pl++,hl[pl]=g.current,g.current=I}var Sl={},Xl=yl(Sl),Rl=yl(!1),kl=Sl;function Jl(g,I){var C=g.type.contextTypes;if(!C)return Sl;var e=g.stateNode;if(e&&e.__reactInternalMemoizedUnmaskedChildContext===I)return e.__reactInternalMemoizedMaskedChildContext;var l,A={};for(l in C)A[l]=I[l];return e&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=I,g.__reactInternalMemoizedMaskedChildContext=A),A}function Yl(g){return null!==(g=g.childContextTypes)&&void 0!==g}function vl(){Wl(Rl),Wl(Xl)}function Hl(g,I,C){if(Xl.current!==Sl)throw Error(A(168));Vl(Xl,I),Vl(Rl,C)}function Nl(g,I,C){var e=g.stateNode;if(I=I.childContextTypes,"function"!==typeof e.getChildContext)return C;for(var l in e=e.getChildContext())if(!(l in I))throw Error(A(108,E(g)||"Unknown",l));return w({},C,e)}function fl(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||Sl,kl=Xl.current,Vl(Xl,g),Vl(Rl,Rl.current),!0}function Kl(g,I,C){var e=g.stateNode;if(!e)throw Error(A(169));C?(g=Nl(g,I,kl),e.__reactInternalMemoizedMergedChildContext=g,Wl(Rl),Wl(Xl),Vl(Xl,g)):Wl(Rl),Vl(Rl,C)}var wl=null,Fl=!1,xl=!1;function zl(g){null===wl?wl=[g]:wl.push(g)}function Ul(){if(!xl&&null!==wl){xl=!0;var g=0,I=GI;try{var C=wl;for(GI=1;g<C.length;g++){var e=C[g];do{e=e(!0)}while(null!==e)}wl=null,Fl=!1}catch(l){throw null!==wl&&(wl=wl.slice(g+1)),Tg($g,Ul),l}finally{GI=I,xl=!1}}return null}var Ql=[],El=0,Ll=null,Ml=0,Dl=[],Tl=0,jl=null,Pl=1,Ol="";function ql(g,I){Ql[El++]=Ml,Ql[El++]=Ll,Ll=g,Ml=I}function _l(g,I,C){Dl[Tl++]=Pl,Dl[Tl++]=Ol,Dl[Tl++]=jl,jl=g;var e=Pl;g=Ol;var l=32-tI(e)-1;e&=~(1<<l),C+=1;var A=32-tI(I)+l;if(30<A){var t=l-l%5;A=(e&(1<<t)-1).toString(32),e>>=t,l-=t,Pl=1<<32-tI(I)+l|C<<l|e,Ol=A+g}else Pl=1<<A|C<<l|e,Ol=g}function $l(g){null!==g.return&&(ql(g,1),_l(g,1,0))}function gA(g){for(;g===Ll;)Ll=Ql[--El],Ql[El]=null,Ml=Ql[--El],Ql[El]=null;for(;g===jl;)jl=Dl[--Tl],Dl[Tl]=null,Ol=Dl[--Tl],Dl[Tl]=null,Pl=Dl[--Tl],Dl[Tl]=null}var IA=null,CA=null,eA=!1,lA=null;function AA(g,I){var C=va(5,null,null,0);C.elementType="DELETED",C.stateNode=I,C.return=g,null===(I=g.deletions)?(g.deletions=[C],g.flags|=16):I.push(C)}function tA(g,I){switch(g.tag){case 5:var C=g.type;return null!==(I=1!==I.nodeType||C.toLowerCase()!==I.nodeName.toLowerCase()?null:I)&&(g.stateNode=I,IA=g,CA=ol(I.firstChild),!0);case 6:return null!==(I=""===g.pendingProps||3!==I.nodeType?null:I)&&(g.stateNode=I,IA=g,CA=null,!0);case 13:return null!==(I=8!==I.nodeType?null:I)&&(C=null!==jl?{id:Pl,overflow:Ol}:null,g.memoizedState={dehydrated:I,treeContext:C,retryLane:1073741824},(C=va(18,null,null,0)).stateNode=I,C.return=g,g.child=C,IA=g,CA=null,!0);default:return!1}}function nA(g){return 0!==(1&g.mode)&&0===(128&g.flags)}function oA(g){if(eA){var I=CA;if(I){var C=I;if(!tA(g,I)){if(nA(g))throw Error(A(418));I=ol(C.nextSibling);var e=IA;I&&tA(g,I)?AA(e,C):(g.flags=-4097&g.flags|2,eA=!1,IA=g)}}else{if(nA(g))throw Error(A(418));g.flags=-4097&g.flags|2,eA=!1,IA=g}}}function aA(g){for(g=g.return;null!==g&&5!==g.tag&&3!==g.tag&&13!==g.tag;)g=g.return;IA=g}function cA(g){if(g!==IA)return!1;if(!eA)return aA(g),eA=!0,!1;var I;if((I=3!==g.tag)&&!(I=5!==g.tag)&&(I="head"!==(I=g.type)&&"body"!==I&&!Il(g.type,g.memoizedProps)),I&&(I=CA)){if(nA(g))throw dA(),Error(A(418));for(;I;)AA(g,I),I=ol(I.nextSibling)}if(aA(g),13===g.tag){if(!(g=null!==(g=g.memoizedState)?g.dehydrated:null))throw Error(A(317));g:{for(g=g.nextSibling,I=0;g;){if(8===g.nodeType){var C=g.data;if("/$"===C){if(0===I){CA=ol(g.nextSibling);break g}I--}else"$"!==C&&"$!"!==C&&"$?"!==C||I++}g=g.nextSibling}CA=null}}else CA=IA?ol(g.stateNode.nextSibling):null;return!0}function dA(){for(var g=CA;g;)g=ol(g.nextSibling)}function iA(){CA=IA=null,eA=!1}function sA(g){null===lA?lA=[g]:lA.push(g)}var rA=B.ReactCurrentBatchConfig;function bA(g,I){if(g&&g.defaultProps){for(var C in I=w({},I),g=g.defaultProps)void 0===I[C]&&(I[C]=g[C]);return I}return I}var mA=yl(null),ZA=null,uA=null,GA=null;function BA(){GA=uA=ZA=null}function hA(g){var I=mA.current;Wl(mA),g._currentValue=I}function pA(g,I,C){for(;null!==g;){var e=g.alternate;if((g.childLanes&I)!==I?(g.childLanes|=I,null!==e&&(e.childLanes|=I)):null!==e&&(e.childLanes&I)!==I&&(e.childLanes|=I),g===C)break;g=g.return}}function yA(g,I){ZA=g,GA=uA=null,null!==(g=g.dependencies)&&null!==g.firstContext&&(0!==(g.lanes&I)&&(Gn=!0),g.firstContext=null)}function WA(g){var I=g._currentValue;if(GA!==g)if(g={context:g,memoizedValue:I,next:null},null===uA){if(null===ZA)throw Error(A(308));uA=g,ZA.dependencies={lanes:0,firstContext:g}}else uA=uA.next=g;return I}var VA=null;function SA(g){null===VA?VA=[g]:VA.push(g)}function XA(g,I,C,e){var l=I.interleaved;return null===l?(C.next=C,SA(I)):(C.next=l.next,l.next=C),I.interleaved=C,RA(g,e)}function RA(g,I){g.lanes|=I;var C=g.alternate;for(null!==C&&(C.lanes|=I),C=g,g=g.return;null!==g;)g.childLanes|=I,null!==(C=g.alternate)&&(C.childLanes|=I),C=g,g=g.return;return 3===C.tag?C.stateNode:null}var kA=!1;function JA(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function YA(g,I){g=g.updateQueue,I.updateQueue===g&&(I.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function vA(g,I){return{eventTime:g,lane:I,tag:0,payload:null,callback:null,next:null}}function HA(g,I,C){var e=g.updateQueue;if(null===e)return null;if(e=e.shared,0!==(2&ko)){var l=e.pending;return null===l?I.next=I:(I.next=l.next,l.next=I),e.pending=I,RA(g,C)}return null===(l=e.interleaved)?(I.next=I,SA(e)):(I.next=l.next,l.next=I),e.interleaved=I,RA(g,C)}function NA(g,I,C){if(null!==(I=I.updateQueue)&&(I=I.shared,0!==(4194240&C))){var e=I.lanes;C|=e&=g.pendingLanes,I.lanes=C,uI(g,C)}}function fA(g,I){var C=g.updateQueue,e=g.alternate;if(null!==e&&C===(e=e.updateQueue)){var l=null,A=null;if(null!==(C=C.firstBaseUpdate)){do{var t={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};null===A?l=A=t:A=A.next=t,C=C.next}while(null!==C);null===A?l=A=I:A=A.next=I}else l=A=I;return C={baseState:e.baseState,firstBaseUpdate:l,lastBaseUpdate:A,shared:e.shared,effects:e.effects},void(g.updateQueue=C)}null===(g=C.lastBaseUpdate)?C.firstBaseUpdate=I:g.next=I,C.lastBaseUpdate=I}function KA(g,I,C,e){var l=g.updateQueue;kA=!1;var A=l.firstBaseUpdate,t=l.lastBaseUpdate,n=l.shared.pending;if(null!==n){l.shared.pending=null;var o=n,a=o.next;o.next=null,null===t?A=a:t.next=a,t=o;var c=g.alternate;null!==c&&((n=(c=c.updateQueue).lastBaseUpdate)!==t&&(null===n?c.firstBaseUpdate=a:n.next=a,c.lastBaseUpdate=o))}if(null!==A){var d=l.baseState;for(t=0,c=a=o=null,n=A;;){var i=n.lane,s=n.eventTime;if((e&i)===i){null!==c&&(c=c.next={eventTime:s,lane:0,tag:n.tag,payload:n.payload,callback:n.callback,next:null});g:{var r=g,b=n;switch(i=I,s=C,b.tag){case 1:if("function"===typeof(r=b.payload)){d=r.call(s,d,i);break g}d=r;break g;case 3:r.flags=-65537&r.flags|128;case 0:if(null===(i="function"===typeof(r=b.payload)?r.call(s,d,i):r)||void 0===i)break g;d=w({},d,i);break g;case 2:kA=!0}}null!==n.callback&&0!==n.lane&&(g.flags|=64,null===(i=l.effects)?l.effects=[n]:i.push(n))}else s={eventTime:s,lane:i,tag:n.tag,payload:n.payload,callback:n.callback,next:null},null===c?(a=c=s,o=d):c=c.next=s,t|=i;if(null===(n=n.next)){if(null===(n=l.shared.pending))break;n=(i=n).next,i.next=null,l.lastBaseUpdate=i,l.shared.pending=null}}if(null===c&&(o=d),l.baseState=o,l.firstBaseUpdate=a,l.lastBaseUpdate=c,null!==(I=l.shared.interleaved)){l=I;do{t|=l.lane,l=l.next}while(l!==I)}else null===A&&(l.shared.lanes=0);wo|=t,g.lanes=t,g.memoizedState=d}}function wA(g,I,C){if(g=I.effects,I.effects=null,null!==g)for(I=0;I<g.length;I++){var e=g[I],l=e.callback;if(null!==l){if(e.callback=null,e=C,"function"!==typeof l)throw Error(A(191,l));l.call(e)}}}var FA=(new e.Component).refs;function xA(g,I,C,e){C=null===(C=C(e,I=g.memoizedState))||void 0===C?I:w({},I,C),g.memoizedState=C,0===g.lanes&&(g.updateQueue.baseState=C)}var zA={isMounted:function(g){return!!(g=g._reactInternals)&&Qg(g)===g},enqueueSetState:function(g,I,C){g=g._reactInternals;var e=Ia(),l=Ca(g),A=vA(e,l);A.payload=I,void 0!==C&&null!==C&&(A.callback=C),null!==(I=HA(g,A,l))&&(ea(I,g,l,e),NA(I,g,l))},enqueueReplaceState:function(g,I,C){g=g._reactInternals;var e=Ia(),l=Ca(g),A=vA(e,l);A.tag=1,A.payload=I,void 0!==C&&null!==C&&(A.callback=C),null!==(I=HA(g,A,l))&&(ea(I,g,l,e),NA(I,g,l))},enqueueForceUpdate:function(g,I){g=g._reactInternals;var C=Ia(),e=Ca(g),l=vA(C,e);l.tag=2,void 0!==I&&null!==I&&(l.callback=I),null!==(I=HA(g,l,e))&&(ea(I,g,e,C),NA(I,g,e))}};function UA(g,I,C,e,l,A,t){return"function"===typeof(g=g.stateNode).shouldComponentUpdate?g.shouldComponentUpdate(e,A,t):!I.prototype||!I.prototype.isPureReactComponent||(!ne(C,e)||!ne(l,A))}function QA(g,I,C){var e=!1,l=Sl,A=I.contextType;return"object"===typeof A&&null!==A?A=WA(A):(l=Yl(I)?kl:Xl.current,A=(e=null!==(e=I.contextTypes)&&void 0!==e)?Jl(g,l):Sl),I=new I(C,A),g.memoizedState=null!==I.state&&void 0!==I.state?I.state:null,I.updater=zA,g.stateNode=I,I._reactInternals=g,e&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=l,g.__reactInternalMemoizedMaskedChildContext=A),I}function EA(g,I,C,e){g=I.state,"function"===typeof I.componentWillReceiveProps&&I.componentWillReceiveProps(C,e),"function"===typeof I.UNSAFE_componentWillReceiveProps&&I.UNSAFE_componentWillReceiveProps(C,e),I.state!==g&&zA.enqueueReplaceState(I,I.state,null)}function LA(g,I,C,e){var l=g.stateNode;l.props=C,l.state=g.memoizedState,l.refs=FA,JA(g);var A=I.contextType;"object"===typeof A&&null!==A?l.context=WA(A):(A=Yl(I)?kl:Xl.current,l.context=Jl(g,A)),l.state=g.memoizedState,"function"===typeof(A=I.getDerivedStateFromProps)&&(xA(g,I,A,C),l.state=g.memoizedState),"function"===typeof I.getDerivedStateFromProps||"function"===typeof l.getSnapshotBeforeUpdate||"function"!==typeof l.UNSAFE_componentWillMount&&"function"!==typeof l.componentWillMount||(I=l.state,"function"===typeof l.componentWillMount&&l.componentWillMount(),"function"===typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount(),I!==l.state&&zA.enqueueReplaceState(l,l.state,null),KA(g,C,l,e),l.state=g.memoizedState),"function"===typeof l.componentDidMount&&(g.flags|=4194308)}function MA(g,I,C){if(null!==(g=C.ref)&&"function"!==typeof g&&"object"!==typeof g){if(C._owner){if(C=C._owner){if(1!==C.tag)throw Error(A(309));var e=C.stateNode}if(!e)throw Error(A(147,g));var l=e,t=""+g;return null!==I&&null!==I.ref&&"function"===typeof I.ref&&I.ref._stringRef===t?I.ref:(I=function(g){var I=l.refs;I===FA&&(I=l.refs={}),null===g?delete I[t]:I[t]=g},I._stringRef=t,I)}if("string"!==typeof g)throw Error(A(284));if(!C._owner)throw Error(A(290,g))}return g}function DA(g,I){throw g=Object.prototype.toString.call(I),Error(A(31,"[object Object]"===g?"object with keys {"+Object.keys(I).join(", ")+"}":g))}function TA(g){return(0,g._init)(g._payload)}function jA(g){function I(I,C){if(g){var e=I.deletions;null===e?(I.deletions=[C],I.flags|=16):e.push(C)}}function C(C,e){if(!g)return null;for(;null!==e;)I(C,e),e=e.sibling;return null}function e(g,I){for(g=new Map;null!==I;)null!==I.key?g.set(I.key,I):g.set(I.index,I),I=I.sibling;return g}function l(g,I){return(g=Na(g,I)).index=0,g.sibling=null,g}function t(I,C,e){return I.index=e,g?null!==(e=I.alternate)?(e=e.index)<C?(I.flags|=2,C):e:(I.flags|=2,C):(I.flags|=1048576,C)}function n(I){return g&&null===I.alternate&&(I.flags|=2),I}function o(g,I,C,e){return null===I||6!==I.tag?((I=Fa(C,g.mode,e)).return=g,I):((I=l(I,C)).return=g,I)}function a(g,I,C,e){var A=C.type;return A===y?d(g,I,C.props.children,e,C.key):null!==I&&(I.elementType===A||"object"===typeof A&&null!==A&&A.$$typeof===v&&TA(A)===I.type)?((e=l(I,C.props)).ref=MA(g,I,C),e.return=g,e):((e=fa(C.type,C.key,C.props,null,g.mode,e)).ref=MA(g,I,C),e.return=g,e)}function c(g,I,C,e){return null===I||4!==I.tag||I.stateNode.containerInfo!==C.containerInfo||I.stateNode.implementation!==C.implementation?((I=xa(C,g.mode,e)).return=g,I):((I=l(I,C.children||[])).return=g,I)}function d(g,I,C,e,A){return null===I||7!==I.tag?((I=Ka(C,g.mode,e,A)).return=g,I):((I=l(I,C)).return=g,I)}function i(g,I,C){if("string"===typeof I&&""!==I||"number"===typeof I)return(I=Fa(""+I,g.mode,C)).return=g,I;if("object"===typeof I&&null!==I){switch(I.$$typeof){case h:return(C=fa(I.type,I.key,I.props,null,g.mode,C)).ref=MA(g,null,I),C.return=g,C;case p:return(I=xa(I,g.mode,C)).return=g,I;case v:return i(g,(0,I._init)(I._payload),C)}if(Ig(I)||f(I))return(I=Ka(I,g.mode,C,null)).return=g,I;DA(g,I)}return null}function s(g,I,C,e){var l=null!==I?I.key:null;if("string"===typeof C&&""!==C||"number"===typeof C)return null!==l?null:o(g,I,""+C,e);if("object"===typeof C&&null!==C){switch(C.$$typeof){case h:return C.key===l?a(g,I,C,e):null;case p:return C.key===l?c(g,I,C,e):null;case v:return s(g,I,(l=C._init)(C._payload),e)}if(Ig(C)||f(C))return null!==l?null:d(g,I,C,e,null);DA(g,C)}return null}function r(g,I,C,e,l){if("string"===typeof e&&""!==e||"number"===typeof e)return o(I,g=g.get(C)||null,""+e,l);if("object"===typeof e&&null!==e){switch(e.$$typeof){case h:return a(I,g=g.get(null===e.key?C:e.key)||null,e,l);case p:return c(I,g=g.get(null===e.key?C:e.key)||null,e,l);case v:return r(g,I,C,(0,e._init)(e._payload),l)}if(Ig(e)||f(e))return d(I,g=g.get(C)||null,e,l,null);DA(I,e)}return null}function b(l,A,n,o){for(var a=null,c=null,d=A,b=A=0,m=null;null!==d&&b<n.length;b++){d.index>b?(m=d,d=null):m=d.sibling;var Z=s(l,d,n[b],o);if(null===Z){null===d&&(d=m);break}g&&d&&null===Z.alternate&&I(l,d),A=t(Z,A,b),null===c?a=Z:c.sibling=Z,c=Z,d=m}if(b===n.length)return C(l,d),eA&&ql(l,b),a;if(null===d){for(;b<n.length;b++)null!==(d=i(l,n[b],o))&&(A=t(d,A,b),null===c?a=d:c.sibling=d,c=d);return eA&&ql(l,b),a}for(d=e(l,d);b<n.length;b++)null!==(m=r(d,l,b,n[b],o))&&(g&&null!==m.alternate&&d.delete(null===m.key?b:m.key),A=t(m,A,b),null===c?a=m:c.sibling=m,c=m);return g&&d.forEach((function(g){return I(l,g)})),eA&&ql(l,b),a}function m(l,n,o,a){var c=f(o);if("function"!==typeof c)throw Error(A(150));if(null==(o=c.call(o)))throw Error(A(151));for(var d=c=null,b=n,m=n=0,Z=null,u=o.next();null!==b&&!u.done;m++,u=o.next()){b.index>m?(Z=b,b=null):Z=b.sibling;var G=s(l,b,u.value,a);if(null===G){null===b&&(b=Z);break}g&&b&&null===G.alternate&&I(l,b),n=t(G,n,m),null===d?c=G:d.sibling=G,d=G,b=Z}if(u.done)return C(l,b),eA&&ql(l,m),c;if(null===b){for(;!u.done;m++,u=o.next())null!==(u=i(l,u.value,a))&&(n=t(u,n,m),null===d?c=u:d.sibling=u,d=u);return eA&&ql(l,m),c}for(b=e(l,b);!u.done;m++,u=o.next())null!==(u=r(b,l,m,u.value,a))&&(g&&null!==u.alternate&&b.delete(null===u.key?m:u.key),n=t(u,n,m),null===d?c=u:d.sibling=u,d=u);return g&&b.forEach((function(g){return I(l,g)})),eA&&ql(l,m),c}return function g(e,A,t,o){if("object"===typeof t&&null!==t&&t.type===y&&null===t.key&&(t=t.props.children),"object"===typeof t&&null!==t){switch(t.$$typeof){case h:g:{for(var a=t.key,c=A;null!==c;){if(c.key===a){if((a=t.type)===y){if(7===c.tag){C(e,c.sibling),(A=l(c,t.props.children)).return=e,e=A;break g}}else if(c.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===v&&TA(a)===c.type){C(e,c.sibling),(A=l(c,t.props)).ref=MA(e,c,t),A.return=e,e=A;break g}C(e,c);break}I(e,c),c=c.sibling}t.type===y?((A=Ka(t.props.children,e.mode,o,t.key)).return=e,e=A):((o=fa(t.type,t.key,t.props,null,e.mode,o)).ref=MA(e,A,t),o.return=e,e=o)}return n(e);case p:g:{for(c=t.key;null!==A;){if(A.key===c){if(4===A.tag&&A.stateNode.containerInfo===t.containerInfo&&A.stateNode.implementation===t.implementation){C(e,A.sibling),(A=l(A,t.children||[])).return=e,e=A;break g}C(e,A);break}I(e,A),A=A.sibling}(A=xa(t,e.mode,o)).return=e,e=A}return n(e);case v:return g(e,A,(c=t._init)(t._payload),o)}if(Ig(t))return b(e,A,t,o);if(f(t))return m(e,A,t,o);DA(e,t)}return"string"===typeof t&&""!==t||"number"===typeof t?(t=""+t,null!==A&&6===A.tag?(C(e,A.sibling),(A=l(A,t)).return=e,e=A):(C(e,A),(A=Fa(t,e.mode,o)).return=e,e=A),n(e)):C(e,A)}}var PA=jA(!0),OA=jA(!1),qA={},_A=yl(qA),$A=yl(qA),gt=yl(qA);function It(g){if(g===qA)throw Error(A(174));return g}function Ct(g,I){switch(Vl(gt,I),Vl($A,g),Vl(_A,qA),g=I.nodeType){case 9:case 11:I=(I=I.documentElement)?I.namespaceURI:og(null,"");break;default:I=og(I=(g=8===g?I.parentNode:I).namespaceURI||null,g=g.tagName)}Wl(_A),Vl(_A,I)}function et(){Wl(_A),Wl($A),Wl(gt)}function lt(g){It(gt.current);var I=It(_A.current),C=og(I,g.type);I!==C&&(Vl($A,g),Vl(_A,C))}function At(g){$A.current===g&&(Wl(_A),Wl($A))}var tt=yl(0);function nt(g){for(var I=g;null!==I;){if(13===I.tag){var C=I.memoizedState;if(null!==C&&(null===(C=C.dehydrated)||"$?"===C.data||"$!"===C.data))return I}else if(19===I.tag&&void 0!==I.memoizedProps.revealOrder){if(0!==(128&I.flags))return I}else if(null!==I.child){I.child.return=I,I=I.child;continue}if(I===g)break;for(;null===I.sibling;){if(null===I.return||I.return===g)return null;I=I.return}I.sibling.return=I.return,I=I.sibling}return null}var ot=[];function at(){for(var g=0;g<ot.length;g++)ot[g]._workInProgressVersionPrimary=null;ot.length=0}var ct=B.ReactCurrentDispatcher,dt=B.ReactCurrentBatchConfig,it=0,st=null,rt=null,bt=null,mt=!1,Zt=!1,ut=0,Gt=0;function Bt(){throw Error(A(321))}function ht(g,I){if(null===I)return!1;for(var C=0;C<I.length&&C<g.length;C++)if(!te(g[C],I[C]))return!1;return!0}function pt(g,I,C,e,l,t){if(it=t,st=I,I.memoizedState=null,I.updateQueue=null,I.lanes=0,ct.current=null===g||null===g.memoizedState?An:tn,g=C(e,l),Zt){t=0;do{if(Zt=!1,ut=0,25<=t)throw Error(A(301));t+=1,bt=rt=null,I.updateQueue=null,ct.current=nn,g=C(e,l)}while(Zt)}if(ct.current=ln,I=null!==rt&&null!==rt.next,it=0,bt=rt=st=null,mt=!1,I)throw Error(A(300));return g}function yt(){var g=0!==ut;return ut=0,g}function Wt(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===bt?st.memoizedState=bt=g:bt=bt.next=g,bt}function Vt(){if(null===rt){var g=st.alternate;g=null!==g?g.memoizedState:null}else g=rt.next;var I=null===bt?st.memoizedState:bt.next;if(null!==I)bt=I,rt=g;else{if(null===g)throw Error(A(310));g={memoizedState:(rt=g).memoizedState,baseState:rt.baseState,baseQueue:rt.baseQueue,queue:rt.queue,next:null},null===bt?st.memoizedState=bt=g:bt=bt.next=g}return bt}function St(g,I){return"function"===typeof I?I(g):I}function Xt(g){var I=Vt(),C=I.queue;if(null===C)throw Error(A(311));C.lastRenderedReducer=g;var e=rt,l=e.baseQueue,t=C.pending;if(null!==t){if(null!==l){var n=l.next;l.next=t.next,t.next=n}e.baseQueue=l=t,C.pending=null}if(null!==l){t=l.next,e=e.baseState;var o=n=null,a=null,c=t;do{var d=c.lane;if((it&d)===d)null!==a&&(a=a.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),e=c.hasEagerState?c.eagerState:g(e,c.action);else{var i={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===a?(o=a=i,n=e):a=a.next=i,st.lanes|=d,wo|=d}c=c.next}while(null!==c&&c!==t);null===a?n=e:a.next=o,te(e,I.memoizedState)||(Gn=!0),I.memoizedState=e,I.baseState=n,I.baseQueue=a,C.lastRenderedState=e}if(null!==(g=C.interleaved)){l=g;do{t=l.lane,st.lanes|=t,wo|=t,l=l.next}while(l!==g)}else null===l&&(C.lanes=0);return[I.memoizedState,C.dispatch]}function Rt(g){var I=Vt(),C=I.queue;if(null===C)throw Error(A(311));C.lastRenderedReducer=g;var e=C.dispatch,l=C.pending,t=I.memoizedState;if(null!==l){C.pending=null;var n=l=l.next;do{t=g(t,n.action),n=n.next}while(n!==l);te(t,I.memoizedState)||(Gn=!0),I.memoizedState=t,null===I.baseQueue&&(I.baseState=t),C.lastRenderedState=t}return[t,e]}function kt(){}function Jt(g,I){var C=st,e=Vt(),l=I(),t=!te(e.memoizedState,l);if(t&&(e.memoizedState=l,Gn=!0),e=e.queue,Qt(Ht.bind(null,C,e,g),[g]),e.getSnapshot!==I||t||null!==bt&&1&bt.memoizedState.tag){if(C.flags|=2048,wt(9,vt.bind(null,C,e,l,I),void 0,null),null===Jo)throw Error(A(349));0!==(30&it)||Yt(C,I,l)}return l}function Yt(g,I,C){g.flags|=16384,g={getSnapshot:I,value:C},null===(I=st.updateQueue)?(I={lastEffect:null,stores:null},st.updateQueue=I,I.stores=[g]):null===(C=I.stores)?I.stores=[g]:C.push(g)}function vt(g,I,C,e){I.value=C,I.getSnapshot=e,Nt(I)&&ft(g)}function Ht(g,I,C){return C((function(){Nt(I)&&ft(g)}))}function Nt(g){var I=g.getSnapshot;g=g.value;try{var C=I();return!te(g,C)}catch(e){return!0}}function ft(g){var I=RA(g,1);null!==I&&ea(I,g,1,-1)}function Kt(g){var I=Wt();return"function"===typeof g&&(g=g()),I.memoizedState=I.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:St,lastRenderedState:g},I.queue=g,g=g.dispatch=gn.bind(null,st,g),[I.memoizedState,g]}function wt(g,I,C,e){return g={tag:g,create:I,destroy:C,deps:e,next:null},null===(I=st.updateQueue)?(I={lastEffect:null,stores:null},st.updateQueue=I,I.lastEffect=g.next=g):null===(C=I.lastEffect)?I.lastEffect=g.next=g:(e=C.next,C.next=g,g.next=e,I.lastEffect=g),g}function Ft(){return Vt().memoizedState}function xt(g,I,C,e){var l=Wt();st.flags|=g,l.memoizedState=wt(1|I,C,void 0,void 0===e?null:e)}function zt(g,I,C,e){var l=Vt();e=void 0===e?null:e;var A=void 0;if(null!==rt){var t=rt.memoizedState;if(A=t.destroy,null!==e&&ht(e,t.deps))return void(l.memoizedState=wt(I,C,A,e))}st.flags|=g,l.memoizedState=wt(1|I,C,A,e)}function Ut(g,I){return xt(8390656,8,g,I)}function Qt(g,I){return zt(2048,8,g,I)}function Et(g,I){return zt(4,2,g,I)}function Lt(g,I){return zt(4,4,g,I)}function Mt(g,I){return"function"===typeof I?(g=g(),I(g),function(){I(null)}):null!==I&&void 0!==I?(g=g(),I.current=g,function(){I.current=null}):void 0}function Dt(g,I,C){return C=null!==C&&void 0!==C?C.concat([g]):null,zt(4,4,Mt.bind(null,I,g),C)}function Tt(){}function jt(g,I){var C=Vt();I=void 0===I?null:I;var e=C.memoizedState;return null!==e&&null!==I&&ht(I,e[1])?e[0]:(C.memoizedState=[g,I],g)}function Pt(g,I){var C=Vt();I=void 0===I?null:I;var e=C.memoizedState;return null!==e&&null!==I&&ht(I,e[1])?e[0]:(g=g(),C.memoizedState=[g,I],g)}function Ot(g,I,C){return 0===(21&it)?(g.baseState&&(g.baseState=!1,Gn=!0),g.memoizedState=C):(te(C,I)||(C=bI(),st.lanes|=C,wo|=C,g.baseState=!0),I)}function qt(g,I){var C=GI;GI=0!==C&&4>C?C:4,g(!0);var e=dt.transition;dt.transition={};try{g(!1),I()}finally{GI=C,dt.transition=e}}function _t(){return Vt().memoizedState}function $t(g,I,C){var e=Ca(g);if(C={lane:e,action:C,hasEagerState:!1,eagerState:null,next:null},In(g))Cn(I,C);else if(null!==(C=XA(g,I,C,e))){ea(C,g,e,Ia()),en(C,I,e)}}function gn(g,I,C){var e=Ca(g),l={lane:e,action:C,hasEagerState:!1,eagerState:null,next:null};if(In(g))Cn(I,l);else{var A=g.alternate;if(0===g.lanes&&(null===A||0===A.lanes)&&null!==(A=I.lastRenderedReducer))try{var t=I.lastRenderedState,n=A(t,C);if(l.hasEagerState=!0,l.eagerState=n,te(n,t)){var o=I.interleaved;return null===o?(l.next=l,SA(I)):(l.next=o.next,o.next=l),void(I.interleaved=l)}}catch(a){}null!==(C=XA(g,I,l,e))&&(ea(C,g,e,l=Ia()),en(C,I,e))}}function In(g){var I=g.alternate;return g===st||null!==I&&I===st}function Cn(g,I){Zt=mt=!0;var C=g.pending;null===C?I.next=I:(I.next=C.next,C.next=I),g.pending=I}function en(g,I,C){if(0!==(4194240&C)){var e=I.lanes;C|=e&=g.pendingLanes,I.lanes=C,uI(g,C)}}var ln={readContext:WA,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useInsertionEffect:Bt,useLayoutEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useMutableSource:Bt,useSyncExternalStore:Bt,useId:Bt,unstable_isNewReconciler:!1},An={readContext:WA,useCallback:function(g,I){return Wt().memoizedState=[g,void 0===I?null:I],g},useContext:WA,useEffect:Ut,useImperativeHandle:function(g,I,C){return C=null!==C&&void 0!==C?C.concat([g]):null,xt(4194308,4,Mt.bind(null,I,g),C)},useLayoutEffect:function(g,I){return xt(4194308,4,g,I)},useInsertionEffect:function(g,I){return xt(4,2,g,I)},useMemo:function(g,I){var C=Wt();return I=void 0===I?null:I,g=g(),C.memoizedState=[g,I],g},useReducer:function(g,I,C){var e=Wt();return I=void 0!==C?C(I):I,e.memoizedState=e.baseState=I,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:I},e.queue=g,g=g.dispatch=$t.bind(null,st,g),[e.memoizedState,g]},useRef:function(g){return g={current:g},Wt().memoizedState=g},useState:Kt,useDebugValue:Tt,useDeferredValue:function(g){return Wt().memoizedState=g},useTransition:function(){var g=Kt(!1),I=g[0];return g=qt.bind(null,g[1]),Wt().memoizedState=g,[I,g]},useMutableSource:function(){},useSyncExternalStore:function(g,I,C){var e=st,l=Wt();if(eA){if(void 0===C)throw Error(A(407));C=C()}else{if(C=I(),null===Jo)throw Error(A(349));0!==(30&it)||Yt(e,I,C)}l.memoizedState=C;var t={value:C,getSnapshot:I};return l.queue=t,Ut(Ht.bind(null,e,t,g),[g]),e.flags|=2048,wt(9,vt.bind(null,e,t,C,I),void 0,null),C},useId:function(){var g=Wt(),I=Jo.identifierPrefix;if(eA){var C=Ol;I=":"+I+"R"+(C=(Pl&~(1<<32-tI(Pl)-1)).toString(32)+C),0<(C=ut++)&&(I+="H"+C.toString(32)),I+=":"}else I=":"+I+"r"+(C=Gt++).toString(32)+":";return g.memoizedState=I},unstable_isNewReconciler:!1},tn={readContext:WA,useCallback:jt,useContext:WA,useEffect:Qt,useImperativeHandle:Dt,useInsertionEffect:Et,useLayoutEffect:Lt,useMemo:Pt,useReducer:Xt,useRef:Ft,useState:function(){return Xt(St)},useDebugValue:Tt,useDeferredValue:function(g){return Ot(Vt(),rt.memoizedState,g)},useTransition:function(){return[Xt(St)[0],Vt().memoizedState]},useMutableSource:kt,useSyncExternalStore:Jt,useId:_t,unstable_isNewReconciler:!1},nn={readContext:WA,useCallback:jt,useContext:WA,useEffect:Qt,useImperativeHandle:Dt,useInsertionEffect:Et,useLayoutEffect:Lt,useMemo:Pt,useReducer:Rt,useRef:Ft,useState:function(){return Rt(St)},useDebugValue:Tt,useDeferredValue:function(g){var I=Vt();return null===rt?I.memoizedState=g:Ot(I,rt.memoizedState,g)},useTransition:function(){return[Rt(St)[0],Vt().memoizedState]},useMutableSource:kt,useSyncExternalStore:Jt,useId:_t,unstable_isNewReconciler:!1};function on(g,I){try{var C="",e=I;do{C+=U(e),e=e.return}while(e);var l=C}catch(A){l="\nError generating stack: "+A.message+"\n"+A.stack}return{value:g,source:I,stack:l,digest:null}}function an(g,I,C){return{value:g,source:null,stack:null!=C?C:null,digest:null!=I?I:null}}function cn(g,I){try{console.error(I.value)}catch(C){setTimeout((function(){throw C}))}}var dn="function"===typeof WeakMap?WeakMap:Map;function sn(g,I,C){(C=vA(-1,C)).tag=3,C.payload={element:null};var e=I.value;return C.callback=function(){Mo||(Mo=!0,Do=e),cn(0,I)},C}function rn(g,I,C){(C=vA(-1,C)).tag=3;var e=g.type.getDerivedStateFromError;if("function"===typeof e){var l=I.value;C.payload=function(){return e(l)},C.callback=function(){cn(0,I)}}var A=g.stateNode;return null!==A&&"function"===typeof A.componentDidCatch&&(C.callback=function(){cn(0,I),"function"!==typeof e&&(null===To?To=new Set([this]):To.add(this));var g=I.stack;this.componentDidCatch(I.value,{componentStack:null!==g?g:""})}),C}function bn(g,I,C){var e=g.pingCache;if(null===e){e=g.pingCache=new dn;var l=new Set;e.set(I,l)}else void 0===(l=e.get(I))&&(l=new Set,e.set(I,l));l.has(C)||(l.add(C),g=Sa.bind(null,g,I,C),I.then(g,g))}function mn(g){do{var I;if((I=13===g.tag)&&(I=null===(I=g.memoizedState)||null!==I.dehydrated),I)return g;g=g.return}while(null!==g);return null}function Zn(g,I,C,e,l){return 0===(1&g.mode)?(g===I?g.flags|=65536:(g.flags|=128,C.flags|=131072,C.flags&=-52805,1===C.tag&&(null===C.alternate?C.tag=17:((I=vA(-1,1)).tag=2,HA(C,I,1))),C.lanes|=1),g):(g.flags|=65536,g.lanes=l,g)}var un=B.ReactCurrentOwner,Gn=!1;function Bn(g,I,C,e){I.child=null===g?OA(I,null,C,e):PA(I,g.child,C,e)}function hn(g,I,C,e,l){C=C.render;var A=I.ref;return yA(I,l),e=pt(g,I,C,e,A,l),C=yt(),null===g||Gn?(eA&&C&&$l(I),I.flags|=1,Bn(g,I,e,l),I.child):(I.updateQueue=g.updateQueue,I.flags&=-2053,g.lanes&=~l,Ln(g,I,l))}function pn(g,I,C,e,l){if(null===g){var A=C.type;return"function"!==typeof A||Ha(A)||void 0!==A.defaultProps||null!==C.compare||void 0!==C.defaultProps?((g=fa(C.type,null,e,I,I.mode,l)).ref=I.ref,g.return=I,I.child=g):(I.tag=15,I.type=A,yn(g,I,A,e,l))}if(A=g.child,0===(g.lanes&l)){var t=A.memoizedProps;if((C=null!==(C=C.compare)?C:ne)(t,e)&&g.ref===I.ref)return Ln(g,I,l)}return I.flags|=1,(g=Na(A,e)).ref=I.ref,g.return=I,I.child=g}function yn(g,I,C,e,l){if(null!==g){var A=g.memoizedProps;if(ne(A,e)&&g.ref===I.ref){if(Gn=!1,I.pendingProps=e=A,0===(g.lanes&l))return I.lanes=g.lanes,Ln(g,I,l);0!==(131072&g.flags)&&(Gn=!0)}}return Sn(g,I,C,e,l)}function Wn(g,I,C){var e=I.pendingProps,l=e.children,A=null!==g?g.memoizedState:null;if("hidden"===e.mode)if(0===(1&I.mode))I.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vl(No,Ho),Ho|=C;else{if(0===(1073741824&C))return g=null!==A?A.baseLanes|C:C,I.lanes=I.childLanes=1073741824,I.memoizedState={baseLanes:g,cachePool:null,transitions:null},I.updateQueue=null,Vl(No,Ho),Ho|=g,null;I.memoizedState={baseLanes:0,cachePool:null,transitions:null},e=null!==A?A.baseLanes:C,Vl(No,Ho),Ho|=e}else null!==A?(e=A.baseLanes|C,I.memoizedState=null):e=C,Vl(No,Ho),Ho|=e;return Bn(g,I,l,C),I.child}function Vn(g,I){var C=I.ref;(null===g&&null!==C||null!==g&&g.ref!==C)&&(I.flags|=512,I.flags|=2097152)}function Sn(g,I,C,e,l){var A=Yl(C)?kl:Xl.current;return A=Jl(I,A),yA(I,l),C=pt(g,I,C,e,A,l),e=yt(),null===g||Gn?(eA&&e&&$l(I),I.flags|=1,Bn(g,I,C,l),I.child):(I.updateQueue=g.updateQueue,I.flags&=-2053,g.lanes&=~l,Ln(g,I,l))}function Xn(g,I,C,e,l){if(Yl(C)){var A=!0;fl(I)}else A=!1;if(yA(I,l),null===I.stateNode)En(g,I),QA(I,C,e),LA(I,C,e,l),e=!0;else if(null===g){var t=I.stateNode,n=I.memoizedProps;t.props=n;var o=t.context,a=C.contextType;"object"===typeof a&&null!==a?a=WA(a):a=Jl(I,a=Yl(C)?kl:Xl.current);var c=C.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof t.getSnapshotBeforeUpdate;d||"function"!==typeof t.UNSAFE_componentWillReceiveProps&&"function"!==typeof t.componentWillReceiveProps||(n!==e||o!==a)&&EA(I,t,e,a),kA=!1;var i=I.memoizedState;t.state=i,KA(I,e,t,l),o=I.memoizedState,n!==e||i!==o||Rl.current||kA?("function"===typeof c&&(xA(I,C,c,e),o=I.memoizedState),(n=kA||UA(I,C,n,e,i,o,a))?(d||"function"!==typeof t.UNSAFE_componentWillMount&&"function"!==typeof t.componentWillMount||("function"===typeof t.componentWillMount&&t.componentWillMount(),"function"===typeof t.UNSAFE_componentWillMount&&t.UNSAFE_componentWillMount()),"function"===typeof t.componentDidMount&&(I.flags|=4194308)):("function"===typeof t.componentDidMount&&(I.flags|=4194308),I.memoizedProps=e,I.memoizedState=o),t.props=e,t.state=o,t.context=a,e=n):("function"===typeof t.componentDidMount&&(I.flags|=4194308),e=!1)}else{t=I.stateNode,YA(g,I),n=I.memoizedProps,a=I.type===I.elementType?n:bA(I.type,n),t.props=a,d=I.pendingProps,i=t.context,"object"===typeof(o=C.contextType)&&null!==o?o=WA(o):o=Jl(I,o=Yl(C)?kl:Xl.current);var s=C.getDerivedStateFromProps;(c="function"===typeof s||"function"===typeof t.getSnapshotBeforeUpdate)||"function"!==typeof t.UNSAFE_componentWillReceiveProps&&"function"!==typeof t.componentWillReceiveProps||(n!==d||i!==o)&&EA(I,t,e,o),kA=!1,i=I.memoizedState,t.state=i,KA(I,e,t,l);var r=I.memoizedState;n!==d||i!==r||Rl.current||kA?("function"===typeof s&&(xA(I,C,s,e),r=I.memoizedState),(a=kA||UA(I,C,a,e,i,r,o)||!1)?(c||"function"!==typeof t.UNSAFE_componentWillUpdate&&"function"!==typeof t.componentWillUpdate||("function"===typeof t.componentWillUpdate&&t.componentWillUpdate(e,r,o),"function"===typeof t.UNSAFE_componentWillUpdate&&t.UNSAFE_componentWillUpdate(e,r,o)),"function"===typeof t.componentDidUpdate&&(I.flags|=4),"function"===typeof t.getSnapshotBeforeUpdate&&(I.flags|=1024)):("function"!==typeof t.componentDidUpdate||n===g.memoizedProps&&i===g.memoizedState||(I.flags|=4),"function"!==typeof t.getSnapshotBeforeUpdate||n===g.memoizedProps&&i===g.memoizedState||(I.flags|=1024),I.memoizedProps=e,I.memoizedState=r),t.props=e,t.state=r,t.context=o,e=a):("function"!==typeof t.componentDidUpdate||n===g.memoizedProps&&i===g.memoizedState||(I.flags|=4),"function"!==typeof t.getSnapshotBeforeUpdate||n===g.memoizedProps&&i===g.memoizedState||(I.flags|=1024),e=!1)}return Rn(g,I,C,e,A,l)}function Rn(g,I,C,e,l,A){Vn(g,I);var t=0!==(128&I.flags);if(!e&&!t)return l&&Kl(I,C,!1),Ln(g,I,A);e=I.stateNode,un.current=I;var n=t&&"function"!==typeof C.getDerivedStateFromError?null:e.render();return I.flags|=1,null!==g&&t?(I.child=PA(I,g.child,null,A),I.child=PA(I,null,n,A)):Bn(g,I,n,A),I.memoizedState=e.state,l&&Kl(I,C,!0),I.child}function kn(g){var I=g.stateNode;I.pendingContext?Hl(0,I.pendingContext,I.pendingContext!==I.context):I.context&&Hl(0,I.context,!1),Ct(g,I.containerInfo)}function Jn(g,I,C,e,l){return iA(),sA(l),I.flags|=256,Bn(g,I,C,e),I.child}var Yn,vn,Hn,Nn,fn={dehydrated:null,treeContext:null,retryLane:0};function Kn(g){return{baseLanes:g,cachePool:null,transitions:null}}function wn(g,I,C){var e,l=I.pendingProps,t=tt.current,n=!1,o=0!==(128&I.flags);if((e=o)||(e=(null===g||null!==g.memoizedState)&&0!==(2&t)),e?(n=!0,I.flags&=-129):null!==g&&null===g.memoizedState||(t|=1),Vl(tt,1&t),null===g)return oA(I),null!==(g=I.memoizedState)&&null!==(g=g.dehydrated)?(0===(1&I.mode)?I.lanes=1:"$!"===g.data?I.lanes=8:I.lanes=1073741824,null):(o=l.children,g=l.fallback,n?(l=I.mode,n=I.child,o={mode:"hidden",children:o},0===(1&l)&&null!==n?(n.childLanes=0,n.pendingProps=o):n=wa(o,l,0,null),g=Ka(g,l,C,null),n.return=I,g.return=I,n.sibling=g,I.child=n,I.child.memoizedState=Kn(C),I.memoizedState=fn,g):Fn(I,o));if(null!==(t=g.memoizedState)&&null!==(e=t.dehydrated))return function(g,I,C,e,l,t,n){if(C)return 256&I.flags?(I.flags&=-257,xn(g,I,n,e=an(Error(A(422))))):null!==I.memoizedState?(I.child=g.child,I.flags|=128,null):(t=e.fallback,l=I.mode,e=wa({mode:"visible",children:e.children},l,0,null),(t=Ka(t,l,n,null)).flags|=2,e.return=I,t.return=I,e.sibling=t,I.child=e,0!==(1&I.mode)&&PA(I,g.child,null,n),I.child.memoizedState=Kn(n),I.memoizedState=fn,t);if(0===(1&I.mode))return xn(g,I,n,null);if("$!"===l.data){if(e=l.nextSibling&&l.nextSibling.dataset)var o=e.dgst;return e=o,xn(g,I,n,e=an(t=Error(A(419)),e,void 0))}if(o=0!==(n&g.childLanes),Gn||o){if(null!==(e=Jo)){switch(n&-n){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}0!==(l=0!==(l&(e.suspendedLanes|n))?0:l)&&l!==t.retryLane&&(t.retryLane=l,RA(g,l),ea(e,g,l,-1))}return ma(),xn(g,I,n,e=an(Error(A(421))))}return"$?"===l.data?(I.flags|=128,I.child=g.child,I=Ra.bind(null,g),l._reactRetry=I,null):(g=t.treeContext,CA=ol(l.nextSibling),IA=I,eA=!0,lA=null,null!==g&&(Dl[Tl++]=Pl,Dl[Tl++]=Ol,Dl[Tl++]=jl,Pl=g.id,Ol=g.overflow,jl=I),I=Fn(I,e.children),I.flags|=4096,I)}(g,I,o,l,e,t,C);if(n){n=l.fallback,o=I.mode,e=(t=g.child).sibling;var a={mode:"hidden",children:l.children};return 0===(1&o)&&I.child!==t?((l=I.child).childLanes=0,l.pendingProps=a,I.deletions=null):(l=Na(t,a)).subtreeFlags=14680064&t.subtreeFlags,null!==e?n=Na(e,n):(n=Ka(n,o,C,null)).flags|=2,n.return=I,l.return=I,l.sibling=n,I.child=l,l=n,n=I.child,o=null===(o=g.child.memoizedState)?Kn(C):{baseLanes:o.baseLanes|C,cachePool:null,transitions:o.transitions},n.memoizedState=o,n.childLanes=g.childLanes&~C,I.memoizedState=fn,l}return g=(n=g.child).sibling,l=Na(n,{mode:"visible",children:l.children}),0===(1&I.mode)&&(l.lanes=C),l.return=I,l.sibling=null,null!==g&&(null===(C=I.deletions)?(I.deletions=[g],I.flags|=16):C.push(g)),I.child=l,I.memoizedState=null,l}function Fn(g,I){return(I=wa({mode:"visible",children:I},g.mode,0,null)).return=g,g.child=I}function xn(g,I,C,e){return null!==e&&sA(e),PA(I,g.child,null,C),(g=Fn(I,I.pendingProps.children)).flags|=2,I.memoizedState=null,g}function zn(g,I,C){g.lanes|=I;var e=g.alternate;null!==e&&(e.lanes|=I),pA(g.return,I,C)}function Un(g,I,C,e,l){var A=g.memoizedState;null===A?g.memoizedState={isBackwards:I,rendering:null,renderingStartTime:0,last:e,tail:C,tailMode:l}:(A.isBackwards=I,A.rendering=null,A.renderingStartTime=0,A.last=e,A.tail=C,A.tailMode=l)}function Qn(g,I,C){var e=I.pendingProps,l=e.revealOrder,A=e.tail;if(Bn(g,I,e.children,C),0!==(2&(e=tt.current)))e=1&e|2,I.flags|=128;else{if(null!==g&&0!==(128&g.flags))g:for(g=I.child;null!==g;){if(13===g.tag)null!==g.memoizedState&&zn(g,C,I);else if(19===g.tag)zn(g,C,I);else if(null!==g.child){g.child.return=g,g=g.child;continue}if(g===I)break g;for(;null===g.sibling;){if(null===g.return||g.return===I)break g;g=g.return}g.sibling.return=g.return,g=g.sibling}e&=1}if(Vl(tt,e),0===(1&I.mode))I.memoizedState=null;else switch(l){case"forwards":for(C=I.child,l=null;null!==C;)null!==(g=C.alternate)&&null===nt(g)&&(l=C),C=C.sibling;null===(C=l)?(l=I.child,I.child=null):(l=C.sibling,C.sibling=null),Un(I,!1,l,C,A);break;case"backwards":for(C=null,l=I.child,I.child=null;null!==l;){if(null!==(g=l.alternate)&&null===nt(g)){I.child=l;break}g=l.sibling,l.sibling=C,C=l,l=g}Un(I,!0,C,null,A);break;case"together":Un(I,!1,null,null,void 0);break;default:I.memoizedState=null}return I.child}function En(g,I){0===(1&I.mode)&&null!==g&&(g.alternate=null,I.alternate=null,I.flags|=2)}function Ln(g,I,C){if(null!==g&&(I.dependencies=g.dependencies),wo|=I.lanes,0===(C&I.childLanes))return null;if(null!==g&&I.child!==g.child)throw Error(A(153));if(null!==I.child){for(C=Na(g=I.child,g.pendingProps),I.child=C,C.return=I;null!==g.sibling;)g=g.sibling,(C=C.sibling=Na(g,g.pendingProps)).return=I;C.sibling=null}return I.child}function Mn(g,I){if(!eA)switch(g.tailMode){case"hidden":I=g.tail;for(var C=null;null!==I;)null!==I.alternate&&(C=I),I=I.sibling;null===C?g.tail=null:C.sibling=null;break;case"collapsed":C=g.tail;for(var e=null;null!==C;)null!==C.alternate&&(e=C),C=C.sibling;null===e?I||null===g.tail?g.tail=null:g.tail.sibling=null:e.sibling=null}}function Dn(g){var I=null!==g.alternate&&g.alternate.child===g.child,C=0,e=0;if(I)for(var l=g.child;null!==l;)C|=l.lanes|l.childLanes,e|=14680064&l.subtreeFlags,e|=14680064&l.flags,l.return=g,l=l.sibling;else for(l=g.child;null!==l;)C|=l.lanes|l.childLanes,e|=l.subtreeFlags,e|=l.flags,l.return=g,l=l.sibling;return g.subtreeFlags|=e,g.childLanes=C,I}function Tn(g,I,C){var e=I.pendingProps;switch(gA(I),I.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dn(I),null;case 1:case 17:return Yl(I.type)&&vl(),Dn(I),null;case 3:return e=I.stateNode,et(),Wl(Rl),Wl(Xl),at(),e.pendingContext&&(e.context=e.pendingContext,e.pendingContext=null),null!==g&&null!==g.child||(cA(I)?I.flags|=4:null===g||g.memoizedState.isDehydrated&&0===(256&I.flags)||(I.flags|=1024,null!==lA&&(na(lA),lA=null))),vn(g,I),Dn(I),null;case 5:At(I);var l=It(gt.current);if(C=I.type,null!==g&&null!=I.stateNode)Hn(g,I,C,e,l),g.ref!==I.ref&&(I.flags|=512,I.flags|=2097152);else{if(!e){if(null===I.stateNode)throw Error(A(166));return Dn(I),null}if(g=It(_A.current),cA(I)){e=I.stateNode,C=I.type;var t=I.memoizedProps;switch(e[dl]=I,e[il]=t,g=0!==(1&I.mode),C){case"dialog":Fe("cancel",e),Fe("close",e);break;case"iframe":case"object":case"embed":Fe("load",e);break;case"video":case"audio":for(l=0;l<Ne.length;l++)Fe(Ne[l],e);break;case"source":Fe("error",e);break;case"img":case"image":case"link":Fe("error",e),Fe("load",e);break;case"details":Fe("toggle",e);break;case"input":O(e,t),Fe("invalid",e);break;case"select":e._wrapperState={wasMultiple:!!t.multiple},Fe("invalid",e);break;case"textarea":lg(e,t),Fe("invalid",e)}for(var o in ug(C,t),l=null,t)if(t.hasOwnProperty(o)){var a=t[o];"children"===o?"string"===typeof a?e.textContent!==a&&(!0!==t.suppressHydrationWarning&&qe(e.textContent,a,g),l=["children",a]):"number"===typeof a&&e.textContent!==""+a&&(!0!==t.suppressHydrationWarning&&qe(e.textContent,a,g),l=["children",""+a]):n.hasOwnProperty(o)&&null!=a&&"onScroll"===o&&Fe("scroll",e)}switch(C){case"input":D(e),$(e,t,!0);break;case"textarea":D(e),tg(e);break;case"select":case"option":break;default:"function"===typeof t.onClick&&(e.onclick=_e)}e=l,I.updateQueue=e,null!==e&&(I.flags|=4)}else{o=9===l.nodeType?l:l.ownerDocument,"http://www.w3.org/1999/xhtml"===g&&(g=ng(C)),"http://www.w3.org/1999/xhtml"===g?"script"===C?((g=o.createElement("div")).innerHTML="<script><\/script>",g=g.removeChild(g.firstChild)):"string"===typeof e.is?g=o.createElement(C,{is:e.is}):(g=o.createElement(C),"select"===C&&(o=g,e.multiple?o.multiple=!0:e.size&&(o.size=e.size))):g=o.createElementNS(g,C),g[dl]=I,g[il]=e,Yn(g,I,!1,!1),I.stateNode=g;g:{switch(o=Gg(C,e),C){case"dialog":Fe("cancel",g),Fe("close",g),l=e;break;case"iframe":case"object":case"embed":Fe("load",g),l=e;break;case"video":case"audio":for(l=0;l<Ne.length;l++)Fe(Ne[l],g);l=e;break;case"source":Fe("error",g),l=e;break;case"img":case"image":case"link":Fe("error",g),Fe("load",g),l=e;break;case"details":Fe("toggle",g),l=e;break;case"input":O(g,e),l=P(g,e),Fe("invalid",g);break;case"option":default:l=e;break;case"select":g._wrapperState={wasMultiple:!!e.multiple},l=w({},e,{value:void 0}),Fe("invalid",g);break;case"textarea":lg(g,e),l=eg(g,e),Fe("invalid",g)}for(t in ug(C,l),a=l)if(a.hasOwnProperty(t)){var c=a[t];"style"===t?mg(g,c):"dangerouslySetInnerHTML"===t?null!=(c=c?c.__html:void 0)&&dg(g,c):"children"===t?"string"===typeof c?("textarea"!==C||""!==c)&&ig(g,c):"number"===typeof c&&ig(g,""+c):"suppressContentEditableWarning"!==t&&"suppressHydrationWarning"!==t&&"autoFocus"!==t&&(n.hasOwnProperty(t)?null!=c&&"onScroll"===t&&Fe("scroll",g):null!=c&&G(g,t,c,o))}switch(C){case"input":D(g),$(g,e,!1);break;case"textarea":D(g),tg(g);break;case"option":null!=e.value&&g.setAttribute("value",""+L(e.value));break;case"select":g.multiple=!!e.multiple,null!=(t=e.value)?Cg(g,!!e.multiple,t,!1):null!=e.defaultValue&&Cg(g,!!e.multiple,e.defaultValue,!0);break;default:"function"===typeof l.onClick&&(g.onclick=_e)}switch(C){case"button":case"input":case"select":case"textarea":e=!!e.autoFocus;break g;case"img":e=!0;break g;default:e=!1}}e&&(I.flags|=4)}null!==I.ref&&(I.flags|=512,I.flags|=2097152)}return Dn(I),null;case 6:if(g&&null!=I.stateNode)Nn(g,I,g.memoizedProps,e);else{if("string"!==typeof e&&null===I.stateNode)throw Error(A(166));if(C=It(gt.current),It(_A.current),cA(I)){if(e=I.stateNode,C=I.memoizedProps,e[dl]=I,(t=e.nodeValue!==C)&&null!==(g=IA))switch(g.tag){case 3:qe(e.nodeValue,C,0!==(1&g.mode));break;case 5:!0!==g.memoizedProps.suppressHydrationWarning&&qe(e.nodeValue,C,0!==(1&g.mode))}t&&(I.flags|=4)}else(e=(9===C.nodeType?C:C.ownerDocument).createTextNode(e))[dl]=I,I.stateNode=e}return Dn(I),null;case 13:if(Wl(tt),e=I.memoizedState,null===g||null!==g.memoizedState&&null!==g.memoizedState.dehydrated){if(eA&&null!==CA&&0!==(1&I.mode)&&0===(128&I.flags))dA(),iA(),I.flags|=98560,t=!1;else if(t=cA(I),null!==e&&null!==e.dehydrated){if(null===g){if(!t)throw Error(A(318));if(!(t=null!==(t=I.memoizedState)?t.dehydrated:null))throw Error(A(317));t[dl]=I}else iA(),0===(128&I.flags)&&(I.memoizedState=null),I.flags|=4;Dn(I),t=!1}else null!==lA&&(na(lA),lA=null),t=!0;if(!t)return 65536&I.flags?I:null}return 0!==(128&I.flags)?(I.lanes=C,I):((e=null!==e)!==(null!==g&&null!==g.memoizedState)&&e&&(I.child.flags|=8192,0!==(1&I.mode)&&(null===g||0!==(1&tt.current)?0===fo&&(fo=3):ma())),null!==I.updateQueue&&(I.flags|=4),Dn(I),null);case 4:return et(),vn(g,I),null===g&&Ue(I.stateNode.containerInfo),Dn(I),null;case 10:return hA(I.type._context),Dn(I),null;case 19:if(Wl(tt),null===(t=I.memoizedState))return Dn(I),null;if(e=0!==(128&I.flags),null===(o=t.rendering))if(e)Mn(t,!1);else{if(0!==fo||null!==g&&0!==(128&g.flags))for(g=I.child;null!==g;){if(null!==(o=nt(g))){for(I.flags|=128,Mn(t,!1),null!==(e=o.updateQueue)&&(I.updateQueue=e,I.flags|=4),I.subtreeFlags=0,e=C,C=I.child;null!==C;)g=e,(t=C).flags&=14680066,null===(o=t.alternate)?(t.childLanes=0,t.lanes=g,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=o.childLanes,t.lanes=o.lanes,t.child=o.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=o.memoizedProps,t.memoizedState=o.memoizedState,t.updateQueue=o.updateQueue,t.type=o.type,g=o.dependencies,t.dependencies=null===g?null:{lanes:g.lanes,firstContext:g.firstContext}),C=C.sibling;return Vl(tt,1&tt.current|2),I.child}g=g.sibling}null!==t.tail&&qg()>Eo&&(I.flags|=128,e=!0,Mn(t,!1),I.lanes=4194304)}else{if(!e)if(null!==(g=nt(o))){if(I.flags|=128,e=!0,null!==(C=g.updateQueue)&&(I.updateQueue=C,I.flags|=4),Mn(t,!0),null===t.tail&&"hidden"===t.tailMode&&!o.alternate&&!eA)return Dn(I),null}else 2*qg()-t.renderingStartTime>Eo&&1073741824!==C&&(I.flags|=128,e=!0,Mn(t,!1),I.lanes=4194304);t.isBackwards?(o.sibling=I.child,I.child=o):(null!==(C=t.last)?C.sibling=o:I.child=o,t.last=o)}return null!==t.tail?(I=t.tail,t.rendering=I,t.tail=I.sibling,t.renderingStartTime=qg(),I.sibling=null,C=tt.current,Vl(tt,e?1&C|2:1&C),I):(Dn(I),null);case 22:case 23:return ia(),e=null!==I.memoizedState,null!==g&&null!==g.memoizedState!==e&&(I.flags|=8192),e&&0!==(1&I.mode)?0!==(1073741824&Ho)&&(Dn(I),6&I.subtreeFlags&&(I.flags|=8192)):Dn(I),null;case 24:case 25:return null}throw Error(A(156,I.tag))}function jn(g,I){switch(gA(I),I.tag){case 1:return Yl(I.type)&&vl(),65536&(g=I.flags)?(I.flags=-65537&g|128,I):null;case 3:return et(),Wl(Rl),Wl(Xl),at(),0!==(65536&(g=I.flags))&&0===(128&g)?(I.flags=-65537&g|128,I):null;case 5:return At(I),null;case 13:if(Wl(tt),null!==(g=I.memoizedState)&&null!==g.dehydrated){if(null===I.alternate)throw Error(A(340));iA()}return 65536&(g=I.flags)?(I.flags=-65537&g|128,I):null;case 19:return Wl(tt),null;case 4:return et(),null;case 10:return hA(I.type._context),null;case 22:case 23:return ia(),null;default:return null}}Yn=function(g,I){for(var C=I.child;null!==C;){if(5===C.tag||6===C.tag)g.appendChild(C.stateNode);else if(4!==C.tag&&null!==C.child){C.child.return=C,C=C.child;continue}if(C===I)break;for(;null===C.sibling;){if(null===C.return||C.return===I)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},vn=function(){},Hn=function(g,I,C,e){var l=g.memoizedProps;if(l!==e){g=I.stateNode,It(_A.current);var A,t=null;switch(C){case"input":l=P(g,l),e=P(g,e),t=[];break;case"select":l=w({},l,{value:void 0}),e=w({},e,{value:void 0}),t=[];break;case"textarea":l=eg(g,l),e=eg(g,e),t=[];break;default:"function"!==typeof l.onClick&&"function"===typeof e.onClick&&(g.onclick=_e)}for(c in ug(C,e),C=null,l)if(!e.hasOwnProperty(c)&&l.hasOwnProperty(c)&&null!=l[c])if("style"===c){var o=l[c];for(A in o)o.hasOwnProperty(A)&&(C||(C={}),C[A]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(n.hasOwnProperty(c)?t||(t=[]):(t=t||[]).push(c,null));for(c in e){var a=e[c];if(o=null!=l?l[c]:void 0,e.hasOwnProperty(c)&&a!==o&&(null!=a||null!=o))if("style"===c)if(o){for(A in o)!o.hasOwnProperty(A)||a&&a.hasOwnProperty(A)||(C||(C={}),C[A]="");for(A in a)a.hasOwnProperty(A)&&o[A]!==a[A]&&(C||(C={}),C[A]=a[A])}else C||(t||(t=[]),t.push(c,C)),C=a;else"dangerouslySetInnerHTML"===c?(a=a?a.__html:void 0,o=o?o.__html:void 0,null!=a&&o!==a&&(t=t||[]).push(c,a)):"children"===c?"string"!==typeof a&&"number"!==typeof a||(t=t||[]).push(c,""+a):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(n.hasOwnProperty(c)?(null!=a&&"onScroll"===c&&Fe("scroll",g),t||o===a||(t=[])):(t=t||[]).push(c,a))}C&&(t=t||[]).push("style",C);var c=t;(I.updateQueue=c)&&(I.flags|=4)}},Nn=function(g,I,C,e){C!==e&&(I.flags|=4)};var Pn=!1,On=!1,qn="function"===typeof WeakSet?WeakSet:Set,_n=null;function $n(g,I){var C=g.ref;if(null!==C)if("function"===typeof C)try{C(null)}catch(e){Va(g,I,e)}else C.current=null}function go(g,I,C){try{C()}catch(e){Va(g,I,e)}}var Io=!1;function Co(g,I,C){var e=I.updateQueue;if(null!==(e=null!==e?e.lastEffect:null)){var l=e=e.next;do{if((l.tag&g)===g){var A=l.destroy;l.destroy=void 0,void 0!==A&&go(I,C,A)}l=l.next}while(l!==e)}}function eo(g,I){if(null!==(I=null!==(I=I.updateQueue)?I.lastEffect:null)){var C=I=I.next;do{if((C.tag&g)===g){var e=C.create;C.destroy=e()}C=C.next}while(C!==I)}}function lo(g){var I=g.ref;if(null!==I){var C=g.stateNode;g.tag,g=C,"function"===typeof I?I(g):I.current=g}}function Ao(g){var I=g.alternate;null!==I&&(g.alternate=null,Ao(I)),g.child=null,g.deletions=null,g.sibling=null,5===g.tag&&(null!==(I=g.stateNode)&&(delete I[dl],delete I[il],delete I[rl],delete I[bl],delete I[ml])),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function to(g){return 5===g.tag||3===g.tag||4===g.tag}function no(g){g:for(;;){for(;null===g.sibling;){if(null===g.return||to(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;5!==g.tag&&6!==g.tag&&18!==g.tag;){if(2&g.flags)continue g;if(null===g.child||4===g.tag)continue g;g.child.return=g,g=g.child}if(!(2&g.flags))return g.stateNode}}function oo(g,I,C){var e=g.tag;if(5===e||6===e)g=g.stateNode,I?8===C.nodeType?C.parentNode.insertBefore(g,I):C.insertBefore(g,I):(8===C.nodeType?(I=C.parentNode).insertBefore(g,C):(I=C).appendChild(g),null!==(C=C._reactRootContainer)&&void 0!==C||null!==I.onclick||(I.onclick=_e));else if(4!==e&&null!==(g=g.child))for(oo(g,I,C),g=g.sibling;null!==g;)oo(g,I,C),g=g.sibling}function ao(g,I,C){var e=g.tag;if(5===e||6===e)g=g.stateNode,I?C.insertBefore(g,I):C.appendChild(g);else if(4!==e&&null!==(g=g.child))for(ao(g,I,C),g=g.sibling;null!==g;)ao(g,I,C),g=g.sibling}var co=null,io=!1;function so(g,I,C){for(C=C.child;null!==C;)ro(g,I,C),C=C.sibling}function ro(g,I,C){if(AI&&"function"===typeof AI.onCommitFiberUnmount)try{AI.onCommitFiberUnmount(lI,C)}catch(n){}switch(C.tag){case 5:On||$n(C,I);case 6:var e=co,l=io;co=null,so(g,I,C),io=l,null!==(co=e)&&(io?(g=co,C=C.stateNode,8===g.nodeType?g.parentNode.removeChild(C):g.removeChild(C)):co.removeChild(C.stateNode));break;case 18:null!==co&&(io?(g=co,C=C.stateNode,8===g.nodeType?nl(g.parentNode,C):1===g.nodeType&&nl(g,C),QI(g)):nl(co,C.stateNode));break;case 4:e=co,l=io,co=C.stateNode.containerInfo,io=!0,so(g,I,C),co=e,io=l;break;case 0:case 11:case 14:case 15:if(!On&&(null!==(e=C.updateQueue)&&null!==(e=e.lastEffect))){l=e=e.next;do{var A=l,t=A.destroy;A=A.tag,void 0!==t&&(0!==(2&A)||0!==(4&A))&&go(C,I,t),l=l.next}while(l!==e)}so(g,I,C);break;case 1:if(!On&&($n(C,I),"function"===typeof(e=C.stateNode).componentWillUnmount))try{e.props=C.memoizedProps,e.state=C.memoizedState,e.componentWillUnmount()}catch(n){Va(C,I,n)}so(g,I,C);break;case 21:so(g,I,C);break;case 22:1&C.mode?(On=(e=On)||null!==C.memoizedState,so(g,I,C),On=e):so(g,I,C);break;default:so(g,I,C)}}function bo(g){var I=g.updateQueue;if(null!==I){g.updateQueue=null;var C=g.stateNode;null===C&&(C=g.stateNode=new qn),I.forEach((function(I){var e=ka.bind(null,g,I);C.has(I)||(C.add(I),I.then(e,e))}))}}function mo(g,I){var C=I.deletions;if(null!==C)for(var e=0;e<C.length;e++){var l=C[e];try{var t=g,n=I,o=n;g:for(;null!==o;){switch(o.tag){case 5:co=o.stateNode,io=!1;break g;case 3:case 4:co=o.stateNode.containerInfo,io=!0;break g}o=o.return}if(null===co)throw Error(A(160));ro(t,n,l),co=null,io=!1;var a=l.alternate;null!==a&&(a.return=null),l.return=null}catch(c){Va(l,I,c)}}if(12854&I.subtreeFlags)for(I=I.child;null!==I;)Zo(I,g),I=I.sibling}function Zo(g,I){var C=g.alternate,e=g.flags;switch(g.tag){case 0:case 11:case 14:case 15:if(mo(I,g),uo(g),4&e){try{Co(3,g,g.return),eo(3,g)}catch(m){Va(g,g.return,m)}try{Co(5,g,g.return)}catch(m){Va(g,g.return,m)}}break;case 1:mo(I,g),uo(g),512&e&&null!==C&&$n(C,C.return);break;case 5:if(mo(I,g),uo(g),512&e&&null!==C&&$n(C,C.return),32&g.flags){var l=g.stateNode;try{ig(l,"")}catch(m){Va(g,g.return,m)}}if(4&e&&null!=(l=g.stateNode)){var t=g.memoizedProps,n=null!==C?C.memoizedProps:t,o=g.type,a=g.updateQueue;if(g.updateQueue=null,null!==a)try{"input"===o&&"radio"===t.type&&null!=t.name&&q(l,t),Gg(o,n);var c=Gg(o,t);for(n=0;n<a.length;n+=2){var d=a[n],i=a[n+1];"style"===d?mg(l,i):"dangerouslySetInnerHTML"===d?dg(l,i):"children"===d?ig(l,i):G(l,d,i,c)}switch(o){case"input":_(l,t);break;case"textarea":Ag(l,t);break;case"select":var s=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!t.multiple;var r=t.value;null!=r?Cg(l,!!t.multiple,r,!1):s!==!!t.multiple&&(null!=t.defaultValue?Cg(l,!!t.multiple,t.defaultValue,!0):Cg(l,!!t.multiple,t.multiple?[]:"",!1))}l[il]=t}catch(m){Va(g,g.return,m)}}break;case 6:if(mo(I,g),uo(g),4&e){if(null===g.stateNode)throw Error(A(162));l=g.stateNode,t=g.memoizedProps;try{l.nodeValue=t}catch(m){Va(g,g.return,m)}}break;case 3:if(mo(I,g),uo(g),4&e&&null!==C&&C.memoizedState.isDehydrated)try{QI(I.containerInfo)}catch(m){Va(g,g.return,m)}break;case 4:default:mo(I,g),uo(g);break;case 13:mo(I,g),uo(g),8192&(l=g.child).flags&&(t=null!==l.memoizedState,l.stateNode.isHidden=t,!t||null!==l.alternate&&null!==l.alternate.memoizedState||(Qo=qg())),4&e&&bo(g);break;case 22:if(d=null!==C&&null!==C.memoizedState,1&g.mode?(On=(c=On)||d,mo(I,g),On=c):mo(I,g),uo(g),8192&e){if(c=null!==g.memoizedState,(g.stateNode.isHidden=c)&&!d&&0!==(1&g.mode))for(_n=g,d=g.child;null!==d;){for(i=_n=d;null!==_n;){switch(r=(s=_n).child,s.tag){case 0:case 11:case 14:case 15:Co(4,s,s.return);break;case 1:$n(s,s.return);var b=s.stateNode;if("function"===typeof b.componentWillUnmount){e=s,C=s.return;try{I=e,b.props=I.memoizedProps,b.state=I.memoizedState,b.componentWillUnmount()}catch(m){Va(e,C,m)}}break;case 5:$n(s,s.return);break;case 22:if(null!==s.memoizedState){po(i);continue}}null!==r?(r.return=s,_n=r):po(i)}d=d.sibling}g:for(d=null,i=g;;){if(5===i.tag){if(null===d){d=i;try{l=i.stateNode,c?"function"===typeof(t=l.style).setProperty?t.setProperty("display","none","important"):t.display="none":(o=i.stateNode,n=void 0!==(a=i.memoizedProps.style)&&null!==a&&a.hasOwnProperty("display")?a.display:null,o.style.display=bg("display",n))}catch(m){Va(g,g.return,m)}}}else if(6===i.tag){if(null===d)try{i.stateNode.nodeValue=c?"":i.memoizedProps}catch(m){Va(g,g.return,m)}}else if((22!==i.tag&&23!==i.tag||null===i.memoizedState||i===g)&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===g)break g;for(;null===i.sibling;){if(null===i.return||i.return===g)break g;d===i&&(d=null),i=i.return}d===i&&(d=null),i.sibling.return=i.return,i=i.sibling}}break;case 19:mo(I,g),uo(g),4&e&&bo(g);case 21:}}function uo(g){var I=g.flags;if(2&I){try{g:{for(var C=g.return;null!==C;){if(to(C)){var e=C;break g}C=C.return}throw Error(A(160))}switch(e.tag){case 5:var l=e.stateNode;32&e.flags&&(ig(l,""),e.flags&=-33),ao(g,no(g),l);break;case 3:case 4:var t=e.stateNode.containerInfo;oo(g,no(g),t);break;default:throw Error(A(161))}}catch(n){Va(g,g.return,n)}g.flags&=-3}4096&I&&(g.flags&=-4097)}function Go(g,I,C){_n=g,Bo(g,I,C)}function Bo(g,I,C){for(var e=0!==(1&g.mode);null!==_n;){var l=_n,A=l.child;if(22===l.tag&&e){var t=null!==l.memoizedState||Pn;if(!t){var n=l.alternate,o=null!==n&&null!==n.memoizedState||On;n=Pn;var a=On;if(Pn=t,(On=o)&&!a)for(_n=l;null!==_n;)o=(t=_n).child,22===t.tag&&null!==t.memoizedState?yo(l):null!==o?(o.return=t,_n=o):yo(l);for(;null!==A;)_n=A,Bo(A,I,C),A=A.sibling;_n=l,Pn=n,On=a}ho(g)}else 0!==(8772&l.subtreeFlags)&&null!==A?(A.return=l,_n=A):ho(g)}}function ho(g){for(;null!==_n;){var I=_n;if(0!==(8772&I.flags)){var C=I.alternate;try{if(0!==(8772&I.flags))switch(I.tag){case 0:case 11:case 15:On||eo(5,I);break;case 1:var e=I.stateNode;if(4&I.flags&&!On)if(null===C)e.componentDidMount();else{var l=I.elementType===I.type?C.memoizedProps:bA(I.type,C.memoizedProps);e.componentDidUpdate(l,C.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}var t=I.updateQueue;null!==t&&wA(I,t,e);break;case 3:var n=I.updateQueue;if(null!==n){if(C=null,null!==I.child)switch(I.child.tag){case 5:case 1:C=I.child.stateNode}wA(I,n,C)}break;case 5:var o=I.stateNode;if(null===C&&4&I.flags){C=o;var a=I.memoizedProps;switch(I.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&C.focus();break;case"img":a.src&&(C.src=a.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===I.memoizedState){var c=I.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var i=d.dehydrated;null!==i&&QI(i)}}}break;default:throw Error(A(163))}On||512&I.flags&&lo(I)}catch(s){Va(I,I.return,s)}}if(I===g){_n=null;break}if(null!==(C=I.sibling)){C.return=I.return,_n=C;break}_n=I.return}}function po(g){for(;null!==_n;){var I=_n;if(I===g){_n=null;break}var C=I.sibling;if(null!==C){C.return=I.return,_n=C;break}_n=I.return}}function yo(g){for(;null!==_n;){var I=_n;try{switch(I.tag){case 0:case 11:case 15:var C=I.return;try{eo(4,I)}catch(o){Va(I,C,o)}break;case 1:var e=I.stateNode;if("function"===typeof e.componentDidMount){var l=I.return;try{e.componentDidMount()}catch(o){Va(I,l,o)}}var A=I.return;try{lo(I)}catch(o){Va(I,A,o)}break;case 5:var t=I.return;try{lo(I)}catch(o){Va(I,t,o)}}}catch(o){Va(I,I.return,o)}if(I===g){_n=null;break}var n=I.sibling;if(null!==n){n.return=I.return,_n=n;break}_n=I.return}}var Wo,Vo=Math.ceil,So=B.ReactCurrentDispatcher,Xo=B.ReactCurrentOwner,Ro=B.ReactCurrentBatchConfig,ko=0,Jo=null,Yo=null,vo=0,Ho=0,No=yl(0),fo=0,Ko=null,wo=0,Fo=0,xo=0,zo=null,Uo=null,Qo=0,Eo=1/0,Lo=null,Mo=!1,Do=null,To=null,jo=!1,Po=null,Oo=0,qo=0,_o=null,$o=-1,ga=0;function Ia(){return 0!==(6&ko)?qg():-1!==$o?$o:$o=qg()}function Ca(g){return 0===(1&g.mode)?1:0!==(2&ko)&&0!==vo?vo&-vo:null!==rA.transition?(0===ga&&(ga=bI()),ga):0!==(g=GI)?g:g=void 0===(g=window.event)?16:OI(g.type)}function ea(g,I,C,e){if(50<qo)throw qo=0,_o=null,Error(A(185));ZI(g,C,e),0!==(2&ko)&&g===Jo||(g===Jo&&(0===(2&ko)&&(Fo|=C),4===fo&&oa(g,vo)),la(g,e),1===C&&0===ko&&0===(1&I.mode)&&(Eo=qg()+500,Fl&&Ul()))}function la(g,I){var C=g.callbackNode;!function(g,I){for(var C=g.suspendedLanes,e=g.pingedLanes,l=g.expirationTimes,A=g.pendingLanes;0<A;){var t=31-tI(A),n=1<<t,o=l[t];-1===o?0!==(n&C)&&0===(n&e)||(l[t]=sI(n,I)):o<=I&&(g.expiredLanes|=n),A&=~n}}(g,I);var e=iI(g,g===Jo?vo:0);if(0===e)null!==C&&jg(C),g.callbackNode=null,g.callbackPriority=0;else if(I=e&-e,g.callbackPriority!==I){if(null!=C&&jg(C),1===I)0===g.tag?function(g){Fl=!0,zl(g)}(aa.bind(null,g)):zl(aa.bind(null,g)),Al((function(){0===(6&ko)&&Ul()})),C=null;else{switch(BI(e)){case 1:C=$g;break;case 4:C=gI;break;case 16:default:C=II;break;case 536870912:C=eI}C=Ja(C,Aa.bind(null,g))}g.callbackPriority=I,g.callbackNode=C}}function Aa(g,I){if($o=-1,ga=0,0!==(6&ko))throw Error(A(327));var C=g.callbackNode;if(ya()&&g.callbackNode!==C)return null;var e=iI(g,g===Jo?vo:0);if(0===e)return null;if(0!==(30&e)||0!==(e&g.expiredLanes)||I)I=Za(g,e);else{I=e;var l=ko;ko|=2;var t=ba();for(Jo===g&&vo===I||(Lo=null,Eo=qg()+500,sa(g,I));;)try{Ga();break}catch(o){ra(g,o)}BA(),So.current=t,ko=l,null!==Yo?I=0:(Jo=null,vo=0,I=fo)}if(0!==I){if(2===I&&(0!==(l=rI(g))&&(e=l,I=ta(g,l))),1===I)throw C=Ko,sa(g,0),oa(g,e),la(g,qg()),C;if(6===I)oa(g,e);else{if(l=g.current.alternate,0===(30&e)&&!function(g){for(var I=g;;){if(16384&I.flags){var C=I.updateQueue;if(null!==C&&null!==(C=C.stores))for(var e=0;e<C.length;e++){var l=C[e],A=l.getSnapshot;l=l.value;try{if(!te(A(),l))return!1}catch(n){return!1}}}if(C=I.child,16384&I.subtreeFlags&&null!==C)C.return=I,I=C;else{if(I===g)break;for(;null===I.sibling;){if(null===I.return||I.return===g)return!0;I=I.return}I.sibling.return=I.return,I=I.sibling}}return!0}(l)&&(2===(I=Za(g,e))&&(0!==(t=rI(g))&&(e=t,I=ta(g,t))),1===I))throw C=Ko,sa(g,0),oa(g,e),la(g,qg()),C;switch(g.finishedWork=l,g.finishedLanes=e,I){case 0:case 1:throw Error(A(345));case 2:case 5:pa(g,Uo,Lo);break;case 3:if(oa(g,e),(130023424&e)===e&&10<(I=Qo+500-qg())){if(0!==iI(g,0))break;if(((l=g.suspendedLanes)&e)!==e){Ia(),g.pingedLanes|=g.suspendedLanes&l;break}g.timeoutHandle=Cl(pa.bind(null,g,Uo,Lo),I);break}pa(g,Uo,Lo);break;case 4:if(oa(g,e),(4194240&e)===e)break;for(I=g.eventTimes,l=-1;0<e;){var n=31-tI(e);t=1<<n,(n=I[n])>l&&(l=n),e&=~t}if(e=l,10<(e=(120>(e=qg()-e)?120:480>e?480:1080>e?1080:1920>e?1920:3e3>e?3e3:4320>e?4320:1960*Vo(e/1960))-e)){g.timeoutHandle=Cl(pa.bind(null,g,Uo,Lo),e);break}pa(g,Uo,Lo);break;default:throw Error(A(329))}}}return la(g,qg()),g.callbackNode===C?Aa.bind(null,g):null}function ta(g,I){var C=zo;return g.current.memoizedState.isDehydrated&&(sa(g,I).flags|=256),2!==(g=Za(g,I))&&(I=Uo,Uo=C,null!==I&&na(I)),g}function na(g){null===Uo?Uo=g:Uo.push.apply(Uo,g)}function oa(g,I){for(I&=~xo,I&=~Fo,g.suspendedLanes|=I,g.pingedLanes&=~I,g=g.expirationTimes;0<I;){var C=31-tI(I),e=1<<C;g[C]=-1,I&=~e}}function aa(g){if(0!==(6&ko))throw Error(A(327));ya();var I=iI(g,0);if(0===(1&I))return la(g,qg()),null;var C=Za(g,I);if(0!==g.tag&&2===C){var e=rI(g);0!==e&&(I=e,C=ta(g,e))}if(1===C)throw C=Ko,sa(g,0),oa(g,I),la(g,qg()),C;if(6===C)throw Error(A(345));return g.finishedWork=g.current.alternate,g.finishedLanes=I,pa(g,Uo,Lo),la(g,qg()),null}function ca(g,I){var C=ko;ko|=1;try{return g(I)}finally{0===(ko=C)&&(Eo=qg()+500,Fl&&Ul())}}function da(g){null!==Po&&0===Po.tag&&0===(6&ko)&&ya();var I=ko;ko|=1;var C=Ro.transition,e=GI;try{if(Ro.transition=null,GI=1,g)return g()}finally{GI=e,Ro.transition=C,0===(6&(ko=I))&&Ul()}}function ia(){Ho=No.current,Wl(No)}function sa(g,I){g.finishedWork=null,g.finishedLanes=0;var C=g.timeoutHandle;if(-1!==C&&(g.timeoutHandle=-1,el(C)),null!==Yo)for(C=Yo.return;null!==C;){var e=C;switch(gA(e),e.tag){case 1:null!==(e=e.type.childContextTypes)&&void 0!==e&&vl();break;case 3:et(),Wl(Rl),Wl(Xl),at();break;case 5:At(e);break;case 4:et();break;case 13:case 19:Wl(tt);break;case 10:hA(e.type._context);break;case 22:case 23:ia()}C=C.return}if(Jo=g,Yo=g=Na(g.current,null),vo=Ho=I,fo=0,Ko=null,xo=Fo=wo=0,Uo=zo=null,null!==VA){for(I=0;I<VA.length;I++)if(null!==(e=(C=VA[I]).interleaved)){C.interleaved=null;var l=e.next,A=C.pending;if(null!==A){var t=A.next;A.next=l,e.next=t}C.pending=e}VA=null}return g}function ra(g,I){for(;;){var C=Yo;try{if(BA(),ct.current=ln,mt){for(var e=st.memoizedState;null!==e;){var l=e.queue;null!==l&&(l.pending=null),e=e.next}mt=!1}if(it=0,bt=rt=st=null,Zt=!1,ut=0,Xo.current=null,null===C||null===C.return){fo=1,Ko=I,Yo=null;break}g:{var t=g,n=C.return,o=C,a=I;if(I=vo,o.flags|=32768,null!==a&&"object"===typeof a&&"function"===typeof a.then){var c=a,d=o,i=d.tag;if(0===(1&d.mode)&&(0===i||11===i||15===i)){var s=d.alternate;s?(d.updateQueue=s.updateQueue,d.memoizedState=s.memoizedState,d.lanes=s.lanes):(d.updateQueue=null,d.memoizedState=null)}var r=mn(n);if(null!==r){r.flags&=-257,Zn(r,n,o,0,I),1&r.mode&&bn(t,c,I),a=c;var b=(I=r).updateQueue;if(null===b){var m=new Set;m.add(a),I.updateQueue=m}else b.add(a);break g}if(0===(1&I)){bn(t,c,I),ma();break g}a=Error(A(426))}else if(eA&&1&o.mode){var Z=mn(n);if(null!==Z){0===(65536&Z.flags)&&(Z.flags|=256),Zn(Z,n,o,0,I),sA(on(a,o));break g}}t=a=on(a,o),4!==fo&&(fo=2),null===zo?zo=[t]:zo.push(t),t=n;do{switch(t.tag){case 3:t.flags|=65536,I&=-I,t.lanes|=I,fA(t,sn(0,a,I));break g;case 1:o=a;var u=t.type,G=t.stateNode;if(0===(128&t.flags)&&("function"===typeof u.getDerivedStateFromError||null!==G&&"function"===typeof G.componentDidCatch&&(null===To||!To.has(G)))){t.flags|=65536,I&=-I,t.lanes|=I,fA(t,rn(t,o,I));break g}}t=t.return}while(null!==t)}ha(C)}catch(B){I=B,Yo===C&&null!==C&&(Yo=C=C.return);continue}break}}function ba(){var g=So.current;return So.current=ln,null===g?ln:g}function ma(){0!==fo&&3!==fo&&2!==fo||(fo=4),null===Jo||0===(268435455&wo)&&0===(268435455&Fo)||oa(Jo,vo)}function Za(g,I){var C=ko;ko|=2;var e=ba();for(Jo===g&&vo===I||(Lo=null,sa(g,I));;)try{ua();break}catch(l){ra(g,l)}if(BA(),ko=C,So.current=e,null!==Yo)throw Error(A(261));return Jo=null,vo=0,fo}function ua(){for(;null!==Yo;)Ba(Yo)}function Ga(){for(;null!==Yo&&!Pg();)Ba(Yo)}function Ba(g){var I=Wo(g.alternate,g,Ho);g.memoizedProps=g.pendingProps,null===I?ha(g):Yo=I,Xo.current=null}function ha(g){var I=g;do{var C=I.alternate;if(g=I.return,0===(32768&I.flags)){if(null!==(C=Tn(C,I,Ho)))return void(Yo=C)}else{if(null!==(C=jn(C,I)))return C.flags&=32767,void(Yo=C);if(null===g)return fo=6,void(Yo=null);g.flags|=32768,g.subtreeFlags=0,g.deletions=null}if(null!==(I=I.sibling))return void(Yo=I);Yo=I=g}while(null!==I);0===fo&&(fo=5)}function pa(g,I,C){var e=GI,l=Ro.transition;try{Ro.transition=null,GI=1,function(g,I,C,e){do{ya()}while(null!==Po);if(0!==(6&ko))throw Error(A(327));C=g.finishedWork;var l=g.finishedLanes;if(null===C)return null;if(g.finishedWork=null,g.finishedLanes=0,C===g.current)throw Error(A(177));g.callbackNode=null,g.callbackPriority=0;var t=C.lanes|C.childLanes;if(function(g,I){var C=g.pendingLanes&~I;g.pendingLanes=I,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=I,g.mutableReadLanes&=I,g.entangledLanes&=I,I=g.entanglements;var e=g.eventTimes;for(g=g.expirationTimes;0<C;){var l=31-tI(C),A=1<<l;I[l]=0,e[l]=-1,g[l]=-1,C&=~A}}(g,t),g===Jo&&(Yo=Jo=null,vo=0),0===(2064&C.subtreeFlags)&&0===(2064&C.flags)||jo||(jo=!0,Ja(II,(function(){return ya(),null}))),t=0!==(15990&C.flags),0!==(15990&C.subtreeFlags)||t){t=Ro.transition,Ro.transition=null;var n=GI;GI=1;var o=ko;ko|=4,Xo.current=null,function(g,I){if($e=LI,ie(g=de())){if("selectionStart"in g)var C={start:g.selectionStart,end:g.selectionEnd};else g:{var e=(C=(C=g.ownerDocument)&&C.defaultView||window).getSelection&&C.getSelection();if(e&&0!==e.rangeCount){C=e.anchorNode;var l=e.anchorOffset,t=e.focusNode;e=e.focusOffset;try{C.nodeType,t.nodeType}catch(h){C=null;break g}var n=0,o=-1,a=-1,c=0,d=0,i=g,s=null;I:for(;;){for(var r;i!==C||0!==l&&3!==i.nodeType||(o=n+l),i!==t||0!==e&&3!==i.nodeType||(a=n+e),3===i.nodeType&&(n+=i.nodeValue.length),null!==(r=i.firstChild);)s=i,i=r;for(;;){if(i===g)break I;if(s===C&&++c===l&&(o=n),s===t&&++d===e&&(a=n),null!==(r=i.nextSibling))break;s=(i=s).parentNode}i=r}C=-1===o||-1===a?null:{start:o,end:a}}else C=null}C=C||{start:0,end:0}}else C=null;for(gl={focusedElem:g,selectionRange:C},LI=!1,_n=I;null!==_n;)if(g=(I=_n).child,0!==(1028&I.subtreeFlags)&&null!==g)g.return=I,_n=g;else for(;null!==_n;){I=_n;try{var b=I.alternate;if(0!==(1024&I.flags))switch(I.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==b){var m=b.memoizedProps,Z=b.memoizedState,u=I.stateNode,G=u.getSnapshotBeforeUpdate(I.elementType===I.type?m:bA(I.type,m),Z);u.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var B=I.stateNode.containerInfo;1===B.nodeType?B.textContent="":9===B.nodeType&&B.documentElement&&B.removeChild(B.documentElement);break;default:throw Error(A(163))}}catch(h){Va(I,I.return,h)}if(null!==(g=I.sibling)){g.return=I.return,_n=g;break}_n=I.return}b=Io,Io=!1}(g,C),Zo(C,g),se(gl),LI=!!$e,gl=$e=null,g.current=C,Go(C,g,l),Og(),ko=o,GI=n,Ro.transition=t}else g.current=C;if(jo&&(jo=!1,Po=g,Oo=l),t=g.pendingLanes,0===t&&(To=null),function(g){if(AI&&"function"===typeof AI.onCommitFiberRoot)try{AI.onCommitFiberRoot(lI,g,void 0,128===(128&g.current.flags))}catch(I){}}(C.stateNode),la(g,qg()),null!==I)for(e=g.onRecoverableError,C=0;C<I.length;C++)l=I[C],e(l.value,{componentStack:l.stack,digest:l.digest});if(Mo)throw Mo=!1,g=Do,Do=null,g;0!==(1&Oo)&&0!==g.tag&&ya(),t=g.pendingLanes,0!==(1&t)?g===_o?qo++:(qo=0,_o=g):qo=0,Ul()}(g,I,C,e)}finally{Ro.transition=l,GI=e}return null}function ya(){if(null!==Po){var g=BI(Oo),I=Ro.transition,C=GI;try{if(Ro.transition=null,GI=16>g?16:g,null===Po)var e=!1;else{if(g=Po,Po=null,Oo=0,0!==(6&ko))throw Error(A(331));var l=ko;for(ko|=4,_n=g.current;null!==_n;){var t=_n,n=t.child;if(0!==(16&_n.flags)){var o=t.deletions;if(null!==o){for(var a=0;a<o.length;a++){var c=o[a];for(_n=c;null!==_n;){var d=_n;switch(d.tag){case 0:case 11:case 15:Co(8,d,t)}var i=d.child;if(null!==i)i.return=d,_n=i;else for(;null!==_n;){var s=(d=_n).sibling,r=d.return;if(Ao(d),d===c){_n=null;break}if(null!==s){s.return=r,_n=s;break}_n=r}}}var b=t.alternate;if(null!==b){var m=b.child;if(null!==m){b.child=null;do{var Z=m.sibling;m.sibling=null,m=Z}while(null!==m)}}_n=t}}if(0!==(2064&t.subtreeFlags)&&null!==n)n.return=t,_n=n;else g:for(;null!==_n;){if(0!==(2048&(t=_n).flags))switch(t.tag){case 0:case 11:case 15:Co(9,t,t.return)}var u=t.sibling;if(null!==u){u.return=t.return,_n=u;break g}_n=t.return}}var G=g.current;for(_n=G;null!==_n;){var B=(n=_n).child;if(0!==(2064&n.subtreeFlags)&&null!==B)B.return=n,_n=B;else g:for(n=G;null!==_n;){if(0!==(2048&(o=_n).flags))try{switch(o.tag){case 0:case 11:case 15:eo(9,o)}}catch(p){Va(o,o.return,p)}if(o===n){_n=null;break g}var h=o.sibling;if(null!==h){h.return=o.return,_n=h;break g}_n=o.return}}if(ko=l,Ul(),AI&&"function"===typeof AI.onPostCommitFiberRoot)try{AI.onPostCommitFiberRoot(lI,g)}catch(p){}e=!0}return e}finally{GI=C,Ro.transition=I}}return!1}function Wa(g,I,C){g=HA(g,I=sn(0,I=on(C,I),1),1),I=Ia(),null!==g&&(ZI(g,1,I),la(g,I))}function Va(g,I,C){if(3===g.tag)Wa(g,g,C);else for(;null!==I;){if(3===I.tag){Wa(I,g,C);break}if(1===I.tag){var e=I.stateNode;if("function"===typeof I.type.getDerivedStateFromError||"function"===typeof e.componentDidCatch&&(null===To||!To.has(e))){I=HA(I,g=rn(I,g=on(C,g),1),1),g=Ia(),null!==I&&(ZI(I,1,g),la(I,g));break}}I=I.return}}function Sa(g,I,C){var e=g.pingCache;null!==e&&e.delete(I),I=Ia(),g.pingedLanes|=g.suspendedLanes&C,Jo===g&&(vo&C)===C&&(4===fo||3===fo&&(130023424&vo)===vo&&500>qg()-Qo?sa(g,0):xo|=C),la(g,I)}function Xa(g,I){0===I&&(0===(1&g.mode)?I=1:(I=cI,0===(130023424&(cI<<=1))&&(cI=4194304)));var C=Ia();null!==(g=RA(g,I))&&(ZI(g,I,C),la(g,C))}function Ra(g){var I=g.memoizedState,C=0;null!==I&&(C=I.retryLane),Xa(g,C)}function ka(g,I){var C=0;switch(g.tag){case 13:var e=g.stateNode,l=g.memoizedState;null!==l&&(C=l.retryLane);break;case 19:e=g.stateNode;break;default:throw Error(A(314))}null!==e&&e.delete(I),Xa(g,C)}function Ja(g,I){return Tg(g,I)}function Ya(g,I,C,e){this.tag=g,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=I,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=e,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function va(g,I,C,e){return new Ya(g,I,C,e)}function Ha(g){return!(!(g=g.prototype)||!g.isReactComponent)}function Na(g,I){var C=g.alternate;return null===C?((C=va(g.tag,I,g.key,g.mode)).elementType=g.elementType,C.type=g.type,C.stateNode=g.stateNode,C.alternate=g,g.alternate=C):(C.pendingProps=I,C.type=g.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=14680064&g.flags,C.childLanes=g.childLanes,C.lanes=g.lanes,C.child=g.child,C.memoizedProps=g.memoizedProps,C.memoizedState=g.memoizedState,C.updateQueue=g.updateQueue,I=g.dependencies,C.dependencies=null===I?null:{lanes:I.lanes,firstContext:I.firstContext},C.sibling=g.sibling,C.index=g.index,C.ref=g.ref,C}function fa(g,I,C,e,l,t){var n=2;if(e=g,"function"===typeof g)Ha(g)&&(n=1);else if("string"===typeof g)n=5;else g:switch(g){case y:return Ka(C.children,l,t,I);case W:n=8,l|=8;break;case V:return(g=va(12,C,I,2|l)).elementType=V,g.lanes=t,g;case k:return(g=va(13,C,I,l)).elementType=k,g.lanes=t,g;case J:return(g=va(19,C,I,l)).elementType=J,g.lanes=t,g;case H:return wa(C,l,t,I);default:if("object"===typeof g&&null!==g)switch(g.$$typeof){case S:n=10;break g;case X:n=9;break g;case R:n=11;break g;case Y:n=14;break g;case v:n=16,e=null;break g}throw Error(A(130,null==g?g:typeof g,""))}return(I=va(n,C,I,l)).elementType=g,I.type=e,I.lanes=t,I}function Ka(g,I,C,e){return(g=va(7,g,e,I)).lanes=C,g}function wa(g,I,C,e){return(g=va(22,g,e,I)).elementType=H,g.lanes=C,g.stateNode={isHidden:!1},g}function Fa(g,I,C){return(g=va(6,g,null,I)).lanes=C,g}function xa(g,I,C){return(I=va(4,null!==g.children?g.children:[],g.key,I)).lanes=C,I.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},I}function za(g,I,C,e,l){this.tag=I,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mI(0),this.expirationTimes=mI(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mI(0),this.identifierPrefix=e,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Ua(g,I,C,e,l,A,t,n,o){return g=new za(g,I,C,n,o),1===I?(I=1,!0===A&&(I|=8)):I=0,A=va(3,null,null,I),g.current=A,A.stateNode=g,A.memoizedState={element:e,isDehydrated:C,cache:null,transitions:null,pendingSuspenseBoundaries:null},JA(A),g}function Qa(g){if(!g)return Sl;g:{if(Qg(g=g._reactInternals)!==g||1!==g.tag)throw Error(A(170));var I=g;do{switch(I.tag){case 3:I=I.stateNode.context;break g;case 1:if(Yl(I.type)){I=I.stateNode.__reactInternalMemoizedMergedChildContext;break g}}I=I.return}while(null!==I);throw Error(A(171))}if(1===g.tag){var C=g.type;if(Yl(C))return Nl(g,C,I)}return I}function Ea(g,I,C,e,l,A,t,n,o){return(g=Ua(C,e,!0,g,0,A,0,n,o)).context=Qa(null),C=g.current,(A=vA(e=Ia(),l=Ca(C))).callback=void 0!==I&&null!==I?I:null,HA(C,A,l),g.current.lanes=l,ZI(g,l,e),la(g,e),g}function La(g,I,C,e){var l=I.current,A=Ia(),t=Ca(l);return C=Qa(C),null===I.context?I.context=C:I.pendingContext=C,(I=vA(A,t)).payload={element:g},null!==(e=void 0===e?null:e)&&(I.callback=e),null!==(g=HA(l,I,t))&&(ea(g,l,t,A),NA(g,l,t)),t}function Ma(g){return(g=g.current).child?(g.child.tag,g.child.stateNode):null}function Da(g,I){if(null!==(g=g.memoizedState)&&null!==g.dehydrated){var C=g.retryLane;g.retryLane=0!==C&&C<I?C:I}}function Ta(g,I){Da(g,I),(g=g.alternate)&&Da(g,I)}Wo=function(g,I,C){if(null!==g)if(g.memoizedProps!==I.pendingProps||Rl.current)Gn=!0;else{if(0===(g.lanes&C)&&0===(128&I.flags))return Gn=!1,function(g,I,C){switch(I.tag){case 3:kn(I),iA();break;case 5:lt(I);break;case 1:Yl(I.type)&&fl(I);break;case 4:Ct(I,I.stateNode.containerInfo);break;case 10:var e=I.type._context,l=I.memoizedProps.value;Vl(mA,e._currentValue),e._currentValue=l;break;case 13:if(null!==(e=I.memoizedState))return null!==e.dehydrated?(Vl(tt,1&tt.current),I.flags|=128,null):0!==(C&I.child.childLanes)?wn(g,I,C):(Vl(tt,1&tt.current),null!==(g=Ln(g,I,C))?g.sibling:null);Vl(tt,1&tt.current);break;case 19:if(e=0!==(C&I.childLanes),0!==(128&g.flags)){if(e)return Qn(g,I,C);I.flags|=128}if(null!==(l=I.memoizedState)&&(l.rendering=null,l.tail=null,l.lastEffect=null),Vl(tt,tt.current),e)break;return null;case 22:case 23:return I.lanes=0,Wn(g,I,C)}return Ln(g,I,C)}(g,I,C);Gn=0!==(131072&g.flags)}else Gn=!1,eA&&0!==(1048576&I.flags)&&_l(I,Ml,I.index);switch(I.lanes=0,I.tag){case 2:var e=I.type;En(g,I),g=I.pendingProps;var l=Jl(I,Xl.current);yA(I,C),l=pt(null,I,e,g,l,C);var t=yt();return I.flags|=1,"object"===typeof l&&null!==l&&"function"===typeof l.render&&void 0===l.$$typeof?(I.tag=1,I.memoizedState=null,I.updateQueue=null,Yl(e)?(t=!0,fl(I)):t=!1,I.memoizedState=null!==l.state&&void 0!==l.state?l.state:null,JA(I),l.updater=zA,I.stateNode=l,l._reactInternals=I,LA(I,e,g,C),I=Rn(null,I,e,!0,t,C)):(I.tag=0,eA&&t&&$l(I),Bn(null,I,l,C),I=I.child),I;case 16:e=I.elementType;g:{switch(En(g,I),g=I.pendingProps,e=(l=e._init)(e._payload),I.type=e,l=I.tag=function(g){if("function"===typeof g)return Ha(g)?1:0;if(void 0!==g&&null!==g){if((g=g.$$typeof)===R)return 11;if(g===Y)return 14}return 2}(e),g=bA(e,g),l){case 0:I=Sn(null,I,e,g,C);break g;case 1:I=Xn(null,I,e,g,C);break g;case 11:I=hn(null,I,e,g,C);break g;case 14:I=pn(null,I,e,bA(e.type,g),C);break g}throw Error(A(306,e,""))}return I;case 0:return e=I.type,l=I.pendingProps,Sn(g,I,e,l=I.elementType===e?l:bA(e,l),C);case 1:return e=I.type,l=I.pendingProps,Xn(g,I,e,l=I.elementType===e?l:bA(e,l),C);case 3:g:{if(kn(I),null===g)throw Error(A(387));e=I.pendingProps,l=(t=I.memoizedState).element,YA(g,I),KA(I,e,null,C);var n=I.memoizedState;if(e=n.element,t.isDehydrated){if(t={element:e,isDehydrated:!1,cache:n.cache,pendingSuspenseBoundaries:n.pendingSuspenseBoundaries,transitions:n.transitions},I.updateQueue.baseState=t,I.memoizedState=t,256&I.flags){I=Jn(g,I,e,C,l=on(Error(A(423)),I));break g}if(e!==l){I=Jn(g,I,e,C,l=on(Error(A(424)),I));break g}for(CA=ol(I.stateNode.containerInfo.firstChild),IA=I,eA=!0,lA=null,C=OA(I,null,e,C),I.child=C;C;)C.flags=-3&C.flags|4096,C=C.sibling}else{if(iA(),e===l){I=Ln(g,I,C);break g}Bn(g,I,e,C)}I=I.child}return I;case 5:return lt(I),null===g&&oA(I),e=I.type,l=I.pendingProps,t=null!==g?g.memoizedProps:null,n=l.children,Il(e,l)?n=null:null!==t&&Il(e,t)&&(I.flags|=32),Vn(g,I),Bn(g,I,n,C),I.child;case 6:return null===g&&oA(I),null;case 13:return wn(g,I,C);case 4:return Ct(I,I.stateNode.containerInfo),e=I.pendingProps,null===g?I.child=PA(I,null,e,C):Bn(g,I,e,C),I.child;case 11:return e=I.type,l=I.pendingProps,hn(g,I,e,l=I.elementType===e?l:bA(e,l),C);case 7:return Bn(g,I,I.pendingProps,C),I.child;case 8:case 12:return Bn(g,I,I.pendingProps.children,C),I.child;case 10:g:{if(e=I.type._context,l=I.pendingProps,t=I.memoizedProps,n=l.value,Vl(mA,e._currentValue),e._currentValue=n,null!==t)if(te(t.value,n)){if(t.children===l.children&&!Rl.current){I=Ln(g,I,C);break g}}else for(null!==(t=I.child)&&(t.return=I);null!==t;){var o=t.dependencies;if(null!==o){n=t.child;for(var a=o.firstContext;null!==a;){if(a.context===e){if(1===t.tag){(a=vA(-1,C&-C)).tag=2;var c=t.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?a.next=a:(a.next=d.next,d.next=a),c.pending=a}}t.lanes|=C,null!==(a=t.alternate)&&(a.lanes|=C),pA(t.return,C,I),o.lanes|=C;break}a=a.next}}else if(10===t.tag)n=t.type===I.type?null:t.child;else if(18===t.tag){if(null===(n=t.return))throw Error(A(341));n.lanes|=C,null!==(o=n.alternate)&&(o.lanes|=C),pA(n,C,I),n=t.sibling}else n=t.child;if(null!==n)n.return=t;else for(n=t;null!==n;){if(n===I){n=null;break}if(null!==(t=n.sibling)){t.return=n.return,n=t;break}n=n.return}t=n}Bn(g,I,l.children,C),I=I.child}return I;case 9:return l=I.type,e=I.pendingProps.children,yA(I,C),e=e(l=WA(l)),I.flags|=1,Bn(g,I,e,C),I.child;case 14:return l=bA(e=I.type,I.pendingProps),pn(g,I,e,l=bA(e.type,l),C);case 15:return yn(g,I,I.type,I.pendingProps,C);case 17:return e=I.type,l=I.pendingProps,l=I.elementType===e?l:bA(e,l),En(g,I),I.tag=1,Yl(e)?(g=!0,fl(I)):g=!1,yA(I,C),QA(I,e,l),LA(I,e,l,C),Rn(null,I,e,!0,g,C);case 19:return Qn(g,I,C);case 22:return Wn(g,I,C)}throw Error(A(156,I.tag))};var ja="function"===typeof reportError?reportError:function(g){console.error(g)};function Pa(g){this._internalRoot=g}function Oa(g){this._internalRoot=g}function qa(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType)}function _a(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType&&(8!==g.nodeType||" react-mount-point-unstable "!==g.nodeValue))}function $a(){}function gc(g,I,C,e,l){var A=C._reactRootContainer;if(A){var t=A;if("function"===typeof l){var n=l;l=function(){var g=Ma(t);n.call(g)}}La(I,t,g,l)}else t=function(g,I,C,e,l){if(l){if("function"===typeof e){var A=e;e=function(){var g=Ma(t);A.call(g)}}var t=Ea(I,e,g,0,null,!1,0,"",$a);return g._reactRootContainer=t,g[sl]=t.current,Ue(8===g.nodeType?g.parentNode:g),da(),t}for(;l=g.lastChild;)g.removeChild(l);if("function"===typeof e){var n=e;e=function(){var g=Ma(o);n.call(g)}}var o=Ua(g,0,!1,null,0,!1,0,"",$a);return g._reactRootContainer=o,g[sl]=o.current,Ue(8===g.nodeType?g.parentNode:g),da((function(){La(I,o,C,e)})),o}(C,I,g,l,e);return Ma(t)}Oa.prototype.render=Pa.prototype.render=function(g){var I=this._internalRoot;if(null===I)throw Error(A(409));La(g,I,null,null)},Oa.prototype.unmount=Pa.prototype.unmount=function(){var g=this._internalRoot;if(null!==g){this._internalRoot=null;var I=g.containerInfo;da((function(){La(null,g,null,null)})),I[sl]=null}},Oa.prototype.unstable_scheduleHydration=function(g){if(g){var I=WI();g={blockedOn:null,target:g,priority:I};for(var C=0;C<HI.length&&0!==I&&I<HI[C].priority;C++);HI.splice(C,0,g),0===C&&wI(g)}},hI=function(g){switch(g.tag){case 3:var I=g.stateNode;if(I.current.memoizedState.isDehydrated){var C=dI(I.pendingLanes);0!==C&&(uI(I,1|C),la(I,qg()),0===(6&ko)&&(Eo=qg()+500,Ul()))}break;case 13:da((function(){var I=RA(g,1);if(null!==I){var C=Ia();ea(I,g,1,C)}})),Ta(g,1)}},pI=function(g){if(13===g.tag){var I=RA(g,134217728);if(null!==I)ea(I,g,134217728,Ia());Ta(g,134217728)}},yI=function(g){if(13===g.tag){var I=Ca(g),C=RA(g,I);if(null!==C)ea(C,g,I,Ia());Ta(g,I)}},WI=function(){return GI},VI=function(g,I){var C=GI;try{return GI=g,I()}finally{GI=C}},pg=function(g,I,C){switch(I){case"input":if(_(g,C),I=C.name,"radio"===C.type&&null!=I){for(C=g;C.parentNode;)C=C.parentNode;for(C=C.querySelectorAll("input[name="+JSON.stringify(""+I)+'][type="radio"]'),I=0;I<C.length;I++){var e=C[I];if(e!==g&&e.form===g.form){var l=Bl(e);if(!l)throw Error(A(90));T(e),_(e,l)}}}break;case"textarea":Ag(g,C);break;case"select":null!=(I=C.value)&&Cg(g,!!C.multiple,I,!1)}},Rg=ca,kg=da;var Ic={usingClientEntryPoint:!1,Events:[ul,Gl,Bl,Sg,Xg,ca]},Cc={findFiberByHostInstance:Zl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ec={bundleType:Cc.bundleType,version:Cc.version,rendererPackageName:Cc.rendererPackageName,rendererConfig:Cc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:B.ReactCurrentDispatcher,findHostInstanceByFiber:function(g){return null===(g=Mg(g))?null:g.stateNode},findFiberByHostInstance:Cc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var lc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lc.isDisabled&&lc.supportsFiber)try{lI=lc.inject(ec),AI=lc}catch(cg){}}I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ic,I.createPortal=function(g,I){var C=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!qa(I))throw Error(A(200));return function(g,I,C){var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:p,key:null==e?null:""+e,children:g,containerInfo:I,implementation:C}}(g,I,null,C)},I.createRoot=function(g,I){if(!qa(g))throw Error(A(299));var C=!1,e="",l=ja;return null!==I&&void 0!==I&&(!0===I.unstable_strictMode&&(C=!0),void 0!==I.identifierPrefix&&(e=I.identifierPrefix),void 0!==I.onRecoverableError&&(l=I.onRecoverableError)),I=Ua(g,1,!1,null,0,C,0,e,l),g[sl]=I.current,Ue(8===g.nodeType?g.parentNode:g),new Pa(I)},I.findDOMNode=function(g){if(null==g)return null;if(1===g.nodeType)return g;var I=g._reactInternals;if(void 0===I){if("function"===typeof g.render)throw Error(A(188));throw g=Object.keys(g).join(","),Error(A(268,g))}return g=null===(g=Mg(I))?null:g.stateNode},I.flushSync=function(g){return da(g)},I.hydrate=function(g,I,C){if(!_a(I))throw Error(A(200));return gc(null,g,I,!0,C)},I.hydrateRoot=function(g,I,C){if(!qa(g))throw Error(A(405));var e=null!=C&&C.hydratedSources||null,l=!1,t="",n=ja;if(null!==C&&void 0!==C&&(!0===C.unstable_strictMode&&(l=!0),void 0!==C.identifierPrefix&&(t=C.identifierPrefix),void 0!==C.onRecoverableError&&(n=C.onRecoverableError)),I=Ea(I,null,g,1,null!=C?C:null,l,0,t,n),g[sl]=I.current,Ue(g),e)for(g=0;g<e.length;g++)l=(l=(C=e[g])._getVersion)(C._source),null==I.mutableSourceEagerHydrationData?I.mutableSourceEagerHydrationData=[C,l]:I.mutableSourceEagerHydrationData.push(C,l);return new Oa(I)},I.render=function(g,I,C){if(!_a(I))throw Error(A(200));return gc(null,g,I,!1,C)},I.unmountComponentAtNode=function(g){if(!_a(g))throw Error(A(40));return!!g._reactRootContainer&&(da((function(){gc(null,null,g,!1,(function(){g._reactRootContainer=null,g[sl]=null}))})),!0)},I.unstable_batchedUpdates=ca,I.unstable_renderSubtreeIntoContainer=function(g,I,C,e){if(!_a(C))throw Error(A(200));if(null==g||void 0===g._reactInternals)throw Error(A(38));return gc(g,I,C,!1,e)},I.version="18.2.0-next-9e3b772b8-20220608"},1250:(g,I,C)=>{"use strict";var e=C(4164);I.createRoot=e.createRoot,I.hydrateRoot=e.hydrateRoot},4164:(g,I,C)=>{"use strict";!function g(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(I){console.error(I)}}(),g.exports=C(4463)},1372:(g,I)=>{"use strict";var C,e=Symbol.for("react.element"),l=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),t=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),c=Symbol.for("react.server_context"),d=Symbol.for("react.forward_ref"),i=Symbol.for("react.suspense"),s=Symbol.for("react.suspense_list"),r=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),m=Symbol.for("react.offscreen");function Z(g){if("object"===typeof g&&null!==g){var I=g.$$typeof;switch(I){case e:switch(g=g.type){case A:case n:case t:case i:case s:return g;default:switch(g=g&&g.$$typeof){case c:case a:case d:case b:case r:case o:return g;default:return I}}case l:return I}}}C=Symbol.for("react.module.reference"),I.isContextConsumer=function(g){return Z(g)===a}},7441:(g,I,C)=>{"use strict";g.exports=C(1372)},9008:function(g,I,C){g.exports=function(g){"use strict";function I(g){if(g&&g.__esModule)return g;var I=Object.create(null);return g&&Object.keys(g).forEach((function(C){if("default"!==C){var e=Object.getOwnPropertyDescriptor(g,C);Object.defineProperty(I,C,e.get?e:{enumerable:!0,get:function(){return g[C]}})}})),I.default=g,Object.freeze(I)}var C=I(g);function e(){return e=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var C=arguments[I];for(var e in C)Object.prototype.hasOwnProperty.call(C,e)&&(g[e]=C[e])}return g},e.apply(this,arguments)}function l(g,I,C){return I in g?Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}):g[I]=C,g}function A(g){if(Array.isArray(g))return g}function t(g,I){var C=null==g?null:"undefined"!==typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(null!=C){var e,l,A=[],t=!0,n=!1;try{for(C=C.call(g);!(t=(e=C.next()).done)&&(A.push(e.value),!I||A.length!==I);t=!0);}catch(o){n=!0,l=o}finally{try{t||null==C.return||C.return()}finally{if(n)throw l}}return A}}function n(g,I){(null==I||I>g.length)&&(I=g.length);for(var C=0,e=new Array(I);C<I;C++)e[C]=g[C];return e}function o(g,I){if(g){if("string"===typeof g)return n(g,I);var C=Object.prototype.toString.call(g).slice(8,-1);return"Object"===C&&g.constructor&&(C=g.constructor.name),"Map"===C||"Set"===C?Array.from(g):"Arguments"===C||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C)?n(g,I):void 0}}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(g,I){return A(g)||t(g,I)||o(g,I)||a()}function d(g,I){if(null==g)return{};var C,e,l={},A=Object.keys(g);for(e=0;e<A.length;e++)C=A[e],I.indexOf(C)>=0||(l[C]=g[C]);return l}function i(g,I){if(null==g)return{};var C,e,l=d(g,I);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(g);for(e=0;e<A.length;e++)C=A[e],I.indexOf(C)>=0||Object.prototype.propertyIsEnumerable.call(g,C)&&(l[C]=g[C])}return l}var s={exports:{}},r={exports:{}},b={},m="function"===typeof Symbol&&Symbol.for,Z=m?Symbol.for("react.element"):60103,u=m?Symbol.for("react.portal"):60106,G=m?Symbol.for("react.fragment"):60107,B=m?Symbol.for("react.strict_mode"):60108,h=m?Symbol.for("react.profiler"):60114,p=m?Symbol.for("react.provider"):60109,y=m?Symbol.for("react.context"):60110,W=m?Symbol.for("react.async_mode"):60111,V=m?Symbol.for("react.concurrent_mode"):60111,S=m?Symbol.for("react.forward_ref"):60112,X=m?Symbol.for("react.suspense"):60113,R=m?Symbol.for("react.suspense_list"):60120,k=m?Symbol.for("react.memo"):60115,J=m?Symbol.for("react.lazy"):60116,Y=m?Symbol.for("react.block"):60121,v=m?Symbol.for("react.fundamental"):60117,H=m?Symbol.for("react.responder"):60118,N=m?Symbol.for("react.scope"):60119;function f(g){if("object"===typeof g&&null!==g){var I=g.$$typeof;switch(I){case Z:switch(g=g.type){case W:case V:case G:case h:case B:case X:return g;default:switch(g=g&&g.$$typeof){case y:case S:case J:case k:case p:return g;default:return I}}case u:return I}}}function K(g){return f(g)===V}b.AsyncMode=W,b.ConcurrentMode=V,b.ContextConsumer=y,b.ContextProvider=p,b.Element=Z,b.ForwardRef=S,b.Fragment=G,b.Lazy=J,b.Memo=k,b.Portal=u,b.Profiler=h,b.StrictMode=B,b.Suspense=X,b.isAsyncMode=function(g){return K(g)||f(g)===W},b.isConcurrentMode=K,b.isContextConsumer=function(g){return f(g)===y},b.isContextProvider=function(g){return f(g)===p},b.isElement=function(g){return"object"===typeof g&&null!==g&&g.$$typeof===Z},b.isForwardRef=function(g){return f(g)===S},b.isFragment=function(g){return f(g)===G},b.isLazy=function(g){return f(g)===J},b.isMemo=function(g){return f(g)===k},b.isPortal=function(g){return f(g)===u},b.isProfiler=function(g){return f(g)===h},b.isStrictMode=function(g){return f(g)===B},b.isSuspense=function(g){return f(g)===X},b.isValidElementType=function(g){return"string"===typeof g||"function"===typeof g||g===G||g===V||g===h||g===B||g===X||g===R||"object"===typeof g&&null!==g&&(g.$$typeof===J||g.$$typeof===k||g.$$typeof===p||g.$$typeof===y||g.$$typeof===S||g.$$typeof===v||g.$$typeof===H||g.$$typeof===N||g.$$typeof===Y)},b.typeOf=f,r.exports=b;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function w(){try{if(!Object.assign)return!1;var g=new String("abc");if(g[5]="de","5"===Object.getOwnPropertyNames(g)[0])return!1;for(var I={},C=0;C<10;C++)I["_"+String.fromCharCode(C)]=C;var e=Object.getOwnPropertyNames(I).map((function(g){return I[g]}));if("0123456789"!==e.join(""))return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach((function(g){l[g]=g})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},l)).join("")}catch(A){return!1}}w()&&Object.assign;var F="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function x(g,I,C,e,l){}Function.call.bind(Object.prototype.hasOwnProperty),x.resetWarningCache=function(){},r.exports;var z=F;function U(){}function Q(){}Q.resetWarningCache=U;var E=function(){function g(g,I,C,e,l,A){if(A!==z){var t=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw t.name="Invariant Violation",t}}function I(){return g}g.isRequired=g;var C={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:I,element:g,elementType:g,instanceOf:I,node:g,objectOf:I,oneOf:I,oneOfType:I,shape:I,exact:I,checkPropTypes:Q,resetWarningCache:U};return C.PropTypes=C,C};s.exports=E();var L=s.exports;function M(g,I){var C=atob(g);if(I){for(var e=new Uint8Array(C.length),l=0,A=C.length;l<A;++l)e[l]=C.charCodeAt(l);return String.fromCharCode.apply(null,new Uint16Array(e.buffer))}return C}function D(g,I,C){var e=void 0===I?null:I,l=M(g,void 0!==C&&C),A=l.indexOf("\n",10)+1,t=l.substring(A)+(e?"//# sourceMappingURL="+e:""),n=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(n)}function T(g,I,C){var e;return function(l){return e=e||D(g,I,C),new Worker(e,l)}}var j=T("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg==",null,!1),P=["constraints","onError","onLoad","onScan","resolution","qrArea"];function O(g,I){var C=Object.keys(g);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(g);I&&(e=e.filter((function(I){return Object.getOwnPropertyDescriptor(g,I).enumerable}))),C.push.apply(C,e)}return C}function q(g){for(var I=1;I<arguments.length;I++){var C=null!=arguments[I]?arguments[I]:{};I%2?O(Object(C),!0).forEach((function(I){l(g,I,C[I])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(C)):O(Object(C)).forEach((function(I){Object.defineProperty(g,I,Object.getOwnPropertyDescriptor(C,I))}))}return g}var _=function(){return new j},$=function(g){g&&(g.getVideoTracks&&g.getAudioTracks?(g.getVideoTracks().forEach((function(I){g.removeTrack(I),I.stop()})),g.getAudioTracks().forEach((function(I){g.removeTrack(I),I.stop()}))):g.stop())},gg=function(g){var I=g.constraints,l=g.onError,A=g.onLoad,t=g.onScan,n=g.resolution,o=g.qrArea,a=i(g,P),d=C.useRef(null),s=C.useRef(null),r=C.useRef(document.createElement("canvas")),b=C.useRef(null),m=C.useRef(),Z=c(C.useState(null),2),u=Z[0],G=Z[1],B=C.useRef(!1),h=C.useRef();C.useEffect((function(){h.current=_();var g=h.current;return g.onmessage=function(g){t&&t(g.data?q(q({},g.data),{},{canvas:r.current}):null),B.current=!1},function(){g.terminate()}}),[t]);var p=JSON.stringify(o),y=C.useCallback((function(){var g=JSON.parse(p),I=h.current,C=s.current&&s.current.readyState===s.current.HAVE_ENOUGH_DATA;if(!B.current&&C){B.current=!0;var e,l=s.current.videoWidth,A=s.current.videoHeight,t=l>A?l:A,o=Math.floor(n/t*100)/100;A=Math.floor(o*A),l=Math.floor(o*l),r.current.width=l,r.current.height=A,b.current=r.current.getContext("2d"),b.current.drawImage(s.current,0,0,l,A),e=g&&2===g.length&&g[0]>0&&g[1]>0?b.current.getImageData(Math.floor((l-g[0])/2),Math.floor((A-g[1])/2),g[0],g[1]):b.current.getImageData(0,0,l,A),I.postMessage(e)}m.current=requestAnimationFrame(y)}),[n,p]),W=JSON.stringify(I);return C.useEffect((function(){var g=JSON.parse(W),I=!0;return navigator.mediaDevices.getUserMedia(g).then((function(g){if(I){d.current=g;try{s.current&&(s.current.srcObject=g,s.current.setAttribute("playsinline",!0))}catch(C){G(window.URL.createObjectURL(g))}A&&A(),m.current=requestAnimationFrame(y)}else $(g)})).catch((function(g){return I?l(g):null})),function(){cancelAnimationFrame(m.current),I=!1,$(d.current),u&&window.URL.revokeObjectURL(u)}}),[y,W,l,A,u]),C.createElement("video",e({autoPlay:!0,playsInline:!0,src:u,ref:s},a))};return gg.propTypes={constraints:L.object,onError:L.func.isRequired,onLoad:L.func,onScan:L.func.isRequired,resolution:L.number,qrArea:L.array},gg.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]},gg}(C(2791))},6374:(g,I,C)=>{"use strict";var e=C(2791),l=Symbol.for("react.element"),A=Symbol.for("react.fragment"),t=Object.prototype.hasOwnProperty,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(g,I,C){var e,A={},a=null,c=null;for(e in void 0!==C&&(a=""+C),void 0!==I.key&&(a=""+I.key),void 0!==I.ref&&(c=I.ref),I)t.call(I,e)&&!o.hasOwnProperty(e)&&(A[e]=I[e]);if(g&&g.defaultProps)for(e in I=g.defaultProps)void 0===A[e]&&(A[e]=I[e]);return{$$typeof:l,type:g,key:a,ref:c,props:A,_owner:n.current}}I.Fragment=A,I.jsx=a,I.jsxs=a},9117:(g,I)=>{"use strict";var C=Symbol.for("react.element"),e=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),t=Symbol.for("react.profiler"),n=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),i=Symbol.for("react.lazy"),s=Symbol.iterator;var r={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,m={};function Z(g,I,C){this.props=g,this.context=I,this.refs=m,this.updater=C||r}function u(){}function G(g,I,C){this.props=g,this.context=I,this.refs=m,this.updater=C||r}Z.prototype.isReactComponent={},Z.prototype.setState=function(g,I){if("object"!==typeof g&&"function"!==typeof g&&null!=g)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,g,I,"setState")},Z.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")},u.prototype=Z.prototype;var B=G.prototype=new u;B.constructor=G,b(B,Z.prototype),B.isPureReactComponent=!0;var h=Array.isArray,p=Object.prototype.hasOwnProperty,y={current:null},W={key:!0,ref:!0,__self:!0,__source:!0};function V(g,I,e){var l,A={},t=null,n=null;if(null!=I)for(l in void 0!==I.ref&&(n=I.ref),void 0!==I.key&&(t=""+I.key),I)p.call(I,l)&&!W.hasOwnProperty(l)&&(A[l]=I[l]);var o=arguments.length-2;if(1===o)A.children=e;else if(1<o){for(var a=Array(o),c=0;c<o;c++)a[c]=arguments[c+2];A.children=a}if(g&&g.defaultProps)for(l in o=g.defaultProps)void 0===A[l]&&(A[l]=o[l]);return{$$typeof:C,type:g,key:t,ref:n,props:A,_owner:y.current}}function S(g){return"object"===typeof g&&null!==g&&g.$$typeof===C}var X=/\/+/g;function R(g,I){return"object"===typeof g&&null!==g&&null!=g.key?function(g){var I={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,(function(g){return I[g]}))}(""+g.key):I.toString(36)}function k(g,I,l,A,t){var n=typeof g;"undefined"!==n&&"boolean"!==n||(g=null);var o=!1;if(null===g)o=!0;else switch(n){case"string":case"number":o=!0;break;case"object":switch(g.$$typeof){case C:case e:o=!0}}if(o)return t=t(o=g),g=""===A?"."+R(o,0):A,h(t)?(l="",null!=g&&(l=g.replace(X,"$&/")+"/"),k(t,I,l,"",(function(g){return g}))):null!=t&&(S(t)&&(t=function(g,I){return{$$typeof:C,type:g.type,key:I,ref:g.ref,props:g.props,_owner:g._owner}}(t,l+(!t.key||o&&o.key===t.key?"":(""+t.key).replace(X,"$&/")+"/")+g)),I.push(t)),1;if(o=0,A=""===A?".":A+":",h(g))for(var a=0;a<g.length;a++){var c=A+R(n=g[a],a);o+=k(n,I,l,c,t)}else if(c=function(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=s&&g[s]||g["@@iterator"])?g:null}(g),"function"===typeof c)for(g=c.call(g),a=0;!(n=g.next()).done;)o+=k(n=n.value,I,l,c=A+R(n,a++),t);else if("object"===n)throw I=String(g),Error("Objects are not valid as a React child (found: "+("[object Object]"===I?"object with keys {"+Object.keys(g).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.");return o}function J(g,I,C){if(null==g)return g;var e=[],l=0;return k(g,e,"","",(function(g){return I.call(C,g,l++)})),e}function Y(g){if(-1===g._status){var I=g._result;(I=I()).then((function(I){0!==g._status&&-1!==g._status||(g._status=1,g._result=I)}),(function(I){0!==g._status&&-1!==g._status||(g._status=2,g._result=I)})),-1===g._status&&(g._status=0,g._result=I)}if(1===g._status)return g._result.default;throw g._result}var v={current:null},H={transition:null},N={ReactCurrentDispatcher:v,ReactCurrentBatchConfig:H,ReactCurrentOwner:y};I.Children={map:J,forEach:function(g,I,C){J(g,(function(){I.apply(this,arguments)}),C)},count:function(g){var I=0;return J(g,(function(){I++})),I},toArray:function(g){return J(g,(function(g){return g}))||[]},only:function(g){if(!S(g))throw Error("React.Children.only expected to receive a single React element child.");return g}},I.Component=Z,I.Fragment=l,I.Profiler=t,I.PureComponent=G,I.StrictMode=A,I.Suspense=c,I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,I.cloneElement=function(g,I,e){if(null===g||void 0===g)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+g+".");var l=b({},g.props),A=g.key,t=g.ref,n=g._owner;if(null!=I){if(void 0!==I.ref&&(t=I.ref,n=y.current),void 0!==I.key&&(A=""+I.key),g.type&&g.type.defaultProps)var o=g.type.defaultProps;for(a in I)p.call(I,a)&&!W.hasOwnProperty(a)&&(l[a]=void 0===I[a]&&void 0!==o?o[a]:I[a])}var a=arguments.length-2;if(1===a)l.children=e;else if(1<a){o=Array(a);for(var c=0;c<a;c++)o[c]=arguments[c+2];l.children=o}return{$$typeof:C,type:g.type,key:A,ref:t,props:l,_owner:n}},I.createContext=function(g){return(g={$$typeof:o,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:n,_context:g},g.Consumer=g},I.createElement=V,I.createFactory=function(g){var I=V.bind(null,g);return I.type=g,I},I.createRef=function(){return{current:null}},I.forwardRef=function(g){return{$$typeof:a,render:g}},I.isValidElement=S,I.lazy=function(g){return{$$typeof:i,_payload:{_status:-1,_result:g},_init:Y}},I.memo=function(g,I){return{$$typeof:d,type:g,compare:void 0===I?null:I}},I.startTransition=function(g){var I=H.transition;H.transition={};try{g()}finally{H.transition=I}},I.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},I.useCallback=function(g,I){return v.current.useCallback(g,I)},I.useContext=function(g){return v.current.useContext(g)},I.useDebugValue=function(){},I.useDeferredValue=function(g){return v.current.useDeferredValue(g)},I.useEffect=function(g,I){return v.current.useEffect(g,I)},I.useId=function(){return v.current.useId()},I.useImperativeHandle=function(g,I,C){return v.current.useImperativeHandle(g,I,C)},I.useInsertionEffect=function(g,I){return v.current.useInsertionEffect(g,I)},I.useLayoutEffect=function(g,I){return v.current.useLayoutEffect(g,I)},I.useMemo=function(g,I){return v.current.useMemo(g,I)},I.useReducer=function(g,I,C){return v.current.useReducer(g,I,C)},I.useRef=function(g){return v.current.useRef(g)},I.useState=function(g){return v.current.useState(g)},I.useSyncExternalStore=function(g,I,C){return v.current.useSyncExternalStore(g,I,C)},I.useTransition=function(){return v.current.useTransition()},I.version="18.2.0"},2791:(g,I,C)=>{"use strict";g.exports=C(9117)},184:(g,I,C)=>{"use strict";g.exports=C(6374)},6813:(g,I)=>{"use strict";function C(g,I){var C=g.length;g.push(I);g:for(;0<C;){var e=C-1>>>1,l=g[e];if(!(0<A(l,I)))break g;g[e]=I,g[C]=l,C=e}}function e(g){return 0===g.length?null:g[0]}function l(g){if(0===g.length)return null;var I=g[0],C=g.pop();if(C!==I){g[0]=C;g:for(var e=0,l=g.length,t=l>>>1;e<t;){var n=2*(e+1)-1,o=g[n],a=n+1,c=g[a];if(0>A(o,C))a<l&&0>A(c,o)?(g[e]=c,g[a]=C,e=a):(g[e]=o,g[n]=C,e=n);else{if(!(a<l&&0>A(c,C)))break g;g[e]=c,g[a]=C,e=a}}}return I}function A(g,I){var C=g.sortIndex-I.sortIndex;return 0!==C?C:g.id-I.id}if("object"===typeof performance&&"function"===typeof performance.now){var t=performance;I.unstable_now=function(){return t.now()}}else{var n=Date,o=n.now();I.unstable_now=function(){return n.now()-o}}var a=[],c=[],d=1,i=null,s=3,r=!1,b=!1,m=!1,Z="function"===typeof setTimeout?setTimeout:null,u="function"===typeof clearTimeout?clearTimeout:null,G="undefined"!==typeof setImmediate?setImmediate:null;function B(g){for(var I=e(c);null!==I;){if(null===I.callback)l(c);else{if(!(I.startTime<=g))break;l(c),I.sortIndex=I.expirationTime,C(a,I)}I=e(c)}}function h(g){if(m=!1,B(g),!b)if(null!==e(a))b=!0,H(p);else{var I=e(c);null!==I&&N(h,I.startTime-g)}}function p(g,C){b=!1,m&&(m=!1,u(S),S=-1),r=!0;var A=s;try{for(B(C),i=e(a);null!==i&&(!(i.expirationTime>C)||g&&!k());){var t=i.callback;if("function"===typeof t){i.callback=null,s=i.priorityLevel;var n=t(i.expirationTime<=C);C=I.unstable_now(),"function"===typeof n?i.callback=n:i===e(a)&&l(a),B(C)}else l(a);i=e(a)}if(null!==i)var o=!0;else{var d=e(c);null!==d&&N(h,d.startTime-C),o=!1}return o}finally{i=null,s=A,r=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var y,W=!1,V=null,S=-1,X=5,R=-1;function k(){return!(I.unstable_now()-R<X)}function J(){if(null!==V){var g=I.unstable_now();R=g;var C=!0;try{C=V(!0,g)}finally{C?y():(W=!1,V=null)}}else W=!1}if("function"===typeof G)y=function(){G(J)};else if("undefined"!==typeof MessageChannel){var Y=new MessageChannel,v=Y.port2;Y.port1.onmessage=J,y=function(){v.postMessage(null)}}else y=function(){Z(J,0)};function H(g){V=g,W||(W=!0,y())}function N(g,C){S=Z((function(){g(I.unstable_now())}),C)}I.unstable_IdlePriority=5,I.unstable_ImmediatePriority=1,I.unstable_LowPriority=4,I.unstable_NormalPriority=3,I.unstable_Profiling=null,I.unstable_UserBlockingPriority=2,I.unstable_cancelCallback=function(g){g.callback=null},I.unstable_continueExecution=function(){b||r||(b=!0,H(p))},I.unstable_forceFrameRate=function(g){0>g||125<g?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<g?Math.floor(1e3/g):5},I.unstable_getCurrentPriorityLevel=function(){return s},I.unstable_getFirstCallbackNode=function(){return e(a)},I.unstable_next=function(g){switch(s){case 1:case 2:case 3:var I=3;break;default:I=s}var C=s;s=I;try{return g()}finally{s=C}},I.unstable_pauseExecution=function(){},I.unstable_requestPaint=function(){},I.unstable_runWithPriority=function(g,I){switch(g){case 1:case 2:case 3:case 4:case 5:break;default:g=3}var C=s;s=g;try{return I()}finally{s=C}},I.unstable_scheduleCallback=function(g,l,A){var t=I.unstable_now();switch("object"===typeof A&&null!==A?A="number"===typeof(A=A.delay)&&0<A?t+A:t:A=t,g){case 1:var n=-1;break;case 2:n=250;break;case 5:n=1073741823;break;case 4:n=1e4;break;default:n=5e3}return g={id:d++,callback:l,priorityLevel:g,startTime:A,expirationTime:n=A+n,sortIndex:-1},A>t?(g.sortIndex=A,C(c,g),null===e(a)&&g===e(c)&&(m?(u(S),S=-1):m=!0,N(h,A-t))):(g.sortIndex=n,C(a,g),b||r||(b=!0,H(p))),g},I.unstable_shouldYield=k,I.unstable_wrapCallback=function(g){var I=s;return function(){var C=s;s=I;try{return g.apply(this,arguments)}finally{s=C}}}},5296:(g,I,C)=>{"use strict";g.exports=C(6813)},1561:(g,I,C)=>{"use strict";var e=C(2791);var l="function"===typeof Object.is?Object.is:function(g,I){return g===I&&(0!==g||1/g===1/I)||g!==g&&I!==I},A=e.useState,t=e.useEffect,n=e.useLayoutEffect,o=e.useDebugValue;function a(g){var I=g.getSnapshot;g=g.value;try{var C=I();return!l(g,C)}catch(e){return!0}}var c="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(g,I){return I()}:function(g,I){var C=I(),e=A({inst:{value:C,getSnapshot:I}}),l=e[0].inst,c=e[1];return n((function(){l.value=C,l.getSnapshot=I,a(l)&&c({inst:l})}),[g,C,I]),t((function(){return a(l)&&c({inst:l}),g((function(){a(l)&&c({inst:l})}))}),[g]),o(C),C};I.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:c},7595:(g,I,C)=>{"use strict";var e=C(2791),l=C(7248);var A="function"===typeof Object.is?Object.is:function(g,I){return g===I&&(0!==g||1/g===1/I)||g!==g&&I!==I},t=l.useSyncExternalStore,n=e.useRef,o=e.useEffect,a=e.useMemo,c=e.useDebugValue;I.useSyncExternalStoreWithSelector=function(g,I,C,e,l){var d=n(null);if(null===d.current){var i={hasValue:!1,value:null};d.current=i}else i=d.current;d=a((function(){function g(g){if(!o){if(o=!0,t=g,g=e(g),void 0!==l&&i.hasValue){var I=i.value;if(l(I,g))return n=I}return n=g}if(I=n,A(t,g))return I;var C=e(g);return void 0!==l&&l(I,C)?I:(t=g,n=C)}var t,n,o=!1,a=void 0===C?null:C;return[function(){return g(I())},null===a?void 0:function(){return g(a())}]}),[I,C,e,l]);var s=t(g,d[0],d[1]);return o((function(){i.hasValue=!0,i.value=s}),[s]),c(s),s}},7248:(g,I,C)=>{"use strict";g.exports=C(1561)},327:(g,I,C)=>{"use strict";g.exports=C(7595)},7399:g=>{g.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},2391:g=>{"use strict";var I=function(){};g.exports=I},2480:()=>{},1418:(g,I)=>{var C;!function(){"use strict";var e={}.hasOwnProperty;function l(){for(var g="",I=0;I<arguments.length;I++){var C=arguments[I];C&&(g=t(g,A(C)))}return g}function A(g){if("string"===typeof g||"number"===typeof g)return g;if("object"!==typeof g)return"";if(Array.isArray(g))return l.apply(null,g);if(g.toString!==Object.prototype.toString&&!g.toString.toString().includes("[native code]"))return g.toString();var I="";for(var C in g)e.call(g,C)&&g[C]&&(I=t(I,C));return I}function t(g,I){return I?g?g+" "+I:g+I:g}g.exports?(l.default=l,g.exports=l):void 0===(C=function(){return l}.apply(I,[]))||(g.exports=C)}()}},I={};function C(e){var l=I[e];if(void 0!==l)return l.exports;var A=I[e]={exports:{}};return g[e].call(A.exports,A,A.exports,C),A.exports}C.m=g,C.n=g=>{var I=g&&g.__esModule?()=>g.default:()=>g;return C.d(I,{a:I}),I},(()=>{var g,I=Object.getPrototypeOf?g=>Object.getPrototypeOf(g):g=>g.__proto__;C.t=function(e,l){if(1&l&&(e=this(e)),8&l)return e;if("object"===typeof e&&e){if(4&l&&e.__esModule)return e;if(16&l&&"function"===typeof e.then)return e}var A=Object.create(null);C.r(A);var t={};g=g||[null,I({}),I([]),I(I)];for(var n=2&l&&e;"object"==typeof n&&!~g.indexOf(n);n=I(n))Object.getOwnPropertyNames(n).forEach((g=>t[g]=()=>e[g]));return t.default=()=>e,C.d(A,t),A}})(),C.d=(g,I)=>{for(var e in I)C.o(I,e)&&!C.o(g,e)&&Object.defineProperty(g,e,{enumerable:!0,get:I[e]})},C.f={},C.e=g=>Promise.all(Object.keys(C.f).reduce(((I,e)=>(C.f[e](g,I),I)),[])),C.u=g=>"static/js/"+g+".e9f5506a.chunk.js",C.miniCssF=g=>{},C.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(g){if("object"===typeof window)return window}}(),C.o=(g,I)=>Object.prototype.hasOwnProperty.call(g,I),(()=>{var g={},I="dmrc-qr-ticket:";C.l=(e,l,A,t)=>{if(g[e])g[e].push(l);else{var n,o;if(void 0!==A)for(var a=document.getElementsByTagName("script"),c=0;c<a.length;c++){var d=a[c];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==I+A){n=d;break}}n||(o=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,C.nc&&n.setAttribute("nonce",C.nc),n.setAttribute("data-webpack",I+A),n.src=e),g[e]=[l];var i=(I,C)=>{n.onerror=n.onload=null,clearTimeout(s);var l=g[e];if(delete g[e],n.parentNode&&n.parentNode.removeChild(n),l&&l.forEach((g=>g(C))),I)return I(C)},s=setTimeout(i.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=i.bind(null,n.onerror),n.onload=i.bind(null,n.onload),o&&document.head.appendChild(n)}}})(),C.r=g=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},C.p="/",(()=>{var g={179:0};C.f.j=(I,e)=>{var l=C.o(g,I)?g[I]:void 0;if(0!==l)if(l)e.push(l[2]);else{var A=new Promise(((C,e)=>l=g[I]=[C,e]));e.push(l[2]=A);var t=C.p+C.u(I),n=new Error;C.l(t,(e=>{if(C.o(g,I)&&(0!==(l=g[I])&&(g[I]=void 0),l)){var A=e&&("load"===e.type?"missing":e.type),t=e&&e.target&&e.target.src;n.message="Loading chunk "+I+" failed.\n("+A+": "+t+")",n.name="ChunkLoadError",n.type=A,n.request=t,l[1](n)}}),"chunk-"+I,I)}};var I=(I,e)=>{var l,A,t=e[0],n=e[1],o=e[2],a=0;if(t.some((I=>0!==g[I]))){for(l in n)C.o(n,l)&&(C.m[l]=n[l]);if(o)o(C)}for(I&&I(e);a<t.length;a++)A=t[a],C.o(g,A)&&g[A]&&g[A][0](),g[A]=0},e=self.webpackChunkdmrc_qr_ticket=self.webpackChunkdmrc_qr_ticket||[];e.forEach(I.bind(null,0)),e.push=I.bind(null,e.push.bind(e))})(),(()=>{"use strict";var g=C(2791),I=C.t(g,2),e=C(1250),l=C(7248),A=C(327),t=C(4164),n=C.t(t,2);let o=function(g){g()};const a=()=>o,c=Symbol.for("react-redux-context"),d="undefined"!==typeof globalThis?globalThis:{};function i(){var I;if(!g.createContext)return{};const C=null!=(I=d[c])?I:d[c]=new Map;let e=C.get(g.createContext);return e||(e=g.createContext(null),C.set(g.createContext,e)),e}const s=i();function r(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return function(){return(0,g.useContext)(I)}}const b=r(),m=()=>{throw new Error("uSES not initialized!")};let Z=m;const u=(g,I)=>g===I;function G(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;const C=I===s?b:r(I);return function(I){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{equalityFn:l=u,stabilityCheck:A,noopCheck:t}="function"===typeof e?{equalityFn:e}:e;const{store:n,subscription:o,getServerState:a,stabilityCheck:c,noopCheck:d}=C(),i=((0,g.useRef)(!0),(0,g.useCallback)({[I.name]:g=>I(g)}[I.name],[I,c,A])),s=Z(o.addNestedSub,n.getState,a||n.getState,i,l);return(0,g.useDebugValue)(s),s}}const B=G();function h(){return h=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var C=arguments[I];for(var e in C)Object.prototype.hasOwnProperty.call(C,e)&&(g[e]=C[e])}return g},h.apply(this,arguments)}function p(g,I){if(null==g)return{};var C,e,l={},A=Object.keys(g);for(e=0;e<A.length;e++)C=A[e],I.indexOf(C)>=0||(l[C]=g[C]);return l}var y=C(2110),W=C.n(y),V=C(7441);const S=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function X(g,I,C,e,l){let A,t,n,o,a,{areStatesEqual:c,areOwnPropsEqual:d,areStatePropsEqual:i}=l,s=!1;function r(l,s){const r=!d(s,t),b=!c(l,A,s,t);return A=l,t=s,r&&b?(n=g(A,t),I.dependsOnOwnProps&&(o=I(e,t)),a=C(n,o,t),a):r?(g.dependsOnOwnProps&&(n=g(A,t)),I.dependsOnOwnProps&&(o=I(e,t)),a=C(n,o,t),a):b?function(){const I=g(A,t),e=!i(I,n);return n=I,e&&(a=C(n,o,t)),a}():a}return function(l,c){return s?r(l,c):(A=l,t=c,n=g(A,t),o=I(e,t),a=C(n,o,t),s=!0,a)}}function R(g){return function(I){const C=g(I);function e(){return C}return e.dependsOnOwnProps=!1,e}}function k(g){return g.dependsOnOwnProps?Boolean(g.dependsOnOwnProps):1!==g.length}function J(g,I){return function(I,C){let{displayName:e}=C;const l=function(g,I){return l.dependsOnOwnProps?l.mapToProps(g,I):l.mapToProps(g,void 0)};return l.dependsOnOwnProps=!0,l.mapToProps=function(I,C){l.mapToProps=g,l.dependsOnOwnProps=k(g);let e=l(I,C);return"function"===typeof e&&(l.mapToProps=e,l.dependsOnOwnProps=k(e),e=l(I,C)),e},l}}function Y(g,I){return(C,e)=>{throw new Error("Invalid value of type ".concat(typeof g," for ").concat(I," argument when connecting component ").concat(e.wrappedComponentName,"."))}}function v(g,I,C){return h({},C,g,I)}const H={notify(){},get:()=>[]};function N(g,I){let C,e=H,l=0,A=!1;function t(){c.onStateChange&&c.onStateChange()}function n(){l++,C||(C=I?I.addNestedSub(t):g.subscribe(t),e=function(){const g=a();let I=null,C=null;return{clear(){I=null,C=null},notify(){g((()=>{let g=I;for(;g;)g.callback(),g=g.next}))},get(){let g=[],C=I;for(;C;)g.push(C),C=C.next;return g},subscribe(g){let e=!0,l=C={callback:g,next:null,prev:C};return l.prev?l.prev.next=l:I=l,function(){e&&null!==I&&(e=!1,l.next?l.next.prev=l.prev:C=l.prev,l.prev?l.prev.next=l.next:I=l.next)}}}}())}function o(){l--,C&&0===l&&(C(),C=void 0,e.clear(),e=H)}const c={addNestedSub:function(g){n();const I=e.subscribe(g);let C=!1;return()=>{C||(C=!0,I(),o())}},notifyNestedSubs:function(){e.notify()},handleChangeWrapper:t,isSubscribed:function(){return A},trySubscribe:function(){A||(A=!0,n())},tryUnsubscribe:function(){A&&(A=!1,o())},getListeners:()=>e};return c}const f=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement)?g.useLayoutEffect:g.useEffect;function K(g,I){return g===I?0!==g||0!==I||1/g===1/I:g!==g&&I!==I}function w(g,I){if(K(g,I))return!0;if("object"!==typeof g||null===g||"object"!==typeof I||null===I)return!1;const C=Object.keys(g),e=Object.keys(I);if(C.length!==e.length)return!1;for(let l=0;l<C.length;l++)if(!Object.prototype.hasOwnProperty.call(I,C[l])||!K(g[C[l]],I[C[l]]))return!1;return!0}const F=["reactReduxForwardedRef"];let x=m;const z=[null,null];function U(g,I,C,e,l,A){g.current=e,C.current=!1,l.current&&(l.current=null,A())}function Q(g,I){return g===I}const E=function(I,C,e){let{pure:l,areStatesEqual:A=Q,areOwnPropsEqual:t=w,areStatePropsEqual:n=w,areMergedPropsEqual:o=w,forwardRef:a=!1,context:c=s}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const d=c,i=function(g){return g?"function"===typeof g?J(g):Y(g,"mapStateToProps"):R((()=>({})))}(I),r=function(g){return g&&"object"===typeof g?R((I=>function(g,I){const C={};for(const e in g){const l=g[e];"function"===typeof l&&(C[e]=function(){return I(l(...arguments))})}return C}(g,I))):g?"function"===typeof g?J(g):Y(g,"mapDispatchToProps"):R((g=>({dispatch:g})))}(C),b=function(g){return g?"function"===typeof g?function(g){return function(I,C){let e,{displayName:l,areMergedPropsEqual:A}=C,t=!1;return function(I,C,l){const n=g(I,C,l);return t?A(n,e)||(e=n):(t=!0,e=n),e}}}(g):Y(g,"mergeProps"):()=>v}(e),m=Boolean(I);return I=>{const C=I.displayName||I.name||"Component",e="Connect(".concat(C,")"),l={shouldHandleStateChanges:m,displayName:e,wrappedComponentName:C,WrappedComponent:I,initMapStateToProps:i,initMapDispatchToProps:r,initMergeProps:b,areStatesEqual:A,areStatePropsEqual:n,areOwnPropsEqual:t,areMergedPropsEqual:o};function c(C){const[e,A,t]=g.useMemo((()=>{const{reactReduxForwardedRef:g}=C,I=p(C,F);return[C.context,g,I]}),[C]),n=g.useMemo((()=>e&&e.Consumer&&(0,V.isContextConsumer)(g.createElement(e.Consumer,null))?e:d),[e,d]),o=g.useContext(n),a=Boolean(C.store)&&Boolean(C.store.getState)&&Boolean(C.store.dispatch),c=Boolean(o)&&Boolean(o.store);const i=a?C.store:o.store,s=c?o.getServerState:i.getState,r=g.useMemo((()=>function(g,I){let{initMapStateToProps:C,initMapDispatchToProps:e,initMergeProps:l}=I,A=p(I,S);return X(C(g,A),e(g,A),l(g,A),g,A)}(i.dispatch,l)),[i]),[b,Z]=g.useMemo((()=>{if(!m)return z;const g=N(i,a?void 0:o.subscription),I=g.notifyNestedSubs.bind(g);return[g,I]}),[i,a,o]),u=g.useMemo((()=>a?o:h({},o,{subscription:b})),[a,o,b]),G=g.useRef(),B=g.useRef(t),y=g.useRef(),W=g.useRef(!1),R=(g.useRef(!1),g.useRef(!1)),k=g.useRef();f((()=>(R.current=!0,()=>{R.current=!1})),[]);const J=g.useMemo((()=>()=>y.current&&t===B.current?y.current:r(i.getState(),t)),[i,t]),Y=g.useMemo((()=>g=>b?function(g,I,C,e,l,A,t,n,o,a,c){if(!g)return()=>{};let d=!1,i=null;const s=()=>{if(d||!n.current)return;const g=I.getState();let C,s;try{C=e(g,l.current)}catch(r){s=r,i=r}s||(i=null),C===A.current?t.current||a():(A.current=C,o.current=C,t.current=!0,c())};return C.onStateChange=s,C.trySubscribe(),s(),()=>{if(d=!0,C.tryUnsubscribe(),C.onStateChange=null,i)throw i}}(m,i,b,r,B,G,W,R,y,Z,g):()=>{}),[b]);var v,H,K;let w;v=U,H=[B,G,W,t,y,Z],f((()=>v(...H)),K);try{w=x(Y,J,s?()=>r(s(),t):J)}catch(E){throw k.current&&(E.message+="\nThe error may be correlated with this previous error:\n".concat(k.current.stack,"\n\n")),E}f((()=>{k.current=void 0,y.current=void 0,G.current=w}));const Q=g.useMemo((()=>g.createElement(I,h({},w,{ref:A}))),[A,I,w]);return g.useMemo((()=>m?g.createElement(n.Provider,{value:u},Q):Q),[n,Q,u])}const s=g.memo(c);if(s.WrappedComponent=I,s.displayName=c.displayName=e,a){const C=g.forwardRef((function(I,C){return g.createElement(s,h({},I,{reactReduxForwardedRef:C}))}));return C.displayName=e,C.WrappedComponent=I,W()(C,I)}return W()(s,I)}};const L=function(I){let{store:C,context:e,children:l,serverState:A,stabilityCheck:t="once",noopCheck:n="once"}=I;const o=g.useMemo((()=>{const g=N(C);return{store:C,subscription:g,getServerState:A?()=>A:void 0,stabilityCheck:t,noopCheck:n}}),[C,A,t,n]),a=g.useMemo((()=>C.getState()),[C]);f((()=>{const{subscription:g}=o;return g.onStateChange=g.notifyNestedSubs,g.trySubscribe(),a!==C.getState()&&g.notifyNestedSubs(),()=>{g.tryUnsubscribe(),g.onStateChange=void 0}}),[o,a]);const c=e||s;return g.createElement(c.Provider,{value:o},l)};function M(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;const I=g===s?b:r(g);return function(){const{store:g}=I();return g}}const D=M();function T(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;const I=g===s?D:M(g);return function(){return I().dispatch}}const j=T();var P,O;P=A.useSyncExternalStoreWithSelector,Z=P,(g=>{x=g})(l.useSyncExternalStore),O=t.unstable_batchedUpdates,o=O;const q=g=>{g&&g instanceof Function&&C.e(787).then(C.bind(C,787)).then((I=>{let{getCLS:C,getFID:e,getFCP:l,getLCP:A,getTTFB:t}=I;C(g),e(g),l(g),A(g),t(g)}))},_={type:"logger",log(g){this.output("log",g)},warn(g){this.output("warn",g)},error(g){this.output("error",g)},output(g,I){console&&console[g]&&console[g].apply(console,I)}};class ${constructor(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(g,I)}init(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=I.prefix||"i18next:",this.logger=g||_,this.options=I,this.debug=I.debug}log(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];return this.forward(I,"log","",!0)}warn(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];return this.forward(I,"warn","",!0)}error(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];return this.forward(I,"error","")}deprecate(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];return this.forward(I,"warn","WARNING DEPRECATED: ",!0)}forward(g,I,C,e){return e&&!this.debug?null:("string"===typeof g[0]&&(g[0]="".concat(C).concat(this.prefix," ").concat(g[0])),this.logger[I](g))}create(g){return new $(this.logger,{prefix:"".concat(this.prefix,":").concat(g,":"),...this.options})}clone(g){return(g=g||this.options).prefix=g.prefix||this.prefix,new $(this.logger,g)}}var gg=new $;class Ig{constructor(){this.observers={}}on(g,I){return g.split(" ").forEach((g=>{this.observers[g]||(this.observers[g]=new Map);const C=this.observers[g].get(I)||0;this.observers[g].set(I,C+1)})),this}off(g,I){this.observers[g]&&(I?this.observers[g].delete(I):delete this.observers[g])}emit(g){for(var I=arguments.length,C=new Array(I>1?I-1:0),e=1;e<I;e++)C[e-1]=arguments[e];if(this.observers[g]){Array.from(this.observers[g].entries()).forEach((g=>{let[I,e]=g;for(let l=0;l<e;l++)I(...C)}))}if(this.observers["*"]){Array.from(this.observers["*"].entries()).forEach((I=>{let[e,l]=I;for(let A=0;A<l;A++)e.apply(e,[g,...C])}))}}}function Cg(){let g,I;const C=new Promise(((C,e)=>{g=C,I=e}));return C.resolve=g,C.reject=I,C}function eg(g){return null==g?"":""+g}const lg=/###/g;function Ag(g,I,C){function e(g){return g&&g.indexOf("###")>-1?g.replace(lg,"."):g}function l(){return!g||"string"===typeof g}const A="string"!==typeof I?I:I.split(".");let t=0;for(;t<A.length-1;){if(l())return{};const I=e(A[t]);!g[I]&&C&&(g[I]=new C),g=Object.prototype.hasOwnProperty.call(g,I)?g[I]:{},++t}return l()?{}:{obj:g,k:e(A[t])}}function tg(g,I,C){const{obj:e,k:l}=Ag(g,I,Object);if(void 0!==e||1===I.length)return void(e[l]=C);let A=I[I.length-1],t=I.slice(0,I.length-1),n=Ag(g,t,Object);for(;void 0===n.obj&&t.length;)A="".concat(t[t.length-1],".").concat(A),t=t.slice(0,t.length-1),n=Ag(g,t,Object),n&&n.obj&&"undefined"!==typeof n.obj["".concat(n.k,".").concat(A)]&&(n.obj=void 0);n.obj["".concat(n.k,".").concat(A)]=C}function ng(g,I){const{obj:C,k:e}=Ag(g,I);if(C)return C[e]}function og(g,I,C){for(const e in I)"__proto__"!==e&&"constructor"!==e&&(e in g?"string"===typeof g[e]||g[e]instanceof String||"string"===typeof I[e]||I[e]instanceof String?C&&(g[e]=I[e]):og(g[e],I[e],C):g[e]=I[e]);return g}function ag(g){return g.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var cg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function dg(g){return"string"===typeof g?g.replace(/[&<>"'\/]/g,(g=>cg[g])):g}const ig=[" ",",","?","!",";"],sg=new class{constructor(g){this.capacity=g,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(g){const I=this.regExpMap.get(g);if(void 0!==I)return I;const C=new RegExp(g);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(g,C),this.regExpQueue.push(g),C}}(20);function rg(g,I){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!g)return;if(g[I])return g[I];const e=I.split(C);let l=g;for(let A=0;A<e.length;){if(!l||"object"!==typeof l)return;let g,I="";for(let t=A;t<e.length;++t)if(t!==A&&(I+=C),I+=e[t],g=l[I],void 0!==g){if(["string","number","boolean"].indexOf(typeof g)>-1&&t<e.length-1)continue;A+=t-A+1;break}l=g}return l}function bg(g){return g&&g.indexOf("_")>0?g.replace("_","-"):g}class mg extends Ig{constructor(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=g||{},this.options=I,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(g){this.options.ns.indexOf(g)<0&&this.options.ns.push(g)}removeNamespaces(g){const I=this.options.ns.indexOf(g);I>-1&&this.options.ns.splice(I,1)}getResource(g,I,C){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const l=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,A=void 0!==e.ignoreJSONStructure?e.ignoreJSONStructure:this.options.ignoreJSONStructure;let t;g.indexOf(".")>-1?t=g.split("."):(t=[g,I],C&&(Array.isArray(C)?t.push(...C):"string"===typeof C&&l?t.push(...C.split(l)):t.push(C)));const n=ng(this.data,t);return!n&&!I&&!C&&g.indexOf(".")>-1&&(g=t[0],I=t[1],C=t.slice(2).join(".")),n||!A||"string"!==typeof C?n:rg(this.data&&this.data[g]&&this.data[g][I],C,l)}addResource(g,I,C,e){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const A=void 0!==l.keySeparator?l.keySeparator:this.options.keySeparator;let t=[g,I];C&&(t=t.concat(A?C.split(A):C)),g.indexOf(".")>-1&&(t=g.split("."),e=I,I=t[1]),this.addNamespaces(I),tg(this.data,t,e),l.silent||this.emit("added",g,I,C,e)}addResources(g,I,C){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const l in C)"string"!==typeof C[l]&&"[object Array]"!==Object.prototype.toString.apply(C[l])||this.addResource(g,I,l,C[l],{silent:!0});e.silent||this.emit("added",g,I,C)}addResourceBundle(g,I,C,e,l){let A=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},t=[g,I];g.indexOf(".")>-1&&(t=g.split("."),e=C,C=I,I=t[1]),this.addNamespaces(I);let n=ng(this.data,t)||{};e?og(n,C,l):n={...n,...C},tg(this.data,t,n),A.silent||this.emit("added",g,I,C)}removeResourceBundle(g,I){this.hasResourceBundle(g,I)&&delete this.data[g][I],this.removeNamespaces(I),this.emit("removed",g,I)}hasResourceBundle(g,I){return void 0!==this.getResource(g,I)}getResourceBundle(g,I){return I||(I=this.options.defaultNS),"v1"===this.options.compatibilityAPI?{...this.getResource(g,I)}:this.getResource(g,I)}getDataByLanguage(g){return this.data[g]}hasLanguageSomeTranslations(g){const I=this.getDataByLanguage(g);return!!(I&&Object.keys(I)||[]).find((g=>I[g]&&Object.keys(I[g]).length>0))}toJSON(){return this.data}}var Zg={processors:{},addPostProcessor(g){this.processors[g.name]=g},handle(g,I,C,e,l){return g.forEach((g=>{this.processors[g]&&(I=this.processors[g].process(I,C,e,l))})),I}};const ug={};class Gg extends Ig{constructor(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),function(g,I,C){g.forEach((g=>{I[g]&&(C[g]=I[g])}))}(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],g,this),this.options=I,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=gg.create("translator")}changeLanguage(g){g&&(this.language=g)}exists(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(void 0===g||null===g)return!1;const C=this.resolve(g,I);return C&&void 0!==C.res}extractFromKey(g,I){let C=void 0!==I.nsSeparator?I.nsSeparator:this.options.nsSeparator;void 0===C&&(C=":");const e=void 0!==I.keySeparator?I.keySeparator:this.options.keySeparator;let l=I.ns||this.options.defaultNS||[];const A=C&&g.indexOf(C)>-1,t=!this.options.userDefinedKeySeparator&&!I.keySeparator&&!this.options.userDefinedNsSeparator&&!I.nsSeparator&&!function(g,I,C){I=I||"",C=C||"";const e=ig.filter((g=>I.indexOf(g)<0&&C.indexOf(g)<0));if(0===e.length)return!0;const l=sg.getRegExp("(".concat(e.map((g=>"?"===g?"\\?":g)).join("|"),")"));let A=!l.test(g);if(!A){const I=g.indexOf(C);I>0&&!l.test(g.substring(0,I))&&(A=!0)}return A}(g,C,e);if(A&&!t){const I=g.match(this.interpolator.nestingRegexp);if(I&&I.length>0)return{key:g,namespaces:l};const A=g.split(C);(C!==e||C===e&&this.options.ns.indexOf(A[0])>-1)&&(l=A.shift()),g=A.join(e)}return"string"===typeof l&&(l=[l]),{key:g,namespaces:l}}translate(g,I,C){if("object"!==typeof I&&this.options.overloadTranslationOptionHandler&&(I=this.options.overloadTranslationOptionHandler(arguments)),"object"===typeof I&&(I={...I}),I||(I={}),void 0===g||null===g)return"";Array.isArray(g)||(g=[String(g)]);const e=void 0!==I.returnDetails?I.returnDetails:this.options.returnDetails,l=void 0!==I.keySeparator?I.keySeparator:this.options.keySeparator,{key:A,namespaces:t}=this.extractFromKey(g[g.length-1],I),n=t[t.length-1],o=I.lng||this.language,a=I.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(o&&"cimode"===o.toLowerCase()){if(a){const g=I.nsSeparator||this.options.nsSeparator;return e?{res:"".concat(n).concat(g).concat(A),usedKey:A,exactUsedKey:A,usedLng:o,usedNS:n,usedParams:this.getUsedParamsDetails(I)}:"".concat(n).concat(g).concat(A)}return e?{res:A,usedKey:A,exactUsedKey:A,usedLng:o,usedNS:n,usedParams:this.getUsedParamsDetails(I)}:A}const c=this.resolve(g,I);let d=c&&c.res;const i=c&&c.usedKey||A,s=c&&c.exactUsedKey||A,r=Object.prototype.toString.apply(d),b=void 0!==I.joinArrays?I.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject;if(m&&d&&("string"!==typeof d&&"boolean"!==typeof d&&"number"!==typeof d)&&["[object Number]","[object Function]","[object RegExp]"].indexOf(r)<0&&("string"!==typeof b||"[object Array]"!==r)){if(!I.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const g=this.options.returnedObjectHandler?this.options.returnedObjectHandler(i,d,{...I,ns:t}):"key '".concat(A," (").concat(this.language,")' returned an object instead of string.");return e?(c.res=g,c.usedParams=this.getUsedParamsDetails(I),c):g}if(l){const g="[object Array]"===r,C=g?[]:{},e=g?s:i;for(const A in d)if(Object.prototype.hasOwnProperty.call(d,A)){const g="".concat(e).concat(l).concat(A);C[A]=this.translate(g,{...I,joinArrays:!1,ns:t}),C[A]===g&&(C[A]=d[A])}d=C}}else if(m&&"string"===typeof b&&"[object Array]"===r)d=d.join(b),d&&(d=this.extendTranslation(d,g,I,C));else{let e=!1,t=!1;const a=void 0!==I.count&&"string"!==typeof I.count,i=Gg.hasDefaultValue(I),s=a?this.pluralResolver.getSuffix(o,I.count,I):"",r=I.ordinal&&a?this.pluralResolver.getSuffix(o,I.count,{ordinal:!1}):"",b=a&&!I.ordinal&&0===I.count&&this.pluralResolver.shouldUseIntlApi(),m=b&&I["defaultValue".concat(this.options.pluralSeparator,"zero")]||I["defaultValue".concat(s)]||I["defaultValue".concat(r)]||I.defaultValue;!this.isValidLookup(d)&&i&&(e=!0,d=m),this.isValidLookup(d)||(t=!0,d=A);const Z=(I.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&t?void 0:d,u=i&&m!==d&&this.options.updateMissing;if(t||e||u){if(this.logger.log(u?"updateKey":"missingKey",o,n,A,u?m:d),l){const g=this.resolve(A,{...I,keySeparator:!1});g&&g.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let g=[];const C=this.languageUtils.getFallbackCodes(this.options.fallbackLng,I.lng||this.language);if("fallback"===this.options.saveMissingTo&&C&&C[0])for(let I=0;I<C.length;I++)g.push(C[I]);else"all"===this.options.saveMissingTo?g=this.languageUtils.toResolveHierarchy(I.lng||this.language):g.push(I.lng||this.language);const e=(g,C,e)=>{const l=i&&e!==d?e:Z;this.options.missingKeyHandler?this.options.missingKeyHandler(g,n,C,l,u,I):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(g,n,C,l,u,I),this.emit("missingKey",g,n,C,d)};this.options.saveMissing&&(this.options.saveMissingPlurals&&a?g.forEach((g=>{const C=this.pluralResolver.getSuffixes(g,I);b&&I["defaultValue".concat(this.options.pluralSeparator,"zero")]&&C.indexOf("".concat(this.options.pluralSeparator,"zero"))<0&&C.push("".concat(this.options.pluralSeparator,"zero")),C.forEach((C=>{e([g],A+C,I["defaultValue".concat(C)]||m)}))})):e(g,A,m))}d=this.extendTranslation(d,g,I,c,C),t&&d===A&&this.options.appendNamespaceToMissingKey&&(d="".concat(n,":").concat(A)),(t||e)&&this.options.parseMissingKeyHandler&&(d="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(n,":").concat(A):A,e?d:void 0):this.options.parseMissingKeyHandler(d))}return e?(c.res=d,c.usedParams=this.getUsedParamsDetails(I),c):d}extendTranslation(g,I,C,e,l){var A=this;if(this.i18nFormat&&this.i18nFormat.parse)g=this.i18nFormat.parse(g,{...this.options.interpolation.defaultVariables,...C},C.lng||this.language||e.usedLng,e.usedNS,e.usedKey,{resolved:e});else if(!C.skipInterpolation){C.interpolation&&this.interpolator.init({...C,interpolation:{...this.options.interpolation,...C.interpolation}});const t="string"===typeof g&&(C&&C.interpolation&&void 0!==C.interpolation.skipOnVariables?C.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let n;if(t){const I=g.match(this.interpolator.nestingRegexp);n=I&&I.length}let o=C.replace&&"string"!==typeof C.replace?C.replace:C;if(this.options.interpolation.defaultVariables&&(o={...this.options.interpolation.defaultVariables,...o}),g=this.interpolator.interpolate(g,o,C.lng||this.language,C),t){const I=g.match(this.interpolator.nestingRegexp);n<(I&&I.length)&&(C.nest=!1)}!C.lng&&"v1"!==this.options.compatibilityAPI&&e&&e.res&&(C.lng=e.usedLng),!1!==C.nest&&(g=this.interpolator.nest(g,(function(){for(var g=arguments.length,e=new Array(g),t=0;t<g;t++)e[t]=arguments[t];return l&&l[0]===e[0]&&!C.context?(A.logger.warn("It seems you are nesting recursively key: ".concat(e[0]," in key: ").concat(I[0])),null):A.translate(...e,I)}),C)),C.interpolation&&this.interpolator.reset()}const t=C.postProcess||this.options.postProcess,n="string"===typeof t?[t]:t;return void 0!==g&&null!==g&&n&&n.length&&!1!==C.applyPostProcessor&&(g=Zg.handle(n,g,I,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...e,usedParams:this.getUsedParamsDetails(C)},...C}:C,this)),g}resolve(g){let I,C,e,l,A,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"===typeof g&&(g=[g]),g.forEach((g=>{if(this.isValidLookup(I))return;const n=this.extractFromKey(g,t),o=n.key;C=o;let a=n.namespaces;this.options.fallbackNS&&(a=a.concat(this.options.fallbackNS));const c=void 0!==t.count&&"string"!==typeof t.count,d=c&&!t.ordinal&&0===t.count&&this.pluralResolver.shouldUseIntlApi(),i=void 0!==t.context&&("string"===typeof t.context||"number"===typeof t.context)&&""!==t.context,s=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);a.forEach((g=>{this.isValidLookup(I)||(A=g,!ug["".concat(s[0],"-").concat(g)]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(A)&&(ug["".concat(s[0],"-").concat(g)]=!0,this.logger.warn('key "'.concat(C,'" for languages "').concat(s.join(", "),'" won\'t get resolved as namespace "').concat(A,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),s.forEach((C=>{if(this.isValidLookup(I))return;l=C;const A=[o];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(A,o,C,g,t);else{let g;c&&(g=this.pluralResolver.getSuffix(C,t.count,t));const I="".concat(this.options.pluralSeparator,"zero"),e="".concat(this.options.pluralSeparator,"ordinal").concat(this.options.pluralSeparator);if(c&&(A.push(o+g),t.ordinal&&0===g.indexOf(e)&&A.push(o+g.replace(e,this.options.pluralSeparator)),d&&A.push(o+I)),i){const C="".concat(o).concat(this.options.contextSeparator).concat(t.context);A.push(C),c&&(A.push(C+g),t.ordinal&&0===g.indexOf(e)&&A.push(C+g.replace(e,this.options.pluralSeparator)),d&&A.push(C+I))}}let n;for(;n=A.pop();)this.isValidLookup(I)||(e=n,I=this.getResource(C,g,n,t))})))}))})),{res:I,usedKey:C,exactUsedKey:e,usedLng:l,usedNS:A}}isValidLookup(g){return void 0!==g&&!(!this.options.returnNull&&null===g)&&!(!this.options.returnEmptyString&&""===g)}getResource(g,I,C){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(g,I,C,e):this.resourceStore.getResource(g,I,C,e)}getUsedParamsDetails(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const I=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],C=g.replace&&"string"!==typeof g.replace;let e=C?g.replace:g;if(C&&"undefined"!==typeof g.count&&(e.count=g.count),this.options.interpolation.defaultVariables&&(e={...this.options.interpolation.defaultVariables,...e}),!C){e={...e};for(const g of I)delete e[g]}return e}static hasDefaultValue(g){const I="defaultValue";for(const C in g)if(Object.prototype.hasOwnProperty.call(g,C)&&I===C.substring(0,12)&&void 0!==g[C])return!0;return!1}}function Bg(g){return g.charAt(0).toUpperCase()+g.slice(1)}class hg{constructor(g){this.options=g,this.supportedLngs=this.options.supportedLngs||!1,this.logger=gg.create("languageUtils")}getScriptPartFromCode(g){if(!(g=bg(g))||g.indexOf("-")<0)return null;const I=g.split("-");return 2===I.length?null:(I.pop(),"x"===I[I.length-1].toLowerCase()?null:this.formatLanguageCode(I.join("-")))}getLanguagePartFromCode(g){if(!(g=bg(g))||g.indexOf("-")<0)return g;const I=g.split("-");return this.formatLanguageCode(I[0])}formatLanguageCode(g){if("string"===typeof g&&g.indexOf("-")>-1){const I=["hans","hant","latn","cyrl","cans","mong","arab"];let C=g.split("-");return this.options.lowerCaseLng?C=C.map((g=>g.toLowerCase())):2===C.length?(C[0]=C[0].toLowerCase(),C[1]=C[1].toUpperCase(),I.indexOf(C[1].toLowerCase())>-1&&(C[1]=Bg(C[1].toLowerCase()))):3===C.length&&(C[0]=C[0].toLowerCase(),2===C[1].length&&(C[1]=C[1].toUpperCase()),"sgn"!==C[0]&&2===C[2].length&&(C[2]=C[2].toUpperCase()),I.indexOf(C[1].toLowerCase())>-1&&(C[1]=Bg(C[1].toLowerCase())),I.indexOf(C[2].toLowerCase())>-1&&(C[2]=Bg(C[2].toLowerCase()))),C.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?g.toLowerCase():g}isSupportedCode(g){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(g=this.getLanguagePartFromCode(g)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(g)>-1}getBestMatchFromCodes(g){if(!g)return null;let I;return g.forEach((g=>{if(I)return;const C=this.formatLanguageCode(g);this.options.supportedLngs&&!this.isSupportedCode(C)||(I=C)})),!I&&this.options.supportedLngs&&g.forEach((g=>{if(I)return;const C=this.getLanguagePartFromCode(g);if(this.isSupportedCode(C))return I=C;I=this.options.supportedLngs.find((g=>g===C?g:g.indexOf("-")<0&&C.indexOf("-")<0?void 0:0===g.indexOf(C)?g:void 0))})),I||(I=this.getFallbackCodes(this.options.fallbackLng)[0]),I}getFallbackCodes(g,I){if(!g)return[];if("function"===typeof g&&(g=g(I)),"string"===typeof g&&(g=[g]),"[object Array]"===Object.prototype.toString.apply(g))return g;if(!I)return g.default||[];let C=g[I];return C||(C=g[this.getScriptPartFromCode(I)]),C||(C=g[this.formatLanguageCode(I)]),C||(C=g[this.getLanguagePartFromCode(I)]),C||(C=g.default),C||[]}toResolveHierarchy(g,I){const C=this.getFallbackCodes(I||this.options.fallbackLng||[],g),e=[],l=g=>{g&&(this.isSupportedCode(g)?e.push(g):this.logger.warn("rejecting language code not found in supportedLngs: ".concat(g)))};return"string"===typeof g&&(g.indexOf("-")>-1||g.indexOf("_")>-1)?("languageOnly"!==this.options.load&&l(this.formatLanguageCode(g)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&l(this.getScriptPartFromCode(g)),"currentOnly"!==this.options.load&&l(this.getLanguagePartFromCode(g))):"string"===typeof g&&l(this.formatLanguageCode(g)),C.forEach((g=>{e.indexOf(g)<0&&l(this.formatLanguageCode(g))})),e}}let pg=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],yg={1:function(g){return Number(g>1)},2:function(g){return Number(1!=g)},3:function(g){return 0},4:function(g){return Number(g%10==1&&g%100!=11?0:g%10>=2&&g%10<=4&&(g%100<10||g%100>=20)?1:2)},5:function(g){return Number(0==g?0:1==g?1:2==g?2:g%100>=3&&g%100<=10?3:g%100>=11?4:5)},6:function(g){return Number(1==g?0:g>=2&&g<=4?1:2)},7:function(g){return Number(1==g?0:g%10>=2&&g%10<=4&&(g%100<10||g%100>=20)?1:2)},8:function(g){return Number(1==g?0:2==g?1:8!=g&&11!=g?2:3)},9:function(g){return Number(g>=2)},10:function(g){return Number(1==g?0:2==g?1:g<7?2:g<11?3:4)},11:function(g){return Number(1==g||11==g?0:2==g||12==g?1:g>2&&g<20?2:3)},12:function(g){return Number(g%10!=1||g%100==11)},13:function(g){return Number(0!==g)},14:function(g){return Number(1==g?0:2==g?1:3==g?2:3)},15:function(g){return Number(g%10==1&&g%100!=11?0:g%10>=2&&(g%100<10||g%100>=20)?1:2)},16:function(g){return Number(g%10==1&&g%100!=11?0:0!==g?1:2)},17:function(g){return Number(1==g||g%10==1&&g%100!=11?0:1)},18:function(g){return Number(0==g?0:1==g?1:2)},19:function(g){return Number(1==g?0:0==g||g%100>1&&g%100<11?1:g%100>10&&g%100<20?2:3)},20:function(g){return Number(1==g?0:0==g||g%100>0&&g%100<20?1:2)},21:function(g){return Number(g%100==1?1:g%100==2?2:g%100==3||g%100==4?3:0)},22:function(g){return Number(1==g?0:2==g?1:(g<0||g>10)&&g%10==0?2:3)}};const Wg=["v1","v2","v3"],Vg=["v4"],Sg={zero:0,one:1,two:2,few:3,many:4,other:5};class Xg{constructor(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=g,this.options=I,this.logger=gg.create("pluralResolver"),this.options.compatibilityJSON&&!Vg.includes(this.options.compatibilityJSON)||"undefined"!==typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=function(){const g={};return pg.forEach((I=>{I.lngs.forEach((C=>{g[C]={numbers:I.nr,plurals:yg[I.fc]}}))})),g}()}addRule(g,I){this.rules[g]=I}getRule(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(bg("dev"===g?"en":g),{type:I.ordinal?"ordinal":"cardinal"})}catch(C){return}return this.rules[g]||this.rules[this.languageUtils.getLanguagePartFromCode(g)]}needsPlural(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const C=this.getRule(g,I);return this.shouldUseIntlApi()?C&&C.resolvedOptions().pluralCategories.length>1:C&&C.numbers.length>1}getPluralFormsOfKey(g,I){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(g,C).map((g=>"".concat(I).concat(g)))}getSuffixes(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const C=this.getRule(g,I);return C?this.shouldUseIntlApi()?C.resolvedOptions().pluralCategories.sort(((g,I)=>Sg[g]-Sg[I])).map((g=>"".concat(this.options.prepend).concat(I.ordinal?"ordinal".concat(this.options.prepend):"").concat(g))):C.numbers.map((C=>this.getSuffix(g,C,I))):[]}getSuffix(g,I){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const e=this.getRule(g,C);return e?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(C.ordinal?"ordinal".concat(this.options.prepend):"").concat(e.select(I)):this.getSuffixRetroCompatible(e,I):(this.logger.warn("no plural rule found for: ".concat(g)),"")}getSuffixRetroCompatible(g,I){const C=g.noAbs?g.plurals(I):g.plurals(Math.abs(I));let e=g.numbers[C];this.options.simplifyPluralSuffix&&2===g.numbers.length&&1===g.numbers[0]&&(2===e?e="plural":1===e&&(e=""));const l=()=>this.options.prepend&&e.toString()?this.options.prepend+e.toString():e.toString();return"v1"===this.options.compatibilityJSON?1===e?"":"number"===typeof e?"_plural_".concat(e.toString()):l():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===g.numbers.length&&1===g.numbers[0]?l():this.options.prepend&&C.toString()?this.options.prepend+C.toString():C.toString()}shouldUseIntlApi(){return!Wg.includes(this.options.compatibilityJSON)}}function Rg(g,I,C){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",l=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],A=function(g,I,C){const e=ng(g,C);return void 0!==e?e:ng(I,C)}(g,I,C);return!A&&l&&"string"===typeof C&&(A=rg(g,C,e),void 0===A&&(A=rg(I,C,e))),A}class kg{constructor(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=gg.create("interpolator"),this.options=g,this.format=g.interpolation&&g.interpolation.format||(g=>g),this.init(g)}init(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g.interpolation||(g.interpolation={escapeValue:!0});const I=g.interpolation;this.escape=void 0!==I.escape?I.escape:dg,this.escapeValue=void 0===I.escapeValue||I.escapeValue,this.useRawValueToEscape=void 0!==I.useRawValueToEscape&&I.useRawValueToEscape,this.prefix=I.prefix?ag(I.prefix):I.prefixEscaped||"{{",this.suffix=I.suffix?ag(I.suffix):I.suffixEscaped||"}}",this.formatSeparator=I.formatSeparator?I.formatSeparator:I.formatSeparator||",",this.unescapePrefix=I.unescapeSuffix?"":I.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":I.unescapeSuffix||"",this.nestingPrefix=I.nestingPrefix?ag(I.nestingPrefix):I.nestingPrefixEscaped||ag("$t("),this.nestingSuffix=I.nestingSuffix?ag(I.nestingSuffix):I.nestingSuffixEscaped||ag(")"),this.nestingOptionsSeparator=I.nestingOptionsSeparator?I.nestingOptionsSeparator:I.nestingOptionsSeparator||",",this.maxReplaces=I.maxReplaces?I.maxReplaces:1e3,this.alwaysFormat=void 0!==I.alwaysFormat&&I.alwaysFormat,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const g=(g,I)=>g&&g.source===I?(g.lastIndex=0,g):new RegExp(I,"g");this.regexp=g(this.regexp,"".concat(this.prefix,"(.+?)").concat(this.suffix)),this.regexpUnescape=g(this.regexpUnescape,"".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix)),this.nestingRegexp=g(this.nestingRegexp,"".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix))}interpolate(g,I,C,e){let l,A,t;const n=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function o(g){return g.replace(/\$/g,"$$$$")}const a=g=>{if(g.indexOf(this.formatSeparator)<0){const l=Rg(I,n,g,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(l,void 0,C,{...e,...I,interpolationkey:g}):l}const l=g.split(this.formatSeparator),A=l.shift().trim(),t=l.join(this.formatSeparator).trim();return this.format(Rg(I,n,A,this.options.keySeparator,this.options.ignoreJSONStructure),t,C,{...e,...I,interpolationkey:A})};this.resetRegExp();const c=e&&e.missingInterpolationHandler||this.options.missingInterpolationHandler,d=e&&e.interpolation&&void 0!==e.interpolation.skipOnVariables?e.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:g=>o(g)},{regex:this.regexp,safeValue:g=>this.escapeValue?o(this.escape(g)):o(g)}].forEach((I=>{for(t=0;l=I.regex.exec(g);){const C=l[1].trim();if(A=a(C),void 0===A)if("function"===typeof c){const I=c(g,l,e);A="string"===typeof I?I:""}else if(e&&Object.prototype.hasOwnProperty.call(e,C))A="";else{if(d){A=l[0];continue}this.logger.warn("missed to pass in variable ".concat(C," for interpolating ").concat(g)),A=""}else"string"===typeof A||this.useRawValueToEscape||(A=eg(A));const n=I.safeValue(A);if(g=g.replace(l[0],n),d?(I.regex.lastIndex+=A.length,I.regex.lastIndex-=l[0].length):I.regex.lastIndex=0,t++,t>=this.maxReplaces)break}})),g}nest(g,I){let C,e,l,A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};function t(g,I){const C=this.nestingOptionsSeparator;if(g.indexOf(C)<0)return g;const e=g.split(new RegExp("".concat(C,"[ ]*{")));let A="{".concat(e[1]);g=e[0],A=this.interpolate(A,l);const t=A.match(/'/g),n=A.match(/"/g);(t&&t.length%2===0&&!n||n.length%2!==0)&&(A=A.replace(/'/g,'"'));try{l=JSON.parse(A),I&&(l={...I,...l})}catch(o){return this.logger.warn("failed parsing options string in nesting for key ".concat(g),o),"".concat(g).concat(C).concat(A)}return delete l.defaultValue,g}for(;C=this.nestingRegexp.exec(g);){let n=[];l={...A},l=l.replace&&"string"!==typeof l.replace?l.replace:l,l.applyPostProcessor=!1,delete l.defaultValue;let o=!1;if(-1!==C[0].indexOf(this.formatSeparator)&&!/{.*}/.test(C[1])){const g=C[1].split(this.formatSeparator).map((g=>g.trim()));C[1]=g.shift(),n=g,o=!0}if(e=I(t.call(this,C[1].trim(),l),l),e&&C[0]===g&&"string"!==typeof e)return e;"string"!==typeof e&&(e=eg(e)),e||(this.logger.warn("missed to resolve ".concat(C[1]," for nesting ").concat(g)),e=""),o&&(e=n.reduce(((g,I)=>this.format(g,I,A.lng,{...A,interpolationkey:C[1].trim()})),e.trim())),g=g.replace(C[0],e),this.regexp.lastIndex=0}return g}}function Jg(g){const I={};return function(C,e,l){const A=e+JSON.stringify(l);let t=I[A];return t||(t=g(bg(e),l),I[A]=t),t(C)}}class Yg{constructor(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=gg.create("formatter"),this.options=g,this.formats={number:Jg(((g,I)=>{const C=new Intl.NumberFormat(g,{...I});return g=>C.format(g)})),currency:Jg(((g,I)=>{const C=new Intl.NumberFormat(g,{...I,style:"currency"});return g=>C.format(g)})),datetime:Jg(((g,I)=>{const C=new Intl.DateTimeFormat(g,{...I});return g=>C.format(g)})),relativetime:Jg(((g,I)=>{const C=new Intl.RelativeTimeFormat(g,{...I});return g=>C.format(g,I.range||"day")})),list:Jg(((g,I)=>{const C=new Intl.ListFormat(g,{...I});return g=>C.format(g)}))},this.init(g)}init(g){const I=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=I.formatSeparator?I.formatSeparator:I.formatSeparator||","}add(g,I){this.formats[g.toLowerCase().trim()]=I}addCached(g,I){this.formats[g.toLowerCase().trim()]=Jg(I)}format(g,I,C){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return I.split(this.formatSeparator).reduce(((g,I)=>{const{formatName:l,formatOptions:A}=function(g){let I=g.toLowerCase().trim();const C={};if(g.indexOf("(")>-1){const e=g.split("(");I=e[0].toLowerCase().trim();const l=e[1].substring(0,e[1].length-1);"currency"===I&&l.indexOf(":")<0?C.currency||(C.currency=l.trim()):"relativetime"===I&&l.indexOf(":")<0?C.range||(C.range=l.trim()):l.split(";").forEach((g=>{if(!g)return;const[I,...e]=g.split(":"),l=e.join(":").trim().replace(/^'+|'+$/g,"");C[I.trim()]||(C[I.trim()]=l),"false"===l&&(C[I.trim()]=!1),"true"===l&&(C[I.trim()]=!0),isNaN(l)||(C[I.trim()]=parseInt(l,10))}))}return{formatName:I,formatOptions:C}}(I);if(this.formats[l]){let I=g;try{const t=e&&e.formatParams&&e.formatParams[e.interpolationkey]||{},n=t.locale||t.lng||e.locale||e.lng||C;I=this.formats[l](g,n,{...A,...e,...t})}catch(t){this.logger.warn(t)}return I}return this.logger.warn("there was no format function for ".concat(l)),g}),g)}}class vg extends Ig{constructor(g,I,C){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=g,this.store=I,this.services=C,this.languageUtils=C.languageUtils,this.options=e,this.logger=gg.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=e.maxParallelReads||10,this.readingCalls=0,this.maxRetries=e.maxRetries>=0?e.maxRetries:5,this.retryTimeout=e.retryTimeout>=1?e.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(C,e.backend,e)}queueLoad(g,I,C,e){const l={},A={},t={},n={};return g.forEach((g=>{let e=!0;I.forEach((I=>{const t="".concat(g,"|").concat(I);!C.reload&&this.store.hasResourceBundle(g,I)?this.state[t]=2:this.state[t]<0||(1===this.state[t]?void 0===A[t]&&(A[t]=!0):(this.state[t]=1,e=!1,void 0===A[t]&&(A[t]=!0),void 0===l[t]&&(l[t]=!0),void 0===n[I]&&(n[I]=!0)))})),e||(t[g]=!0)})),(Object.keys(l).length||Object.keys(A).length)&&this.queue.push({pending:A,pendingCount:Object.keys(A).length,loaded:{},errors:[],callback:e}),{toLoad:Object.keys(l),pending:Object.keys(A),toLoadLanguages:Object.keys(t),toLoadNamespaces:Object.keys(n)}}loaded(g,I,C){const e=g.split("|"),l=e[0],A=e[1];I&&this.emit("failedLoading",l,A,I),C&&this.store.addResourceBundle(l,A,C),this.state[g]=I?-1:2;const t={};this.queue.forEach((C=>{!function(g,I,C,e){const{obj:l,k:A}=Ag(g,I,Object);l[A]=l[A]||[],e&&(l[A]=l[A].concat(C)),e||l[A].push(C)}(C.loaded,[l],A),function(g,I){void 0!==g.pending[I]&&(delete g.pending[I],g.pendingCount--)}(C,g),I&&C.errors.push(I),0!==C.pendingCount||C.done||(Object.keys(C.loaded).forEach((g=>{t[g]||(t[g]={});const I=C.loaded[g];I.length&&I.forEach((I=>{void 0===t[g][I]&&(t[g][I]=!0)}))})),C.done=!0,C.errors.length?C.callback(C.errors):C.callback())})),this.emit("loaded",t),this.queue=this.queue.filter((g=>!g.done))}read(g,I,C){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,A=arguments.length>5?arguments[5]:void 0;if(!g.length)return A(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:g,ns:I,fcName:C,tried:e,wait:l,callback:A});this.readingCalls++;const t=(t,n)=>{if(this.readingCalls--,this.waitingReads.length>0){const g=this.waitingReads.shift();this.read(g.lng,g.ns,g.fcName,g.tried,g.wait,g.callback)}t&&n&&e<this.maxRetries?setTimeout((()=>{this.read.call(this,g,I,C,e+1,2*l,A)}),l):A(t,n)},n=this.backend[C].bind(this.backend);if(2!==n.length)return n(g,I,t);try{const C=n(g,I);C&&"function"===typeof C.then?C.then((g=>t(null,g))).catch(t):t(null,C)}catch(o){t(o)}}prepareLoading(g,I){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),e&&e();"string"===typeof g&&(g=this.languageUtils.toResolveHierarchy(g)),"string"===typeof I&&(I=[I]);const l=this.queueLoad(g,I,C,e);if(!l.toLoad.length)return l.pending.length||e(),null;l.toLoad.forEach((g=>{this.loadOne(g)}))}load(g,I,C){this.prepareLoading(g,I,{},C)}reload(g,I,C){this.prepareLoading(g,I,{reload:!0},C)}loadOne(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const C=g.split("|"),e=C[0],l=C[1];this.read(e,l,"read",void 0,void 0,((C,A)=>{C&&this.logger.warn("".concat(I,"loading namespace ").concat(l," for language ").concat(e," failed"),C),!C&&A&&this.logger.log("".concat(I,"loaded namespace ").concat(l," for language ").concat(e),A),this.loaded(g,C,A)}))}saveMissing(g,I,C,e,l){let A=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},t=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(I))this.logger.warn('did not save key "'.concat(C,'" as the namespace "').concat(I,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");else if(void 0!==C&&null!==C&&""!==C){if(this.backend&&this.backend.create){const o={...A,isUpdate:l},a=this.backend.create.bind(this.backend);if(a.length<6)try{let l;l=5===a.length?a(g,I,C,e,o):a(g,I,C,e),l&&"function"===typeof l.then?l.then((g=>t(null,g))).catch(t):t(null,l)}catch(n){t(n)}else a(g,I,C,e,t,o)}g&&g[0]&&this.store.addResource(g[0],I,C,e)}}}function Hg(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(g){let I={};if("object"===typeof g[1]&&(I=g[1]),"string"===typeof g[1]&&(I.defaultValue=g[1]),"string"===typeof g[2]&&(I.tDescription=g[2]),"object"===typeof g[2]||"object"===typeof g[3]){const C=g[3]||g[2];Object.keys(C).forEach((g=>{I[g]=C[g]}))}return I},interpolation:{escapeValue:!0,format:g=>g,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function Ng(g){return"string"===typeof g.ns&&(g.ns=[g.ns]),"string"===typeof g.fallbackLng&&(g.fallbackLng=[g.fallbackLng]),"string"===typeof g.fallbackNS&&(g.fallbackNS=[g.fallbackNS]),g.supportedLngs&&g.supportedLngs.indexOf("cimode")<0&&(g.supportedLngs=g.supportedLngs.concat(["cimode"])),g}function fg(){}class Kg extends Ig{constructor(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},I=arguments.length>1?arguments[1]:void 0;var C;if(super(),this.options=Ng(g),this.services={},this.logger=gg,this.modules={external:[]},C=this,Object.getOwnPropertyNames(Object.getPrototypeOf(C)).forEach((g=>{"function"===typeof C[g]&&(C[g]=C[g].bind(C))})),I&&!this.isInitialized&&!g.isClone){if(!this.options.initImmediate)return this.init(g,I),this;setTimeout((()=>{this.init(g,I)}),0)}}init(){var g=this;let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},C=arguments.length>1?arguments[1]:void 0;"function"===typeof I&&(C=I,I={}),!I.defaultNS&&!1!==I.defaultNS&&I.ns&&("string"===typeof I.ns?I.defaultNS=I.ns:I.ns.indexOf("translation")<0&&(I.defaultNS=I.ns[0]));const e=Hg();function l(g){return g?"function"===typeof g?new g:g:null}if(this.options={...e,...this.options,...Ng(I)},"v1"!==this.options.compatibilityAPI&&(this.options.interpolation={...e.interpolation,...this.options.interpolation}),void 0!==I.keySeparator&&(this.options.userDefinedKeySeparator=I.keySeparator),void 0!==I.nsSeparator&&(this.options.userDefinedNsSeparator=I.nsSeparator),!this.options.isClone){let I;this.modules.logger?gg.init(l(this.modules.logger),this.options):gg.init(null,this.options),this.modules.formatter?I=this.modules.formatter:"undefined"!==typeof Intl&&(I=Yg);const C=new hg(this.options);this.store=new mg(this.options.resources,this.options);const A=this.services;A.logger=gg,A.resourceStore=this.store,A.languageUtils=C,A.pluralResolver=new Xg(C,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!I||this.options.interpolation.format&&this.options.interpolation.format!==e.interpolation.format||(A.formatter=l(I),A.formatter.init(A,this.options),this.options.interpolation.format=A.formatter.format.bind(A.formatter)),A.interpolator=new kg(this.options),A.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},A.backendConnector=new vg(l(this.modules.backend),A.resourceStore,A,this.options),A.backendConnector.on("*",(function(I){for(var C=arguments.length,e=new Array(C>1?C-1:0),l=1;l<C;l++)e[l-1]=arguments[l];g.emit(I,...e)})),this.modules.languageDetector&&(A.languageDetector=l(this.modules.languageDetector),A.languageDetector.init&&A.languageDetector.init(A,this.options.detection,this.options)),this.modules.i18nFormat&&(A.i18nFormat=l(this.modules.i18nFormat),A.i18nFormat.init&&A.i18nFormat.init(this)),this.translator=new Gg(this.services,this.options),this.translator.on("*",(function(I){for(var C=arguments.length,e=new Array(C>1?C-1:0),l=1;l<C;l++)e[l-1]=arguments[l];g.emit(I,...e)})),this.modules.external.forEach((g=>{g.init&&g.init(this)}))}if(this.format=this.options.interpolation.format,C||(C=fg),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const g=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);g.length>0&&"dev"!==g[0]&&(this.options.lng=g[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((I=>{this[I]=function(){return g.store[I](...arguments)}}));["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((I=>{this[I]=function(){return g.store[I](...arguments),g}}));const A=Cg(),t=()=>{const g=(g,I)=>{this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),A.resolve(I),C(g,I)};if(this.languages&&"v1"!==this.options.compatibilityAPI&&!this.isInitialized)return g(null,this.t.bind(this));this.changeLanguage(this.options.lng,g)};return this.options.resources||!this.options.initImmediate?t():setTimeout(t,0),A}loadResources(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fg;const C="string"===typeof g?g:this.language;if("function"===typeof g&&(I=g),!this.options.resources||this.options.partialBundledLanguages){if(C&&"cimode"===C.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return I();const g=[],e=I=>{if(!I)return;if("cimode"===I)return;this.services.languageUtils.toResolveHierarchy(I).forEach((I=>{"cimode"!==I&&g.indexOf(I)<0&&g.push(I)}))};if(C)e(C);else{this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((g=>e(g)))}this.options.preload&&this.options.preload.forEach((g=>e(g))),this.services.backendConnector.load(g,this.options.ns,(g=>{g||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),I(g)}))}else I(null)}reloadResources(g,I,C){const e=Cg();return g||(g=this.languages),I||(I=this.options.ns),C||(C=fg),this.services.backendConnector.reload(g,I,(g=>{e.resolve(),C(g)})),e}use(g){if(!g)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!g.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===g.type&&(this.modules.backend=g),("logger"===g.type||g.log&&g.warn&&g.error)&&(this.modules.logger=g),"languageDetector"===g.type&&(this.modules.languageDetector=g),"i18nFormat"===g.type&&(this.modules.i18nFormat=g),"postProcessor"===g.type&&Zg.addPostProcessor(g),"formatter"===g.type&&(this.modules.formatter=g),"3rdParty"===g.type&&this.modules.external.push(g),this}setResolvedLanguage(g){if(g&&this.languages&&!(["cimode","dev"].indexOf(g)>-1))for(let I=0;I<this.languages.length;I++){const g=this.languages[I];if(!(["cimode","dev"].indexOf(g)>-1)&&this.store.hasLanguageSomeTranslations(g)){this.resolvedLanguage=g;break}}}changeLanguage(g,I){var C=this;this.isLanguageChangingTo=g;const e=Cg();this.emit("languageChanging",g);const l=g=>{this.language=g,this.languages=this.services.languageUtils.toResolveHierarchy(g),this.resolvedLanguage=void 0,this.setResolvedLanguage(g)},A=(g,A)=>{A?(l(A),this.translator.changeLanguage(A),this.isLanguageChangingTo=void 0,this.emit("languageChanged",A),this.logger.log("languageChanged",A)):this.isLanguageChangingTo=void 0,e.resolve((function(){return C.t(...arguments)})),I&&I(g,(function(){return C.t(...arguments)}))},t=I=>{g||I||!this.services.languageDetector||(I=[]);const C="string"===typeof I?I:this.services.languageUtils.getBestMatchFromCodes(I);C&&(this.language||l(C),this.translator.language||this.translator.changeLanguage(C),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(C)),this.loadResources(C,(g=>{A(g,C)}))};return g||!this.services.languageDetector||this.services.languageDetector.async?!g&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(t):this.services.languageDetector.detect(t):t(g):t(this.services.languageDetector.detect()),e}getFixedT(g,I,C){var e=this;const l=function(g,I){let A;if("object"!==typeof I){for(var t=arguments.length,n=new Array(t>2?t-2:0),o=2;o<t;o++)n[o-2]=arguments[o];A=e.options.overloadTranslationOptionHandler([g,I].concat(n))}else A={...I};A.lng=A.lng||l.lng,A.lngs=A.lngs||l.lngs,A.ns=A.ns||l.ns,A.keyPrefix=A.keyPrefix||C||l.keyPrefix;const a=e.options.keySeparator||".";let c;return c=A.keyPrefix&&Array.isArray(g)?g.map((g=>"".concat(A.keyPrefix).concat(a).concat(g))):A.keyPrefix?"".concat(A.keyPrefix).concat(a).concat(g):g,e.t(c,A)};return"string"===typeof g?l.lng=g:l.lngs=g,l.ns=I,l.keyPrefix=C,l}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(g){this.options.defaultNS=g}hasLoadedNamespace(g){let I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const C=I.lng||this.resolvedLanguage||this.languages[0],e=!!this.options&&this.options.fallbackLng,l=this.languages[this.languages.length-1];if("cimode"===C.toLowerCase())return!0;const A=(g,I)=>{const C=this.services.backendConnector.state["".concat(g,"|").concat(I)];return-1===C||2===C};if(I.precheck){const g=I.precheck(this,A);if(void 0!==g)return g}return!!this.hasResourceBundle(C,g)||(!(this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages))||!(!A(C,g)||e&&!A(l,g)))}loadNamespaces(g,I){const C=Cg();return this.options.ns?("string"===typeof g&&(g=[g]),g.forEach((g=>{this.options.ns.indexOf(g)<0&&this.options.ns.push(g)})),this.loadResources((g=>{C.resolve(),I&&I(g)})),C):(I&&I(),Promise.resolve())}loadLanguages(g,I){const C=Cg();"string"===typeof g&&(g=[g]);const e=this.options.preload||[],l=g.filter((g=>e.indexOf(g)<0));return l.length?(this.options.preload=e.concat(l),this.loadResources((g=>{C.resolve(),I&&I(g)})),C):(I&&I(),Promise.resolve())}dir(g){if(g||(g=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!g)return"rtl";const I=this.services&&this.services.languageUtils||new hg(Hg());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(I.getLanguagePartFromCode(g))>-1||g.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new Kg(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fg;const C=g.forkResourceStore;C&&delete g.forkResourceStore;const e={...this.options,...g,isClone:!0},l=new Kg(e);void 0===g.debug&&void 0===g.prefix||(l.logger=l.logger.clone(g));return["store","services","language"].forEach((g=>{l[g]=this[g]})),l.services={...this.services},l.services.utils={hasLoadedNamespace:l.hasLoadedNamespace.bind(l)},C&&(l.store=new mg(this.store.data,e),l.services.resourceStore=l.store),l.translator=new Gg(l.services,e),l.translator.on("*",(function(g){for(var I=arguments.length,C=new Array(I>1?I-1:0),e=1;e<I;e++)C[e-1]=arguments[e];l.emit(g,...C)})),l.init(e,I),l.translator.options=e,l.translator.backendConnector.services.utils={hasLoadedNamespace:l.hasLoadedNamespace.bind(l)},l}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const wg=Kg.createInstance();wg.createInstance=Kg.createInstance;wg.createInstance,wg.dir,wg.init,wg.loadResources,wg.reloadResources,wg.use,wg.changeLanguage,wg.getFixedT,wg.t,wg.exists,wg.setDefaultNamespace,wg.hasLoadedNamespace,wg.loadNamespaces,wg.loadLanguages;function Fg(g){return Fg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},Fg(g)}function xg(g){var I=function(g,I){if("object"!=Fg(g)||!g)return g;var C=g[Symbol.toPrimitive];if(void 0!==C){var e=C.call(g,I||"default");if("object"!=Fg(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===I?String:Number)(g)}(g,"string");return"symbol"==Fg(I)?I:String(I)}function zg(g,I){for(var C=0;C<I.length;C++){var e=I[C];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(g,xg(e.key),e)}}var Ug=[],Qg=Ug.forEach,Eg=Ug.slice;var Lg=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,Mg=function(g,I,C,e){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};C&&(l.expires=new Date,l.expires.setTime(l.expires.getTime()+60*C*1e3)),e&&(l.domain=e),document.cookie=function(g,I,C){var e=C||{};e.path=e.path||"/";var l=encodeURIComponent(I),A="".concat(g,"=").concat(l);if(e.maxAge>0){var t=e.maxAge-0;if(Number.isNaN(t))throw new Error("maxAge should be a Number");A+="; Max-Age=".concat(Math.floor(t))}if(e.domain){if(!Lg.test(e.domain))throw new TypeError("option domain is invalid");A+="; Domain=".concat(e.domain)}if(e.path){if(!Lg.test(e.path))throw new TypeError("option path is invalid");A+="; Path=".concat(e.path)}if(e.expires){if("function"!==typeof e.expires.toUTCString)throw new TypeError("option expires is invalid");A+="; Expires=".concat(e.expires.toUTCString())}if(e.httpOnly&&(A+="; HttpOnly"),e.secure&&(A+="; Secure"),e.sameSite)switch("string"===typeof e.sameSite?e.sameSite.toLowerCase():e.sameSite){case!0:A+="; SameSite=Strict";break;case"lax":A+="; SameSite=Lax";break;case"strict":A+="; SameSite=Strict";break;case"none":A+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return A}(g,encodeURIComponent(I),l)},Dg=function(g){for(var I="".concat(g,"="),C=document.cookie.split(";"),e=0;e<C.length;e++){for(var l=C[e];" "===l.charAt(0);)l=l.substring(1,l.length);if(0===l.indexOf(I))return l.substring(I.length,l.length)}return null},Tg={name:"cookie",lookup:function(g){var I;if(g.lookupCookie&&"undefined"!==typeof document){var C=Dg(g.lookupCookie);C&&(I=C)}return I},cacheUserLanguage:function(g,I){I.lookupCookie&&"undefined"!==typeof document&&Mg(I.lookupCookie,g,I.cookieMinutes,I.cookieDomain,I.cookieOptions)}},jg={name:"querystring",lookup:function(g){var I;if("undefined"!==typeof window){var C=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(C=window.location.hash.substring(window.location.hash.indexOf("?")));for(var e=C.substring(1).split("&"),l=0;l<e.length;l++){var A=e[l].indexOf("=");if(A>0)e[l].substring(0,A)===g.lookupQuerystring&&(I=e[l].substring(A+1))}}return I}},Pg=null,Og=function(){if(null!==Pg)return Pg;try{Pg="undefined"!==window&&null!==window.localStorage;var g="i18next.translate.boo";window.localStorage.setItem(g,"foo"),window.localStorage.removeItem(g)}catch(I){Pg=!1}return Pg},qg={name:"localStorage",lookup:function(g){var I;if(g.lookupLocalStorage&&Og()){var C=window.localStorage.getItem(g.lookupLocalStorage);C&&(I=C)}return I},cacheUserLanguage:function(g,I){I.lookupLocalStorage&&Og()&&window.localStorage.setItem(I.lookupLocalStorage,g)}},_g=null,$g=function(){if(null!==_g)return _g;try{_g="undefined"!==window&&null!==window.sessionStorage;var g="i18next.translate.boo";window.sessionStorage.setItem(g,"foo"),window.sessionStorage.removeItem(g)}catch(I){_g=!1}return _g},gI={name:"sessionStorage",lookup:function(g){var I;if(g.lookupSessionStorage&&$g()){var C=window.sessionStorage.getItem(g.lookupSessionStorage);C&&(I=C)}return I},cacheUserLanguage:function(g,I){I.lookupSessionStorage&&$g()&&window.sessionStorage.setItem(I.lookupSessionStorage,g)}},II={name:"navigator",lookup:function(g){var I=[];if("undefined"!==typeof navigator){if(navigator.languages)for(var C=0;C<navigator.languages.length;C++)I.push(navigator.languages[C]);navigator.userLanguage&&I.push(navigator.userLanguage),navigator.language&&I.push(navigator.language)}return I.length>0?I:void 0}},CI={name:"htmlTag",lookup:function(g){var I,C=g.htmlTag||("undefined"!==typeof document?document.documentElement:null);return C&&"function"===typeof C.getAttribute&&(I=C.getAttribute("lang")),I}},eI={name:"path",lookup:function(g){var I;if("undefined"!==typeof window){var C=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(C instanceof Array)if("number"===typeof g.lookupFromPathIndex){if("string"!==typeof C[g.lookupFromPathIndex])return;I=C[g.lookupFromPathIndex].replace("/","")}else I=C[0].replace("/","")}return I}},lI={name:"subdomain",lookup:function(g){var I="number"===typeof g.lookupFromSubdomainIndex?g.lookupFromSubdomainIndex+1:1,C="undefined"!==typeof window&&window.location&&window.location.hostname&&window.location.hostname.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(C)return C[I]}};var AI=function(){function g(I){var C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(g,I){if(!(g instanceof I))throw new TypeError("Cannot call a class as a function")}(this,g),this.type="languageDetector",this.detectors={},this.init(I,C)}var I,C,e;return I=g,C=[{key:"init",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=g||{languageUtils:{}},this.options=function(g){return Qg.call(Eg.call(arguments,1),(function(I){if(I)for(var C in I)void 0===g[C]&&(g[C]=I[C])})),g}(I,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:function(g){return g}}),"string"===typeof this.options.convertDetectedLanguage&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=function(g){return g.replace("-","_")}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=C,this.addDetector(Tg),this.addDetector(jg),this.addDetector(qg),this.addDetector(gI),this.addDetector(II),this.addDetector(CI),this.addDetector(eI),this.addDetector(lI)}},{key:"addDetector",value:function(g){this.detectors[g.name]=g}},{key:"detect",value:function(g){var I=this;g||(g=this.options.order);var C=[];return g.forEach((function(g){if(I.detectors[g]){var e=I.detectors[g].lookup(I.options);e&&"string"===typeof e&&(e=[e]),e&&(C=C.concat(e))}})),C=C.map((function(g){return I.options.convertDetectedLanguage(g)})),this.services.languageUtils.getBestMatchFromCodes?C:C.length>0?C[0]:null}},{key:"cacheUserLanguage",value:function(g,I){var C=this;I||(I=this.options.caches),I&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(g)>-1||I.forEach((function(I){C.detectors[I]&&C.detectors[I].cacheUserLanguage(g,C.options)})))}}],C&&zg(I.prototype,C),e&&zg(I,e),Object.defineProperty(I,"prototype",{writable:!1}),g}();AI.type="languageDetector";C(7399);Object.create(null);const tI={};function nI(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];"string"===typeof I[0]&&tI[I[0]]||("string"===typeof I[0]&&(tI[I[0]]=new Date),function(){if(console&&console.warn){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];"string"===typeof I[0]&&(I[0]="react-i18next:: ".concat(I[0])),console.warn(...I)}}(...I))}const oI=(g,I)=>()=>{if(g.isInitialized)I();else{const C=()=>{setTimeout((()=>{g.off("initialized",C)}),0),I()};g.on("initialized",C)}};function aI(g,I,C){g.loadNamespaces(I,oI(g,C))}function cI(g,I,C,e){"string"===typeof C&&(C=[C]),C.forEach((I=>{g.options.ns.indexOf(I)<0&&g.options.ns.push(I)})),g.loadLanguages(I,oI(g,e))}const dI=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,iI={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"\xa9","&#169;":"\xa9","&reg;":"\xae","&#174;":"\xae","&hellip;":"\u2026","&#8230;":"\u2026","&#x2F;":"/","&#47;":"/"},sI=g=>iI[g];let rI,bI={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:g=>g.replace(dI,sI)};const mI={type:"3rdParty",init(g){!function(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};bI={...bI,...g}}(g.options.react),function(g){rI=g}(g)}},ZI=(0,g.createContext)();class uI{constructor(){this.usedNamespaces={}}addUsedNamespaces(g){g.forEach((g=>{this.usedNamespaces[g]||(this.usedNamespaces[g]=!0)}))}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const GI=(I,C)=>{const e=(0,g.useRef)();return(0,g.useEffect)((()=>{e.current=C?e.current:I}),[I,C]),e.current};function BI(I){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{i18n:e}=C,{i18n:l,defaultNS:A}=(0,g.useContext)(ZI)||{},t=e||l||rI;if(t&&!t.reportNamespaces&&(t.reportNamespaces=new uI),!t){nI("You will need to pass in an i18next instance by using initReactI18next");const g=(g,I)=>"string"===typeof I?I:I&&"object"===typeof I&&"string"===typeof I.defaultValue?I.defaultValue:Array.isArray(g)?g[g.length-1]:g,I=[g,{},!1];return I.t=g,I.i18n={},I.ready=!1,I}t.options.react&&void 0!==t.options.react.wait&&nI("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const n={...bI,...t.options.react,...C},{useSuspense:o,keyPrefix:a}=n;let c=I||A||t.options&&t.options.defaultNS;c="string"===typeof c?[c]:c||["translation"],t.reportNamespaces.addUsedNamespaces&&t.reportNamespaces.addUsedNamespaces(c);const d=(t.isInitialized||t.initializedStoreOnce)&&c.every((g=>function(g,I){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return I.languages&&I.languages.length?void 0!==I.options.ignoreJSONStructure?I.hasLoadedNamespace(g,{lng:C.lng,precheck:(I,e)=>{if(C.bindI18n&&C.bindI18n.indexOf("languageChanging")>-1&&I.services.backendConnector.backend&&I.isLanguageChangingTo&&!e(I.isLanguageChangingTo,g))return!1}}):function(g,I){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const e=I.languages[0],l=!!I.options&&I.options.fallbackLng,A=I.languages[I.languages.length-1];if("cimode"===e.toLowerCase())return!0;const t=(g,C)=>{const e=I.services.backendConnector.state["".concat(g,"|").concat(C)];return-1===e||2===e};return!(C.bindI18n&&C.bindI18n.indexOf("languageChanging")>-1&&I.services.backendConnector.backend&&I.isLanguageChangingTo&&!t(I.isLanguageChangingTo,g))&&(!!I.hasResourceBundle(e,g)||!(I.services.backendConnector.backend&&(!I.options.resources||I.options.partialBundledLanguages))||!(!t(e,g)||l&&!t(A,g)))}(g,I,C):(nI("i18n.languages were undefined or empty",I.languages),!0)}(g,t,n)));function i(){return t.getFixedT(C.lng||null,"fallback"===n.nsMode?c:c[0],a)}const[s,r]=(0,g.useState)(i);let b=c.join();C.lng&&(b="".concat(C.lng).concat(b));const m=GI(b),Z=(0,g.useRef)(!0);(0,g.useEffect)((()=>{const{bindI18n:g,bindI18nStore:I}=n;function e(){Z.current&&r(i)}return Z.current=!0,d||o||(C.lng?cI(t,C.lng,c,(()=>{Z.current&&r(i)})):aI(t,c,(()=>{Z.current&&r(i)}))),d&&m&&m!==b&&Z.current&&r(i),g&&t&&t.on(g,e),I&&t&&t.store.on(I,e),()=>{Z.current=!1,g&&t&&g.split(" ").forEach((g=>t.off(g,e))),I&&t&&I.split(" ").forEach((g=>t.store.off(g,e)))}}),[t,b]);const u=(0,g.useRef)(!0);(0,g.useEffect)((()=>{Z.current&&!u.current&&r(i),u.current=!1}),[t,a]);const G=[s,t,d];if(G.t=s,G.i18n=t,G.ready=d,d)return G;if(!d&&!o)return G;throw new Promise((g=>{C.lng?cI(t,C.lng,c,(()=>g())):aI(t,c,(()=>g()))}))}const hI=JSON.parse('{"from":"\u0938\u094d\u0930\u094b\u0924","full_line":"\u0921\u0940\u090f\u092e\u0906\u0930\u0938\u0940 \u0932\u093e\u0907\u0928","airport_line":"\u090f\u092f\u0930\u092a\u094b\u0930\u094d\u091f \u0932\u093e\u0907\u0928","destination":"\u0917\u0902\u0924\u0935\u094d\u092f","stations_search":"\u0938\u094d\u091f\u0949\u092a \u0916\u094b\u091c\u0947\u0902","recent_journeys":"\u0936\u0940\u0918\u094d\u0930 \u091f\u093f\u0915\u091f \u092c\u0941\u0915\u093f\u0902\u0917 \u0915\u0947 \u0932\u093f\u090f \u0939\u093e\u0932 \u0915\u0940 \u092f\u093e\u0924\u094d\u0930\u093e\u090f\u0901","recent_journeys_title":"\u0939\u093e\u0932 \u0915\u0940 \u092f\u093e\u0924\u094d\u0930\u093e","select_from":"\u091a\u092f\u0928 \u0915\u0930\u0947","select_destination":"\u091a\u092f\u0928 \u0915\u0930\u0947","per_person":"\u092a\u094d\u0930\u0924\u093f \u091f\u093f\u0915\u091f","passenger":"\u091f\u093f\u0915\u091f","base_fare":"\u092e\u0942\u0932 \u0915\u093f\u0930\u093e\u092f\u093e","toll":"\u091f\u094b\u0932","convenience_fee":"\u0938\u0941\u0935\u093f\u0927\u093e \u0936\u0941\u0932\u094d\u0915","discount":"\u091b\u0942\u091f","fare_details":"\u0915\u093f\u0930\u093e\u092f\u093e","add_passenger":"\u091f\u093f\u0915\u091f \u091c\u094b\u0921\u093c\u0947\u0902","total_fare":"\u0915\u0941\u0932 \u0915\u093f\u0930\u093e\u092f\u093e","grand_total":"\u0915\u0941\u0932 \u092f\u094b\u0917","continue":"\u091c\u093e\u0930\u0940 \u0930\u0916\u0947\u0902","booking_summary":"\u091f\u093f\u0915\u091f \u0938\u093e\u0930\u093e\u0902\u0936","confirm":"\u092a\u0941\u0937\u094d\u091f\u093f \u0915\u0930\u0947\u0902","edit":"\u0938\u0902\u0936\u094b\u0927\u0928 \u0915\u0930\u0947\u0902","empty_ticket_error_msg":"\u0905\u092c \u0924\u0915 \u0906\u092a\u0915\u0940 \u0915\u094b\u0908 \u092f\u093e\u0924\u094d\u0930\u093e \u0928\u0939\u0940\u0902 \u0939\u0948","empty_ticket_error_msg_next":"\u0915\u0943\u092a\u092f\u093e \u0905\u092a\u0928\u093e \u091f\u093f\u0915\u091f \u092c\u0941\u0915 \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f \u0928\u0940\u091a\u0947 \u0926\u093f\u090f \u0917\u090f \u092c\u091f\u0928 \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902\u0964","buy_ticket":"\u091f\u093f\u0915\u091f \u0916\u0930\u0940\u0926\u0947\u0902","buy_again":"\u092a\u0941\u0928\u0903 \u0916\u0930\u0940\u0926\u0947\u0902","no_recent_journey":"\u0905\u092d\u0940 \u0924\u0915 \u0915\u094b\u0908 \u0939\u093e\u0932\u093f\u092f\u093e \u092f\u093e\u0924\u094d\u0930\u093e \u0928\u0939\u0940\u0902","charges_msg":"\u091f\u093f\u0915\u091f \u0916\u0930\u0940\u0926\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f, \u0915\u0943\u092a\u092f\u093e \u0905\u092a\u0928\u0947 \u092a\u0938\u0902\u0926\u0940\u0926\u093e \u092d\u0941\u0917\u0924\u093e\u0928 \u092e\u094b\u0921 \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0915\u0947 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0930\u0947\u0902\u0964","payment_charges_title":"\u092d\u0941\u0917\u0924\u093e\u0928 \u0936\u0941\u0932\u094d\u0915","debit_card":"\u0921\u0947\u092c\u093f\u091f \u0915\u093e\u0930\u094d\u0921 - 0.40%","credit_card":"\u0915\u094d\u0930\u0947\u0921\u093f\u091f \u0915\u093e\u0930\u094d\u0921 - 1.10%","upi_charges":"UPI - \u0936\u0942\u0928\u094d\u092f","terms_and_condi":"\u0928\u093f\u092f\u092e \u0914\u0930 \u0936\u0930\u094d\u0924\u0947\u0902","edit_details_note":"\u0938\u0902\u0936\u094b\u0927\u0928 \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f, \u0915\u0943\u092a\u092f\u093e \u2018\u0938\u0902\u0936\u094b\u0927\u0928 \u0915\u0930\u0947\u0902\u2019 \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902\u0964","Validation_error_msg":"\u0915\u0943\u092a\u092f\u093e \u0938\u094d\u0930\u094b\u0924 \u0914\u0930 \u0917\u0902\u0924\u0935\u094d\u092f \u0938\u094d\u091f\u0949\u092a \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0947\u0902\u0964","search_source_station_msg":"\u0938\u094d\u0930\u094b\u0924 \u0938\u094d\u091f\u0949\u092a \u0916\u094b\u091c\u0947\u0902 / \u091f\u093e\u0907\u092a \u0915\u0930\u0947\u0902 ","search_destination_station_msg":"\u0917\u0902\u0924\u0935\u094d\u092f \u0938\u094d\u091f\u0949\u092a \u0916\u094b\u091c\u0947\u0902 / \u091f\u093e\u0907\u092a \u0915\u0930\u0947\u0902 ","pay_with_upi":"UPI \u0938\u0947 \u092d\u0941\u0917\u0924\u093e\u0928","pay_with_other":"\u0905\u0928\u094d\u092f \u092e\u094b\u0921 \u0938\u0947 \u092d\u0941\u0917\u0924\u093e\u0928","payment_link_redirect_msg":"\u092c\u0927\u093e\u0908 \u0939\u094b! \u0906\u092a\u0915\u093e \u091f\u093f\u0915\u091f \u0938\u0924\u094d\u092f\u093e\u092a\u093f\u0924 \u0939\u094b \u0917\u092f\u093e \u0939\u0948\u0964 <br />\u0906\u092a\u0915\u094b \u091c\u0932\u094d\u0926\u0940 \u0939\u0940 \u0907\u0938\u0915\u093e \u092a\u094d\u0930\u0924\u093f \u0935\u0949\u091f\u094d\u0938\u094d\u0910\u092a \u092a\u0930 \u092e\u093f\u0932\u0947\u0917\u093e\u0964<br />\u0906\u092a \u0909\u0938\u0947 \'\u091f\u093f\u0915\u091f \u0921\u093e\u0909\u0928\u0932\u094b\u0921 \u0915\u0930\u0947\u0902\' \u0935\u093f\u0915\u0932\u094d\u092a \u0938\u0947 \u092d\u0940 \u0921\u093e\u0909\u0928\u0932\u094b\u0921 \u0915\u0930 \u0938\u0915\u0924\u0947 \u0939\u0948\u0902\u0964<br />\u0915\u0943\u092a\u092f\u093e \u0938\u094d\u0935\u091a\u093e\u0932\u093f\u0924 \u0930\u0942\u092a \u0938\u0947 \u0935\u0949\u091f\u094d\u0938\u094d\u0910\u092a \u092a\u0930 \u092a\u0941\u0928\u0930\u094d\u0928\u093f\u0930\u094d\u0926\u0947\u0936\u093f\u0924 \u0939\u094b\u0928\u0947 \u0915\u093e \u0907\u0902\u0924\u091c\u093e\u0930 \u0915\u0930\u0947\u0902 \u092f\u093e \u201c\u091c\u093e\u0930\u0940 \u0930\u0916\u0947\u0902\u201d \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902\u0964","payment_link_gen_err":"\u0939\u092e\u0947\u0902 \u092d\u0941\u0917\u0924\u093e\u0928 \u0932\u093f\u0902\u0915 \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0915\u0930\u0928\u0947 \u092e\u0947\u0902 \u0938\u092e\u0938\u094d\u092f\u093e \u0939\u0941\u0908 \u0939\u0948\u0964 \u0905\u092a\u0930\u093f\u0936\u0941\u0926\u094d\u0927\u0924\u093e \u0915\u0947 \u0932\u093f\u090f \u0939\u092e \u0915\u094d\u0937\u092e\u093e \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0915\u0930\u0924\u0947 \u0939\u0948\u0902\u0964 \u0915\u0943\u092a\u092f\u093e \u0925\u094b\u0921\u093c\u0940 \u0926\u0947\u0930 \u092e\u0947\u0902 \u092a\u0941\u0928: \u092a\u094d\u0930\u092f\u093e\u0938 \u0915\u0930\u0947\u0902\u0964","error_msg_title":"\u0938\u093e\u0907\u091f \u0905\u092d\u0940 \u0930\u0916\u0930\u0916\u093e\u0935 \u0915\u0947 \u0905\u0902\u0924\u0930\u094d\u0917\u0924 \u0939\u0948\u0964","error_msg_description":"\u0915\u0943\u092a\u092f\u093e \u0935\u094d\u0939\u093e\u091f\u094d\u0938\u090f\u092a \u092a\u0930 \u0935\u093e\u092a\u0938 \u091c\u093e\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f \u0928\u0940\u091a\u0947 \u0926\u093f\u090f \u0917\u090f \u092c\u091f\u0928 \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902\u0964","link_exp_msg_title":"\u092e\u093e\u092b\u093c \u0915\u0930\u0947\u0902, \u0932\u093f\u0902\u0915 \u0915\u093e \u0938\u092e\u092f \u0938\u092e\u093e\u092a\u094d\u0924 \u0939\u094b \u0917\u092f\u093e \u0939\u0948","link_exp_msg_description":"\u0935\u094d\u0939\u093e\u091f\u094d\u0938\u090f\u092a \u092a\u0930 \u0932\u094c\u091f\u0928\u0947 \u0914\u0930 \u091a\u0948\u091f \u0936\u0941\u0930\u0942 \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f \u0915\u0943\u092a\u092f\u093e \u0928\u0940\u091a\u0947 \u0926\u093f\u090f \u0917\u090f \u092c\u091f\u0928 \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902 \u0914\u0930 \'hi\' \u091f\u093e\u0907\u092a \u0915\u0930\u0947\u0902\u0964","line_disable_alert_message":" \u0915\u0940 \u0935\u094d\u0939\u093e\u091f\u094d\u0938\u090f\u092a \u0938\u0947 \u092c\u0941\u0915\u093f\u0902\u0917 \u0938\u0941\u0935\u093f\u0927\u093e \u0905\u092d\u0940 \u0909\u092a\u0932\u092c\u094d\u0927 \u0928\u0939\u0940\u0902 \u0939\u0948\u0964 \u0905\u0938\u0941\u0935\u093f\u0927\u093e \u0915\u0947 \u0932\u093f\u090f \u0939\u092e\u0947\u0902 \u0916\u0947\u0926 \u0939\u0948\u0964","airport_line_booking_time_msg_desc":"\u090f\u092f\u0930\u092a\u094b\u0930\u094d\u091f \u0932\u093e\u0907\u0928 \u0915\u0940 \u091f\u093f\u0915\u091f\u0947\u0902 \u0938\u0941\u092c\u0939 {{startTime}} \u092c\u091c\u0947 \u0938\u0947 {{stopTime}} \u092c\u091c\u0947 \u0924\u0915 \u092c\u0941\u0915 \u0915\u0940 \u091c\u093e \u0938\u0915\u0924\u0940 \u0939\u0948\u0902\u0964","dmrc_line_booking_time_msg_desc":"\u0921\u0940\u090f\u092e\u0906\u0930\u0938\u0940 \u0932\u093e\u0907\u0928 \u0915\u0940 \u091f\u093f\u0915\u091f\u0947\u0902 \u0938\u0941\u092c\u0939 {{startTime}} \u092c\u091c\u0947 \u0938\u0947 {{stopTime}} \u092c\u091c\u0947 \u0924\u0915 \u092c\u0941\u0915 \u0915\u0940 \u091c\u093e \u0938\u0915\u0924\u0940 \u0939\u0948\u0902\u0964","upi_payment_note":"\u0928\u094b\u091f:<br />\u0915\u0943\u092a\u092f\u093e <b>UPI \u0938\u0947 \u092d\u0941\u0917\u0924\u093e\u0928</b> \u0915\u093e \u0909\u092a\u092f\u094b\u0917 \u0915\u0947\u0935\u0932 <b>\u092e\u094b\u092c\u093e\u0907\u0932 \u0921\u093f\u0935\u093e\u0907\u0938</b> \u092a\u0930 \u0915\u0930\u0947\u0902 \u091c\u093f\u0928\u092e\u0947\u0902 <b>UPI \u0910\u092a</b> \u0907\u0902\u0938\u094d\u091f\u0949\u0932 \u0939\u0948\u0964<br /><b>UPI \u0910\u092a \u0915\u0947 \u092c\u093f\u0928\u093e</b> \u0935\u093e\u0932\u0947 \u0921\u093f\u0935\u093e\u0907\u0938 \u0915\u0947 \u0932\u093f\u090f <b>\u0905\u0928\u094d\u092f \u092e\u094b\u0921 \u0915\u0947 \u0938\u093e\u0925 \u092d\u0941\u0917\u0924\u093e\u0928</b> \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0947\u0902\u0964","book_by_station":"\u0938\u094d\u091f\u0949\u092a \u0916\u094b\u091c\u0947\u0902","book_by_route":"\u092e\u093e\u0930\u094d\u0917 \u0938\u0947 \u092c\u0941\u0915 \u0915\u0930\u0947\u0902","qr_scane":"\u0915\u094d\u092f\u0942\u0906\u0930 \u0938\u094d\u0915\u0948\u0928 \u0915\u0930\u0947\u0902","routes_search":"\u092e\u093e\u0930\u094d\u0917 \u0916\u094b\u091c\u0947\u0902","stops_search":"\u092e\u0942\u0932 \u0938\u094d\u0925\u093e\u0928 \u0914\u0930 \u0917\u0902\u0924\u0935\u094d\u092f \u0938\u094d\u0925\u093e\u0928 \u0916\u094b\u091c\u0947\u0902/\u091f\u093e\u0907\u092a \u0915\u0930\u0947\u0902","search_route_name_msg":"\u092e\u093e\u0930\u094d\u0917 \u0928\u093e\u092e \u0916\u094b\u091c\u0947\u0902/\u091f\u093e\u0907\u092a \u0915\u0930\u0947\u0902","route_name":"\u0930\u0942\u091f \u0915\u093e \u0928\u093e\u092e","search_from_station_msg":"\u0938\u094d\u091f\u0949\u092a \u0938\u0947 \u0916\u094b\u091c\u0947\u0902/\u091f\u093e\u0907\u092a \u0915\u0930\u0947\u0902","quick_book":"\u092b\u093c\u0949\u0938\u094d\u091f \u092c\u0941\u0915","change_route_button_name":"\u0930\u0942\u091f \u092c\u0926\u0932\u0947\u0902","stops":"\u0938\u094d\u091f\u0949\u092a","no_route_found":"\u0915\u094b\u0908 \u0930\u0942\u091f \u0909\u092a\u0932\u092c\u094d\u0927 \u0928\u0939\u0940\u0902 \u0939\u0948","no_stop_found":"\u0915\u094b\u0908 \u0938\u094d\u091f\u0949\u092a \u0909\u092a\u0932\u092c\u094d\u0927 \u0928\u0939\u0940\u0902 \u0939\u0948","invalid_qr":"\u0905\u092e\u093e\u0928\u094d\u092f \u0915\u094d\u092f\u0942\u0906\u0930","open_camera":"\u0915\u0948\u092e\u0930\u093e \u0916\u094b\u0932\u0947\u0902","close_camera":"\u0915\u0948\u092e\u0930\u093e \u092c\u0902\u0926 \u0915\u0930\u0947\u0902","ac_bus":"\u090f\u0938\u0940 \u092c\u0938","non_ac_bus":"\u0928\u0949\u0928 \u090f\u0938\u0940 \u092c\u0938","ticket_validation_status_title":"\u0938\u0924\u094d\u092f\u093e\u092a\u0928 \u0938\u094d\u0925\u093f\u0924\u093f","ticket_validation_status_desc":"\u092c\u0927\u093e\u0908 \u0939\u094b! \u0906\u092a\u0915\u093e \u091f\u093f\u0915\u091f \u0938\u0924\u094d\u092f\u093e\u092a\u093f\u0924 \u0939\u094b \u0917\u092f\u093e \u0939\u0948\u0964 <br />\u0906\u092a\u0915\u094b \u091c\u0932\u094d\u0926\u0940 \u0939\u0940 \u091f\u093f\u0915\u091f \u0935\u0949\u091f\u094d\u0938\u094d\u0910\u092a \u092a\u0930 \u092e\u093f\u0932\u0947\u0917\u093e\u0964<br />\u0906\u092a \u091f\u093f\u0915\u091f \u0915\u094b \'\u091f\u093f\u0915\u091f \u0921\u093e\u0909\u0928\u0932\u094b\u0921 \u0915\u0930\u0947\u0902\' \u0935\u093f\u0915\u0932\u094d\u092a \u0938\u0947 \u092d\u0940 \u0921\u093e\u0909\u0928\u0932\u094b\u0921 \u0915\u0930 \u0938\u0915\u0924\u0947 \u0939\u0948\u0902\u0964<br />\u0915\u0943\u092a\u092f\u093e \u0938\u094d\u0935\u091a\u093e\u0932\u093f\u0924 \u0930\u0942\u092a \u0938\u0947 \u0935\u0949\u091f\u094d\u0938\u094d\u0910\u092a \u092a\u0930 \u092a\u0941\u0928\u0903\u0928\u093f\u0930\u094d\u0926\u0947\u0936\u093f\u0924 \u0939\u094b\u0928\u0947 \u0915\u093e \u0907\u0902\u0924\u091c\u093e\u0930 \u0915\u0930\u0947\u0902 \u092f\u093e \u201c\u091c\u093e\u0930\u0940 \u0930\u0916\u0947\u0902\u201d \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902\u0964","error_msg_title_while_api_call":"\u0924\u094d\u0930\u0941\u091f\u093f","error_msg_desc_while_api_call":"\u0939\u092e\u0947\u0902 \u0915\u0941\u091b \u0924\u0915\u0928\u0940\u0915\u0940 \u0938\u092e\u0938\u094d\u092f\u093e \u0915\u093e \u0938\u093e\u092e\u0928\u093e \u0939\u0948\u0964 \u0915\u0943\u092a\u092f\u093e \u0925\u094b\u0921\u093c\u0940 \u0926\u0947\u0930 \u092c\u093e\u0926 \u0938\u0924\u094d\u092f\u093e\u092a\u093f\u0924 \u0915\u0930\u0947\u0902\u0964","bus_number_title":"\u092c\u0938 \u0928\u0902\u092c\u0930 \u0926\u0930\u094d\u091c \u0915\u0930\u0947\u0902","submit_label":"\u091c\u092e\u093e \u0915\u0930\u0947\u0902","enter_valid_bus_no_alert_msg":"\u0915\u0943\u092a\u092f\u093e \u0938\u0939\u0940 \u092c\u0938 \u0928\u0902\u092c\u0930 \u0926\u0930\u094d\u091c \u0915\u0930\u0947\u0902\u0964","dtc_qna":"\u0938\u0902\u092c\u0902\u0927\u093f\u0924 \u0938\u0935\u093e\u0932","valid_bus_no_succes_alert":"Bus details fetched successfully.","discount_per_msg":"\u0905\u0927\u093f\u0915\u0924\u092e"}'),pI=JSON.parse('{"from":"Source","full_line":"DMRC Line","airport_line":"Airport Line","destination":"Destination","stations_search":"Station Search","recent_journeys_title":"Recent Journeys","select_from":"Select","select_destination":"Select","per_person":"Ticket","passenger":"Ticket(s)","add_passenger":"Add Tickets","fare_details":"Fare","base_fare":"Base Fare","toll":"Toll","convenience_fee":"Convenience Fee","discount":"Discount","total_fare":"Total Fare","grand_total":"Grand Total","continue":"Continue","booking_summary":"Ticket Summary","confirm":"Confirm","edit":"Edit","empty_ticket_error_msg":"You do not have any journey till now","empty_ticket_error_msg_next":"Please click on the button below to book your ticket.","buy_ticket":"Buy Ticket","buy_again":"Buy Again","no_recent_journey":"No Recent Journey Yet","charges_msg":"To proceed with the ticket purchase, please select your preferred payment mode to complete the payment.","payment_charges_title":"Payment Charges","debit_card":"Debit Card - 0.40%","credit_card":"Credit Card - 1.10%","upi_charges":"UPI - NIL","terms_and_condi":"Terms & Conditions","edit_details_note":"To Edit Details , Please click on \'Edit\'.","Validation_error_msg":"Please select source and destination stop.","pay_with_upi":"Pay With UPI","pay_with_other":"Pay With Other Modes","payment_link_redirect_msg":"Thank you ! You\u2019ll soon receive a payment link on your WhatsApp for your QR Ticket(s). <br />Please wait to be automatically redirected to WhatsApp or click on \u201cContinue\u201d.","payment_link_gen_err":"Oops! Something went wrong while fetching the payment link. Please try again later.","error_msg_title":"Site Is Under Maintainence.","error_msg_description":"Please click on below button to go back to whatsapp.","link_exp_msg_title":"Sorry, The link has expired","link_exp_msg_description":"Please click on the button below to return to WhatsApp and type \'hi\' to start the chat.","line_disable_alert_message":" booking from whatsapp is currently unavailable. We apologize for any inconvenience.","airport_line_booking_time_msg_desc":"Airport line tickets can be booked from {{startTime}} to {{stopTime}}","dmrc_line_booking_time_msg_desc":"DMRC line tickets can be booked from {{startTime}} to {{stopTime}}","upi_payment_note":"<b>Note</b>:<br /> Please use <b>Pay with UPI</b> on mobiles with a UPI app.<br /> For <b>devices without UPI</b> apps, select <b>Pay with Other Modes</b>.","book_by_station":"Search Stops","book_by_route":"Book By Route","qr_scane":"Scan QR","routes_search":"Route Search","stops_search":"Type/Search Source and Destination Stops","search_route_name_msg":"Search / Type Route Name","route_name":"Route Name","search_destination_station_msg":"Search / Type Destination stop","search_from_station_msg":"Search / Type From stop","quick_book":"Quick Book","change_route_button_name":"Change Route","enter_bus_numer_alert_msg":"Please enter a bus number before submitting.","bus_number_title":"Enter Bus Number","qr_option":"OR","prefix_error":"Please select prefix","stops":"Stops","no_route_found":"No Route Available","no_stop_found":"No Stop Available","invalid_qr":"Invalid QR","open_camera":"Open Scanner","close_camera":"Close Scanner","ac_bus":"AC Bus","non_ac_bus":"Non AC Bus","ticket_validation_status_title":"Validation Status","ticket_validation_status_desc":"Congratulations ! Your Ticket is validated. <br /> You will soon receive a copy on your WhatsApp. <br /> You can download the same from \u201cDownload Ticket\u201d option too. <br /> Please wait to be automatically redirected to WhatsApp or click on \u201cContinue\u201d.","error_msg_title_while_api_call":"Error","error_msg_desc_while_api_call":"We are facing some technical issue. Please validate after sometime.","qna_lable":"FAQs","dtc_qna":"Frequently Asked Questions","submit_label":"Submit","enter_valid_bus_no_alert_msg":"Please enter a correct bus number","valid_bus_no_succes_alert":"Bus details fetched successfully.","fare_validation_error_msg":"We are facing some technical issues, please try after sometime.","discount_per_msg":"max."}');wg.use(AI).use(mI).init({resources:{en:{translations:pI},hi:{translations:hI}},fallbackLng:"en",debug:Boolean("false"),ns:["translations"],defaultNS:"translations",keySeparator:!1,interpolation:{escapeValue:!1},detection:{order:["querystring","cookie","navigator"],lookupQuerystring:"lang",caches:[]}});function yI(g){return"Minified Redux error #"+g+"; visit https://redux.js.org/Errors?code="+g+" for the full message or use the non-minified dev environment for full errors. "}var WI="function"===typeof Symbol&&Symbol.observable||"@@observable",VI=function(){return Math.random().toString(36).substring(7).split("").join(".")},SI={INIT:"@@redux/INIT"+VI(),REPLACE:"@@redux/REPLACE"+VI(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+VI()}};function XI(g){if("object"!==typeof g||null===g)return!1;for(var I=g;null!==Object.getPrototypeOf(I);)I=Object.getPrototypeOf(I);return Object.getPrototypeOf(g)===I}var RI=function g(I,C,e){var l;if("function"===typeof C&&"function"===typeof e||"function"===typeof e&&"function"===typeof arguments[3])throw new Error(yI(0));if("function"===typeof C&&"undefined"===typeof e&&(e=C,C=void 0),"undefined"!==typeof e){if("function"!==typeof e)throw new Error(yI(1));return e(g)(I,C)}if("function"!==typeof I)throw new Error(yI(2));var A=I,t=C,n=[],o=n,a=!1;function c(){o===n&&(o=n.slice())}function d(){if(a)throw new Error(yI(3));return t}function i(g){if("function"!==typeof g)throw new Error(yI(4));if(a)throw new Error(yI(5));var I=!0;return c(),o.push(g),function(){if(I){if(a)throw new Error(yI(6));I=!1,c();var C=o.indexOf(g);o.splice(C,1),n=null}}}function s(g){if(!XI(g))throw new Error(yI(7));if("undefined"===typeof g.type)throw new Error(yI(8));if(a)throw new Error(yI(9));try{a=!0,t=A(t,g)}finally{a=!1}for(var I=n=o,C=0;C<I.length;C++){(0,I[C])()}return g}return s({type:SI.INIT}),(l={dispatch:s,subscribe:i,getState:d,replaceReducer:function(g){if("function"!==typeof g)throw new Error(yI(10));A=g,s({type:SI.REPLACE})}})[WI]=function(){var g,I=i;return(g={subscribe:function(g){if("object"!==typeof g||null===g)throw new Error(yI(11));function C(){g.next&&g.next(d())}return C(),{unsubscribe:I(C)}}})[WI]=function(){return this},g},l};const kI="SET_FARE",JI="SHOW_ALERT",YI="HIDE_ALERT",vI="SET_NO_OF_TICKETS",HI="SET_METRO_TYPE",NI="SET_WHATSAPP_NUMBER",fI="SET_LINK_EXPIRE",KI="SET_CHECKSUM",wI="SET_BOOK_TYPE",FI="SET_FROM_STATION",xI="APPEND_FROM_STATION",zI="SET_DESTINATION_STATION",UI="APPEND_DESTINATION_STATION",QI="SET_ROUTE",EI="SET_SCANNED_DATA",LI="SET_SCANNED_ENCRYPT_DATA",MI="SET_FROM_STATION_LIST",DI="SET_DESTINATION_STATION_LIST",TI="SET_BOOK_TYPE_REQUIRED",jI="SET_IS_AC_BUS",PI="SET_DISABLE_BOOK_TYPE",OI="SET_RECENT_JOURNEYS",qI="SET_VALIDATE_BUS_NUMBER",_I={bookedTickets:[],stationList:[],airportLineStationList:[],fromStation:null,noOfTicket:1,destinationStation:null,showAlert:!1,alertMessage:"",recentJourneys:[],alertLevel:0,metroType:"n",whatsAppNumber:null,activeLine:null,isNormalLineDisable:!1,isAirportLineDisable:!1,isLinkExpire:!1,checksum:null,isAirportBookingDisable:!1,isDMRCBookingDisable:!1,isAirportLineTicketAlreadyGen:!1,airportLineTicketAlreadyGenMsg:"",metroBookingTimeJson:null,bookType:null,fromStationList:[],destinationStationList:[],route:null,fare:{base_fare:0,total_fare:0,discount_percentage:0,amount_payable_by_user:0},scannedData:null,scannedEncryptedData:null,isBookTypeRequired:!0,isAcBus:!1,disableBookType:!1,validateBusNumber:""},$I=(g,I)=>{const C=g.bookedTickets.filter((g=>g.id!==I.payload));return{...g,bookedTickets:C}},gC=(g,I)=>({...g,bookedTickets:[...g.bookedTickets,I.payload]}),IC={showAlert:!1,alertMessage:"",alertLevel:"success"},CC=function(g){for(var I=Object.keys(g),C={},e=0;e<I.length;e++){var l=I[e];0,"function"===typeof g[l]&&(C[l]=g[l])}var A,t=Object.keys(C);try{!function(g){Object.keys(g).forEach((function(I){var C=g[I];if("undefined"===typeof C(void 0,{type:SI.INIT}))throw new Error(yI(12));if("undefined"===typeof C(void 0,{type:SI.PROBE_UNKNOWN_ACTION()}))throw new Error(yI(13))}))}(C)}catch(n){A=n}return function(g,I){if(void 0===g&&(g={}),A)throw A;for(var e=!1,l={},n=0;n<t.length;n++){var o=t[n],a=C[o],c=g[o],d=a(c,I);if("undefined"===typeof d){I&&I.type;throw new Error(yI(14))}l[o]=d,e=e||d!==c}return(e=e||t.length!==Object.keys(g).length)?l:g}}({bookTicketReducer:function(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_I,I=arguments.length>1?arguments[1]:void 0;switch(I.type){case"BOOK_TICKET":return gC;case"DELETE_TICKET":return $I;case"SET_STATION_LIST":return((g,I)=>({...g,stationList:[...g.stationList,...I.payload]}))(g,I);case FI:return((g,I)=>({...g,fromStation:I.payload}))(g,I);case zI:return((g,I)=>({...g,destinationStation:I.payload}))(g,I);case kI:return((g,I)=>({...g,fare:I.payload}))(g,I);case JI:return((g,I)=>({...g,showAlert:I.payload.showAlert,alertMessage:I.payload.message,alertLevel:I.payload.lelvel}))(g,I);case YI:return(g=>({...g,showAlert:!1,alertMessage:"",alertLevel:0}))(g);case vI:return((g,I)=>({...g,noOfTicket:I.payload}))(g,I);case HI:return((g,I)=>({...g,metroType:I.payload}))(g,I);case"SET_AIRPORT_STATION_LIST":return((g,I)=>({...g,airportLineStationList:[...g.airportLineStationList,...I.payload]}))(g,I);case OI:return((g,I)=>({...g,recentJourneys:I.payload}))(g,I);case NI:return((g,I)=>({...g,whatsAppNumber:I.payload}))(g,I);case"DISABLE_NORMAL_LINE":return((g,I)=>({...g,isNormalLineDisable:I.payload}))(g,I);case"DISABLE_AIRPORT_LINE":return((g,I)=>({...g,isAirportLineDisable:I.payload}))(g,I);case fI:return((g,I)=>({...g,isLinkExpire:I.payload}))(g,I);case KI:return((g,I)=>({...g,checksum:I.payload}))(g,I);case"IS_AIRPORT_BOOKING_DISABLE":return((g,I)=>({...g,isAirportBookingDisable:I.payload}))(g,I);case"IS_DMRC_BOOKING_DISABLE":return((g,I)=>({...g,isDMRCBookingDisable:I.payload}))(g,I);case"IS_AIRPORT_LINE_TICKET_ALREADY_GENERATED":return((g,I)=>({...g,isAirportLineTicketAlreadyGen:I.payload}))(g,I);case"SET_AIRPORT_LINE_ERROR_MSG":return((g,I)=>({...g,airportLineTicketAlreadyGenMsg:I.payload}))(g,I);case"SET_METRO_BOOKING_TIME_JSON":return((g,I)=>({...g,metroBookingTimeJson:I.payload}))(g,I);case wI:return((g,I)=>({...g,bookType:I.payload}))(g,I);case QI:return((g,I)=>({...g,route:I.payload}))(g,I);case EI:return((g,I)=>({...g,scannedData:I.payload}))(g,I);case LI:return((g,I)=>({...g,scannedEncryptedData:I.payload}))(g,I);case MI:return((g,I)=>({...g,fromStationList:I.payload}))(g,I);case DI:return((g,I)=>({...g,destinationStationList:I.payload}))(g,I);case TI:return((g,I)=>({...g,isBookTypeRequired:I.payload}))(g,I);case jI:return((g,I)=>({...g,isAcBus:I.payload}))(g,I);case PI:return((g,I)=>({...g,disableBookType:I.payload}))(g,I);case xI:return((g,I)=>({...g,fromStationList:[...g.fromStationList,...I.payload]}))(g,I);case UI:return((g,I)=>({...g,destinationStationList:[...g.destinationStationList,...I.payload]}))(g,I);case qI:return((g,I)=>({...g,validateBusNumber:I.payload}))(g,I);default:return g}},alertReducer:function(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:IC,I=arguments.length>1?arguments[1]:void 0;switch(I.type){case JI:return((g,I)=>({...g,showAlert:I.payload.showAlert,alertMessage:I.payload.message,alertLevel:I.payload.level}))(g,I);case YI:return(g=>({...g,showAlert:!1,alertMessage:"",alertLevel:0}))(g);default:return g}}}),eC=RI(CC);function lC(){return lC=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var C=arguments[I];for(var e in C)Object.prototype.hasOwnProperty.call(C,e)&&(g[e]=C[e])}return g},lC.apply(this,arguments)}var AC;!function(g){g.Pop="POP",g.Push="PUSH",g.Replace="REPLACE"}(AC||(AC={}));const tC="popstate";function nC(g,I){if(!1===g||null===g||"undefined"===typeof g)throw new Error(I)}function oC(g,I){if(!g){"undefined"!==typeof console&&console.warn(I);try{throw new Error(I)}catch(C){}}}function aC(g,I){return{usr:g.state,key:g.key,idx:I}}function cC(g,I,C,e){return void 0===C&&(C=null),lC({pathname:"string"===typeof g?g:g.pathname,search:"",hash:""},"string"===typeof I?iC(I):I,{state:C,key:I&&I.key||e||Math.random().toString(36).substr(2,8)})}function dC(g){let{pathname:I="/",search:C="",hash:e=""}=g;return C&&"?"!==C&&(I+="?"===C.charAt(0)?C:"?"+C),e&&"#"!==e&&(I+="#"===e.charAt(0)?e:"#"+e),I}function iC(g){let I={};if(g){let C=g.indexOf("#");C>=0&&(I.hash=g.substr(C),g=g.substr(0,C));let e=g.indexOf("?");e>=0&&(I.search=g.substr(e),g=g.substr(0,e)),g&&(I.pathname=g)}return I}function sC(g,I,C,e){void 0===e&&(e={});let{window:l=document.defaultView,v5Compat:A=!1}=e,t=l.history,n=AC.Pop,o=null,a=c();function c(){return(t.state||{idx:null}).idx}function d(){n=AC.Pop;let g=c(),I=null==g?null:g-a;a=g,o&&o({action:n,location:s.location,delta:I})}function i(g){let I="null"!==l.location.origin?l.location.origin:l.location.href,C="string"===typeof g?g:dC(g);return nC(I,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,I)}null==a&&(a=0,t.replaceState(lC({},t.state,{idx:a}),""));let s={get action(){return n},get location(){return g(l,t)},listen(g){if(o)throw new Error("A history only accepts one active listener");return l.addEventListener(tC,d),o=g,()=>{l.removeEventListener(tC,d),o=null}},createHref:g=>I(l,g),createURL:i,encodeLocation(g){let I=i(g);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:function(g,I){n=AC.Push;let e=cC(s.location,g,I);C&&C(e,g),a=c()+1;let d=aC(e,a),i=s.createHref(e);try{t.pushState(d,"",i)}catch(r){if(r instanceof DOMException&&"DataCloneError"===r.name)throw r;l.location.assign(i)}A&&o&&o({action:n,location:s.location,delta:1})},replace:function(g,I){n=AC.Replace;let e=cC(s.location,g,I);C&&C(e,g),a=c();let l=aC(e,a),d=s.createHref(e);t.replaceState(l,"",d),A&&o&&o({action:n,location:s.location,delta:0})},go:g=>t.go(g)};return s}var rC;!function(g){g.data="data",g.deferred="deferred",g.redirect="redirect",g.error="error"}(rC||(rC={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function bC(g,I,C){void 0===C&&(C="/");let e=kC(("string"===typeof I?iC(I):I).pathname||"/",C);if(null==e)return null;let l=mC(g);!function(g){g.sort(((g,I)=>g.score!==I.score?I.score-g.score:function(g,I){let C=g.length===I.length&&g.slice(0,-1).every(((g,C)=>g===I[C]));return C?g[g.length-1]-I[I.length-1]:0}(g.routesMeta.map((g=>g.childrenIndex)),I.routesMeta.map((g=>g.childrenIndex)))))}(l);let A=null;for(let t=0;null==A&&t<l.length;++t)A=SC(l[t],RC(e));return A}function mC(g,I,C,e){void 0===I&&(I=[]),void 0===C&&(C=[]),void 0===e&&(e="");let l=(g,l,A)=>{let t={relativePath:void 0===A?g.path||"":A,caseSensitive:!0===g.caseSensitive,childrenIndex:l,route:g};t.relativePath.startsWith("/")&&(nC(t.relativePath.startsWith(e),'Absolute route path "'+t.relativePath+'" nested under path "'+e+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),t.relativePath=t.relativePath.slice(e.length));let n=NC([e,t.relativePath]),o=C.concat(t);g.children&&g.children.length>0&&(nC(!0!==g.index,'Index routes must not have child routes. Please remove all child routes from route path "'+n+'".'),mC(g.children,I,o,n)),(null!=g.path||g.index)&&I.push({path:n,score:VC(n,g.index),routesMeta:o})};return g.forEach(((g,I)=>{var C;if(""!==g.path&&null!=(C=g.path)&&C.includes("?"))for(let e of ZC(g.path))l(g,I,e);else l(g,I)})),I}function ZC(g){let I=g.split("/");if(0===I.length)return[];let[C,...e]=I,l=C.endsWith("?"),A=C.replace(/\?$/,"");if(0===e.length)return l?[A,""]:[A];let t=ZC(e.join("/")),n=[];return n.push(...t.map((g=>""===g?A:[A,g].join("/")))),l&&n.push(...t),n.map((I=>g.startsWith("/")&&""===I?"/":I))}const uC=/^:\w+$/,GC=3,BC=2,hC=1,pC=10,yC=-2,WC=g=>"*"===g;function VC(g,I){let C=g.split("/"),e=C.length;return C.some(WC)&&(e+=yC),I&&(e+=BC),C.filter((g=>!WC(g))).reduce(((g,I)=>g+(uC.test(I)?GC:""===I?hC:pC)),e)}function SC(g,I){let{routesMeta:C}=g,e={},l="/",A=[];for(let t=0;t<C.length;++t){let g=C[t],n=t===C.length-1,o="/"===l?I:I.slice(l.length)||"/",a=XC({path:g.relativePath,caseSensitive:g.caseSensitive,end:n},o);if(!a)return null;Object.assign(e,a.params);let c=g.route;A.push({params:e,pathname:NC([l,a.pathname]),pathnameBase:fC(NC([l,a.pathnameBase])),route:c}),"/"!==a.pathnameBase&&(l=NC([l,a.pathnameBase]))}return A}function XC(g,I){"string"===typeof g&&(g={path:g,caseSensitive:!1,end:!0});let[C,e]=function(g,I,C){void 0===I&&(I=!1);void 0===C&&(C=!0);oC("*"===g||!g.endsWith("*")||g.endsWith("/*"),'Route path "'+g+'" will be treated as if it were "'+g.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+g.replace(/\*$/,"/*")+'".');let e=[],l="^"+g.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,((g,I,C)=>(e.push({paramName:I,isOptional:null!=C}),C?"/?([^\\/]+)?":"/([^\\/]+)")));g.endsWith("*")?(e.push({paramName:"*"}),l+="*"===g||"/*"===g?"(.*)$":"(?:\\/(.+)|\\/*)$"):C?l+="\\/*$":""!==g&&"/"!==g&&(l+="(?:(?=\\/|$))");let A=new RegExp(l,I?void 0:"i");return[A,e]}(g.path,g.caseSensitive,g.end),l=I.match(C);if(!l)return null;let A=l[0],t=A.replace(/(.)\/+$/,"$1"),n=l.slice(1);return{params:e.reduce(((g,I,C)=>{let{paramName:e,isOptional:l}=I;if("*"===e){let g=n[C]||"";t=A.slice(0,A.length-g.length).replace(/(.)\/+$/,"$1")}const o=n[C];return g[e]=l&&!o?void 0:function(g,I){try{return decodeURIComponent(g)}catch(C){return oC(!1,'The value for the URL param "'+I+'" will not be decoded because the string "'+g+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+C+")."),g}}(o||"",e),g}),{}),pathname:A,pathnameBase:t,pattern:g}}function RC(g){try{return decodeURI(g)}catch(I){return oC(!1,'The URL path "'+g+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+I+")."),g}}function kC(g,I){if("/"===I)return g;if(!g.toLowerCase().startsWith(I.toLowerCase()))return null;let C=I.endsWith("/")?I.length-1:I.length,e=g.charAt(C);return e&&"/"!==e?null:g.slice(C)||"/"}function JC(g,I,C,e){return"Cannot include a '"+g+"' character in a manually specified `to."+I+"` field ["+JSON.stringify(e)+"].  Please separate it out to the `to."+C+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function YC(g){return g.filter(((g,I)=>0===I||g.route.path&&g.route.path.length>0))}function vC(g,I){let C=YC(g);return I?C.map(((I,C)=>C===g.length-1?I.pathname:I.pathnameBase)):C.map((g=>g.pathnameBase))}function HC(g,I,C,e){let l;void 0===e&&(e=!1),"string"===typeof g?l=iC(g):(l=lC({},g),nC(!l.pathname||!l.pathname.includes("?"),JC("?","pathname","search",l)),nC(!l.pathname||!l.pathname.includes("#"),JC("#","pathname","hash",l)),nC(!l.search||!l.search.includes("#"),JC("#","search","hash",l)));let A,t=""===g||""===l.pathname,n=t?"/":l.pathname;if(null==n)A=C;else{let g=I.length-1;if(!e&&n.startsWith("..")){let I=n.split("/");for(;".."===I[0];)I.shift(),g-=1;l.pathname=I.join("/")}A=g>=0?I[g]:"/"}let o=function(g,I){void 0===I&&(I="/");let{pathname:C,search:e="",hash:l=""}="string"===typeof g?iC(g):g,A=C?C.startsWith("/")?C:function(g,I){let C=I.replace(/\/+$/,"").split("/");return g.split("/").forEach((g=>{".."===g?C.length>1&&C.pop():"."!==g&&C.push(g)})),C.length>1?C.join("/"):"/"}(C,I):I;return{pathname:A,search:KC(e),hash:wC(l)}}(l,A),a=n&&"/"!==n&&n.endsWith("/"),c=(t||"."===n)&&C.endsWith("/");return o.pathname.endsWith("/")||!a&&!c||(o.pathname+="/"),o}const NC=g=>g.join("/").replace(/\/\/+/g,"/"),fC=g=>g.replace(/\/+$/,"").replace(/^\/*/,"/"),KC=g=>g&&"?"!==g?g.startsWith("?")?g:"?"+g:"",wC=g=>g&&"#"!==g?g.startsWith("#")?g:"#"+g:"";Error;function FC(g){return null!=g&&"number"===typeof g.status&&"string"===typeof g.statusText&&"boolean"===typeof g.internal&&"data"in g}const xC=["post","put","patch","delete"],zC=(new Set(xC),["get",...xC]);new Set(zC),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function UC(){return UC=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var C=arguments[I];for(var e in C)Object.prototype.hasOwnProperty.call(C,e)&&(g[e]=C[e])}return g},UC.apply(this,arguments)}const QC=g.createContext(null);const EC=g.createContext(null);const LC=g.createContext(null);const MC=g.createContext(null);const DC=g.createContext({outlet:null,matches:[],isDataRoute:!1});const TC=g.createContext(null);function jC(){return null!=g.useContext(MC)}function PC(){return jC()||nC(!1),g.useContext(MC).location}function OC(I){g.useContext(LC).static||g.useLayoutEffect(I)}function qC(){let{isDataRoute:I}=g.useContext(DC);return I?function(){let{router:I}=ne(Ae.UseNavigateStable),C=ae(te.UseNavigateStable),e=g.useRef(!1);OC((()=>{e.current=!0}));let l=g.useCallback((function(g,l){void 0===l&&(l={}),e.current&&("number"===typeof g?I.navigate(g):I.navigate(g,UC({fromRouteId:C},l)))}),[I,C]);return l}():function(){jC()||nC(!1);let I=g.useContext(QC),{basename:C,future:e,navigator:l}=g.useContext(LC),{matches:A}=g.useContext(DC),{pathname:t}=PC(),n=JSON.stringify(vC(A,e.v7_relativeSplatPath)),o=g.useRef(!1);OC((()=>{o.current=!0}));let a=g.useCallback((function(g,e){if(void 0===e&&(e={}),!o.current)return;if("number"===typeof g)return void l.go(g);let A=HC(g,JSON.parse(n),t,"path"===e.relative);null==I&&"/"!==C&&(A.pathname="/"===A.pathname?C:NC([C,A.pathname])),(e.replace?l.replace:l.push)(A,e.state,e)}),[C,l,n,t,I]);return a}()}function _C(I,C){let{relative:e}=void 0===C?{}:C,{future:l}=g.useContext(LC),{matches:A}=g.useContext(DC),{pathname:t}=PC(),n=JSON.stringify(vC(A,l.v7_relativeSplatPath));return g.useMemo((()=>HC(I,JSON.parse(n),t,"path"===e)),[I,n,t,e])}function $C(I,C,e,l){jC()||nC(!1);let{navigator:A}=g.useContext(LC),{matches:t}=g.useContext(DC),n=t[t.length-1],o=n?n.params:{},a=(n&&n.pathname,n?n.pathnameBase:"/");n&&n.route;let c,d=PC();if(C){var i;let g="string"===typeof C?iC(C):C;"/"===a||(null==(i=g.pathname)?void 0:i.startsWith(a))||nC(!1),c=g}else c=d;let s=c.pathname||"/",r=bC(I,{pathname:"/"===a?s:s.slice(a.length)||"/"});let b=le(r&&r.map((g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:NC([a,A.encodeLocation?A.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:"/"===g.pathnameBase?a:NC([a,A.encodeLocation?A.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])}))),t,e,l);return C&&b?g.createElement(MC.Provider,{value:{location:UC({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:AC.Pop}},b):b}function ge(){let I=function(){var I;let C=g.useContext(TC),e=oe(te.UseRouteError),l=ae(te.UseRouteError);if(void 0!==C)return C;return null==(I=e.errors)?void 0:I[l]}(),C=FC(I)?I.status+" "+I.statusText:I instanceof Error?I.message:JSON.stringify(I),e=I instanceof Error?I.stack:null,l="rgba(200,200,200, 0.5)",A={padding:"0.5rem",backgroundColor:l};return g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},C),e?g.createElement("pre",{style:A},e):null,null)}const Ie=g.createElement(ge,null);class Ce extends g.Component{constructor(g){super(g),this.state={location:g.location,revalidation:g.revalidation,error:g.error}}static getDerivedStateFromError(g){return{error:g}}static getDerivedStateFromProps(g,I){return I.location!==g.location||"idle"!==I.revalidation&&"idle"===g.revalidation?{error:g.error,location:g.location,revalidation:g.revalidation}:{error:void 0!==g.error?g.error:I.error,location:I.location,revalidation:g.revalidation||I.revalidation}}componentDidCatch(g,I){console.error("React Router caught the following error during render",g,I)}render(){return void 0!==this.state.error?g.createElement(DC.Provider,{value:this.props.routeContext},g.createElement(TC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ee(I){let{routeContext:C,match:e,children:l}=I,A=g.useContext(QC);return A&&A.static&&A.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(A.staticContext._deepestRenderedBoundaryId=e.route.id),g.createElement(DC.Provider,{value:C},l)}function le(I,C,e,l){var A;if(void 0===C&&(C=[]),void 0===e&&(e=null),void 0===l&&(l=null),null==I){var t;if(null==(t=e)||!t.errors)return null;I=e.matches}let n=I,o=null==(A=e)?void 0:A.errors;if(null!=o){let g=n.findIndex((g=>g.route.id&&(null==o?void 0:o[g.route.id])));g>=0||nC(!1),n=n.slice(0,Math.min(n.length,g+1))}let a=!1,c=-1;if(e&&l&&l.v7_partialHydration)for(let g=0;g<n.length;g++){let I=n[g];if((I.route.HydrateFallback||I.route.hydrateFallbackElement)&&(c=g),I.route.id){let{loaderData:g,errors:C}=e,l=I.route.loader&&void 0===g[I.route.id]&&(!C||void 0===C[I.route.id]);if(I.route.lazy||l){a=!0,n=c>=0?n.slice(0,c+1):[n[0]];break}}}return n.reduceRight(((I,l,A)=>{let t,d=!1,i=null,s=null;var r;e&&(t=o&&l.route.id?o[l.route.id]:void 0,i=l.route.errorElement||Ie,a&&(c<0&&0===A?(r="route-fallback",!1||ce[r]||(ce[r]=!0),d=!0,s=null):c===A&&(d=!0,s=l.route.hydrateFallbackElement||null)));let b=C.concat(n.slice(0,A+1)),m=()=>{let C;return C=t?i:d?s:l.route.Component?g.createElement(l.route.Component,null):l.route.element?l.route.element:I,g.createElement(ee,{match:l,routeContext:{outlet:I,matches:b,isDataRoute:null!=e},children:C})};return e&&(l.route.ErrorBoundary||l.route.errorElement||0===A)?g.createElement(Ce,{location:e.location,revalidation:e.revalidation,component:i,error:t,children:m(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):m()}),null)}var Ae=function(g){return g.UseBlocker="useBlocker",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g}(Ae||{}),te=function(g){return g.UseBlocker="useBlocker",g.UseLoaderData="useLoaderData",g.UseActionData="useActionData",g.UseRouteError="useRouteError",g.UseNavigation="useNavigation",g.UseRouteLoaderData="useRouteLoaderData",g.UseMatches="useMatches",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g.UseRouteId="useRouteId",g}(te||{});function ne(I){let C=g.useContext(QC);return C||nC(!1),C}function oe(I){let C=g.useContext(EC);return C||nC(!1),C}function ae(I){let C=function(I){let C=g.useContext(DC);return C||nC(!1),C}(),e=C.matches[C.matches.length-1];return e.route.id||nC(!1),e.route.id}const ce={};I.startTransition;function de(g){nC(!1)}function ie(I){let{basename:C="/",children:e=null,location:l,navigationType:A=AC.Pop,navigator:t,static:n=!1,future:o}=I;jC()&&nC(!1);let a=C.replace(/^\/*/,"/"),c=g.useMemo((()=>({basename:a,navigator:t,static:n,future:UC({v7_relativeSplatPath:!1},o)})),[a,o,t,n]);"string"===typeof l&&(l=iC(l));let{pathname:d="/",search:i="",hash:s="",state:r=null,key:b="default"}=l,m=g.useMemo((()=>{let g=kC(d,a);return null==g?null:{location:{pathname:g,search:i,hash:s,state:r,key:b},navigationType:A}}),[a,d,i,s,r,b,A]);return null==m?null:g.createElement(LC.Provider,{value:c},g.createElement(MC.Provider,{children:e,value:m}))}function se(g){let{children:I,location:C}=g;return $C(re(I),C)}new Promise((()=>{}));g.Component;function re(I,C){void 0===C&&(C=[]);let e=[];return g.Children.forEach(I,((I,l)=>{if(!g.isValidElement(I))return;let A=[...C,l];if(I.type===g.Fragment)return void e.push.apply(e,re(I.props.children,A));I.type!==de&&nC(!1),I.props.index&&I.props.children&&nC(!1);let t={id:I.props.id||A.join("-"),caseSensitive:I.props.caseSensitive,element:I.props.element,Component:I.props.Component,index:I.props.index,path:I.props.path,loader:I.props.loader,action:I.props.action,errorElement:I.props.errorElement,ErrorBoundary:I.props.ErrorBoundary,hasErrorBoundary:null!=I.props.ErrorBoundary||null!=I.props.errorElement,shouldRevalidate:I.props.shouldRevalidate,handle:I.props.handle,lazy:I.props.lazy};I.props.children&&(t.children=re(I.props.children,A)),e.push(t)})),e}function be(){return be=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var C=arguments[I];for(var e in C)Object.prototype.hasOwnProperty.call(C,e)&&(g[e]=C[e])}return g},be.apply(this,arguments)}function me(g,I){if(null==g)return{};var C,e,l={},A=Object.keys(g);for(e=0;e<A.length;e++)C=A[e],I.indexOf(C)>=0||(l[C]=g[C]);return l}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Ze=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"];new Map;const ue=I.startTransition;n.flushSync;function Ge(I){let{basename:C,children:e,future:l,window:A}=I,t=g.useRef();null==t.current&&(t.current=function(g){return void 0===g&&(g={}),sC((function(g,I){let{pathname:C,search:e,hash:l}=g.location;return cC("",{pathname:C,search:e,hash:l},I.state&&I.state.usr||null,I.state&&I.state.key||"default")}),(function(g,I){return"string"===typeof I?I:dC(I)}),null,g)}({window:A,v5Compat:!0}));let n=t.current,[o,a]=g.useState({action:n.action,location:n.location}),{v7_startTransition:c}=l||{},d=g.useCallback((g=>{c&&ue?ue((()=>a(g))):a(g)}),[a,c]);return g.useLayoutEffect((()=>n.listen(d)),[n,d]),g.createElement(ie,{basename:C,children:e,location:o.location,navigationType:o.action,navigator:n,future:l})}const Be="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,he=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pe=g.forwardRef((function(I,C){let e,{onClick:l,relative:A,reloadDocument:t,replace:n,state:o,target:a,to:c,preventScrollReset:d,unstable_viewTransition:i}=I,s=me(I,Ze),{basename:r}=g.useContext(LC),b=!1;if("string"===typeof c&&he.test(c)&&(e=c,Be))try{let g=new URL(window.location.href),I=c.startsWith("//")?new URL(g.protocol+c):new URL(c),C=kC(I.pathname,r);I.origin===g.origin&&null!=C?c=C+I.search+I.hash:b=!0}catch(u){}let m=function(I,C){let{relative:e}=void 0===C?{}:C;jC()||nC(!1);let{basename:l,navigator:A}=g.useContext(LC),{hash:t,pathname:n,search:o}=_C(I,{relative:e}),a=n;return"/"!==l&&(a="/"===n?l:NC([l,n])),A.createHref({pathname:a,search:o,hash:t})}(c,{relative:A}),Z=function(I,C){let{target:e,replace:l,state:A,preventScrollReset:t,relative:n,unstable_viewTransition:o}=void 0===C?{}:C,a=qC(),c=PC(),d=_C(I,{relative:n});return g.useCallback((g=>{if(function(g,I){return 0===g.button&&(!I||"_self"===I)&&!function(g){return!!(g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)}(g)}(g,e)){g.preventDefault();let C=void 0!==l?l:dC(c)===dC(d);a(I,{replace:C,state:A,preventScrollReset:t,relative:n,unstable_viewTransition:o})}}),[c,a,d,l,A,e,I,t,n,o])}(c,{replace:n,state:o,target:a,preventScrollReset:d,relative:A,unstable_viewTransition:i});return g.createElement("a",be({},s,{href:e||m,onClick:b||t?l:function(g){l&&l(g),g.defaultPrevented||Z(g)},ref:C,target:a}))}));var ye,We;(function(g){g.UseScrollRestoration="useScrollRestoration",g.UseSubmit="useSubmit",g.UseSubmitFetcher="useSubmitFetcher",g.UseFetcher="useFetcher",g.useViewTransitionState="useViewTransitionState"})(ye||(ye={})),function(g){g.UseFetcher="useFetcher",g.UseFetchers="useFetchers",g.UseScrollRestoration="useScrollRestoration"}(We||(We={}));var Ve=C(1418),Se=C.n(Ve),Xe=C(184);const Re=["xxl","xl","lg","md","sm","xs"],ke="xs",Je=g.createContext({prefixes:{},breakpoints:Re,minBreakpoint:ke}),{Consumer:Ye,Provider:ve}=Je;function He(I,C){const{prefixes:e}=(0,g.useContext)(Je);return I||e[C]||C}const Ne={"top-start":"top-0 start-0","top-center":"top-0 start-50 translate-middle-x","top-end":"top-0 end-0","middle-start":"top-50 start-0 translate-middle-y","middle-center":"top-50 start-50 translate-middle","middle-end":"top-50 end-0 translate-middle-y","bottom-start":"bottom-0 start-0","bottom-center":"bottom-0 start-50 translate-middle-x","bottom-end":"bottom-0 end-0"},fe=g.forwardRef(((g,I)=>{let{bsPrefix:C,position:e,containerPosition:l,className:A,as:t="div",...n}=g;return C=He(C,"toast-container"),(0,Xe.jsx)(t,{ref:I,...n,className:Se()(C,e&&Ne[e],l&&"position-".concat(l),A)})}));fe.displayName="ToastContainer";const Ke=fe;function we(){const I=(0,g.useRef)(!0),C=(0,g.useRef)((()=>I.current));return(0,g.useEffect)((()=>(I.current=!0,()=>{I.current=!1})),[]),C.current}function Fe(I){const C=function(I){const C=(0,g.useRef)(I);return C.current=I,C}(I);(0,g.useEffect)((()=>()=>C.current()),[])}const xe=2**31-1;function ze(g,I,C){const e=C-Date.now();g.current=e<=xe?setTimeout(I,e):setTimeout((()=>ze(g,I,C)),xe)}function Ue(){const I=we(),C=(0,g.useRef)();return Fe((()=>clearTimeout(C.current))),(0,g.useMemo)((()=>{const g=()=>clearTimeout(C.current);return{set:function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;I()&&(g(),l<=xe?C.current=setTimeout(e,l):ze(C,e,Date.now()+l))},clear:g,handleRef:C}}),[])}function Qe(g,I){return Qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(g,I){return g.__proto__=I,g},Qe(g,I)}const Ee=!1,Le=g.createContext(null);var Me="unmounted",De="exited",Te="entering",je="entered",Pe="exiting",Oe=function(I){var C,e;function l(g,C){var e;e=I.call(this,g,C)||this;var l,A=C&&!C.isMounting?g.enter:g.appear;return e.appearStatus=null,g.in?A?(l=De,e.appearStatus=Te):l=je:l=g.unmountOnExit||g.mountOnEnter?Me:De,e.state={status:l},e.nextCallback=null,e}e=I,(C=l).prototype=Object.create(e.prototype),C.prototype.constructor=C,Qe(C,e),l.getDerivedStateFromProps=function(g,I){return g.in&&I.status===Me?{status:De}:null};var A=l.prototype;return A.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},A.componentDidUpdate=function(g){var I=null;if(g!==this.props){var C=this.state.status;this.props.in?C!==Te&&C!==je&&(I=Te):C!==Te&&C!==je||(I=Pe)}this.updateStatus(!1,I)},A.componentWillUnmount=function(){this.cancelNextCallback()},A.getTimeouts=function(){var g,I,C,e=this.props.timeout;return g=I=C=e,null!=e&&"number"!==typeof e&&(g=e.exit,I=e.enter,C=void 0!==e.appear?e.appear:I),{exit:g,enter:I,appear:C}},A.updateStatus=function(g,I){if(void 0===g&&(g=!1),null!==I)if(this.cancelNextCallback(),I===Te){if(this.props.unmountOnExit||this.props.mountOnEnter){var C=this.props.nodeRef?this.props.nodeRef.current:t.findDOMNode(this);C&&function(g){g.scrollTop}(C)}this.performEnter(g)}else this.performExit();else this.props.unmountOnExit&&this.state.status===De&&this.setState({status:Me})},A.performEnter=function(g){var I=this,C=this.props.enter,e=this.context?this.context.isMounting:g,l=this.props.nodeRef?[e]:[t.findDOMNode(this),e],A=l[0],n=l[1],o=this.getTimeouts(),a=e?o.appear:o.enter;!g&&!C||Ee?this.safeSetState({status:je},(function(){I.props.onEntered(A)})):(this.props.onEnter(A,n),this.safeSetState({status:Te},(function(){I.props.onEntering(A,n),I.onTransitionEnd(a,(function(){I.safeSetState({status:je},(function(){I.props.onEntered(A,n)}))}))})))},A.performExit=function(){var g=this,I=this.props.exit,C=this.getTimeouts(),e=this.props.nodeRef?void 0:t.findDOMNode(this);I&&!Ee?(this.props.onExit(e),this.safeSetState({status:Pe},(function(){g.props.onExiting(e),g.onTransitionEnd(C.exit,(function(){g.safeSetState({status:De},(function(){g.props.onExited(e)}))}))}))):this.safeSetState({status:De},(function(){g.props.onExited(e)}))},A.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},A.safeSetState=function(g,I){I=this.setNextCallback(I),this.setState(g,I)},A.setNextCallback=function(g){var I=this,C=!0;return this.nextCallback=function(e){C&&(C=!1,I.nextCallback=null,g(e))},this.nextCallback.cancel=function(){C=!1},this.nextCallback},A.onTransitionEnd=function(g,I){this.setNextCallback(I);var C=this.props.nodeRef?this.props.nodeRef.current:t.findDOMNode(this),e=null==g&&!this.props.addEndListener;if(C&&!e){if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[C,this.nextCallback],A=l[0],n=l[1];this.props.addEndListener(A,n)}null!=g&&setTimeout(this.nextCallback,g)}else setTimeout(this.nextCallback,0)},A.render=function(){var I=this.state.status;if(I===Me)return null;var C=this.props,e=C.children,l=(C.in,C.mountOnEnter,C.unmountOnExit,C.appear,C.enter,C.exit,C.timeout,C.addEndListener,C.onEnter,C.onEntering,C.onEntered,C.onExit,C.onExiting,C.onExited,C.nodeRef,p(C,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return g.createElement(Le.Provider,{value:null},"function"===typeof e?e(I,l):g.cloneElement(g.Children.only(e),l))},l}(g.Component);function qe(){}Oe.contextType=Le,Oe.propTypes={},Oe.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:qe,onEntering:qe,onEntered:qe,onExit:qe,onExiting:qe,onExited:qe},Oe.UNMOUNTED=Me,Oe.EXITED=De,Oe.ENTERING=Te,Oe.ENTERED=je,Oe.EXITING=Pe;const _e=Oe;function $e(g){return g&&g.ownerDocument||document}function gl(g,I){return function(g){var I=$e(g);return I&&I.defaultView||window}(g).getComputedStyle(g,I)}var Il=/([A-Z])/g;var Cl=/^ms-/;function el(g){return function(g){return g.replace(Il,"-$1").toLowerCase()}(g).replace(Cl,"-ms-")}var ll=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;const Al=function(g,I){var C="",e="";if("string"===typeof I)return g.style.getPropertyValue(el(I))||gl(g).getPropertyValue(el(I));Object.keys(I).forEach((function(l){var A=I[l];A||0===A?!function(g){return!(!g||!ll.test(g))}(l)?C+=el(l)+": "+A+";":e+=l+"("+A+") ":g.style.removeProperty(el(l))})),e&&(C+="transform: "+e+";"),g.style.cssText+=";"+C},tl=!("undefined"===typeof window||!window.document||!window.document.createElement);var nl=!1,ol=!1;try{var al={get passive(){return nl=!0},get once(){return ol=nl=!0}};tl&&(window.addEventListener("test",al,al),window.removeEventListener("test",al,!0))}catch(Bo){}const cl=function(g,I,C,e){if(e&&"boolean"!==typeof e&&!ol){var l=e.once,A=e.capture,t=C;!ol&&l&&(t=C.__once||function g(e){this.removeEventListener(I,g,A),C.call(this,e)},C.__once=t),g.addEventListener(I,t,nl?e:A)}g.addEventListener(I,C,e)};const dl=function(g,I,C,e){var l=e&&"boolean"!==typeof e?e.capture:e;g.removeEventListener(I,C,l),C.__once&&g.removeEventListener(I,C.__once,l)};const il=function(g,I,C,e){return cl(g,I,C,e),function(){dl(g,I,C,e)}};function sl(g,I,C){void 0===C&&(C=5);var e=!1,l=setTimeout((function(){e||function(g,I,C,e){if(void 0===C&&(C=!1),void 0===e&&(e=!0),g){var l=document.createEvent("HTMLEvents");l.initEvent(I,C,e),g.dispatchEvent(l)}}(g,"transitionend",!0)}),I+C),A=il(g,"transitionend",(function(){e=!0}),{once:!0});return function(){clearTimeout(l),A()}}function rl(g,I,C,e){null==C&&(C=function(g){var I=Al(g,"transitionDuration")||"",C=-1===I.indexOf("ms")?1e3:1;return parseFloat(I)*C}(g)||0);var l=sl(g,C,e),A=il(g,"transitionend",I);return function(){l(),A()}}function bl(g,I){const C=Al(g,I)||"",e=-1===C.indexOf("ms")?1e3:1;return parseFloat(C)*e}function ml(g,I){const C=bl(g,"transitionDuration"),e=bl(g,"transitionDelay"),l=rl(g,(C=>{C.target===g&&(l(),I(C))}),C+e)}function Zl(g){g.offsetHeight}const ul=g=>g&&"function"!==typeof g?I=>{g.current=I}:g;const Gl=function(I,C){return(0,g.useMemo)((()=>function(g,I){const C=ul(g),e=ul(I);return g=>{C&&C(g),e&&e(g)}}(I,C)),[I,C])};const Bl=g.forwardRef(((I,C)=>{let{onEnter:e,onEntering:l,onEntered:A,onExit:n,onExiting:o,onExited:a,addEndListener:c,children:d,childRef:i,...s}=I;const r=(0,g.useRef)(null),b=Gl(r,i),m=g=>{var I;b((I=g)&&"setState"in I?t.findDOMNode(I):null!=I?I:null)},Z=g=>I=>{g&&r.current&&g(r.current,I)},u=(0,g.useCallback)(Z(e),[e]),G=(0,g.useCallback)(Z(l),[l]),B=(0,g.useCallback)(Z(A),[A]),h=(0,g.useCallback)(Z(n),[n]),p=(0,g.useCallback)(Z(o),[o]),y=(0,g.useCallback)(Z(a),[a]),W=(0,g.useCallback)(Z(c),[c]);return(0,Xe.jsx)(_e,{ref:C,...s,onEnter:u,onEntered:B,onEntering:G,onExit:h,onExited:y,onExiting:p,addEndListener:W,nodeRef:r,children:"function"===typeof d?(g,I)=>d(g,{...I,ref:m}):g.cloneElement(d,{ref:m})})})),hl=Bl,pl={[Te]:"show",[je]:"show"},yl=g.forwardRef(((I,C)=>{let{className:e,children:l,transitionClasses:A={},onEnter:t,...n}=I;const o={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...n},a=(0,g.useCallback)(((g,I)=>{Zl(g),null==t||t(g,I)}),[t]);return(0,Xe.jsx)(hl,{ref:C,addEndListener:ml,...o,onEnter:a,childRef:l.ref,children:(I,C)=>g.cloneElement(l,{...C,className:Se()("fade",e,l.props.className,pl[I],A[I])})})}));yl.displayName="Fade";const Wl=yl,Vl={[Te]:"showing",[Pe]:"showing show"},Sl=g.forwardRef(((g,I)=>(0,Xe.jsx)(Wl,{...g,ref:I,transitionClasses:Vl})));Sl.displayName="ToastFade";const Xl=Sl;const Rl=function(I){const C=(0,g.useRef)(I);return(0,g.useEffect)((()=>{C.current=I}),[I]),C};function kl(I){const C=Rl(I);return(0,g.useCallback)((function(){return C.current&&C.current(...arguments)}),[C])}var Jl=C(2007),Yl=C.n(Jl);const vl={"aria-label":Yl().string,onClick:Yl().func,variant:Yl().oneOf(["white"])},Hl=g.forwardRef(((g,I)=>{let{className:C,variant:e,"aria-label":l="Close",...A}=g;return(0,Xe.jsx)("button",{ref:I,type:"button",className:Se()("btn-close",e&&"btn-close-".concat(e),C),"aria-label":l,...A})}));Hl.displayName="CloseButton",Hl.propTypes=vl;const Nl=Hl,fl=g.createContext({onClose(){}}),Kl=g.forwardRef(((I,C)=>{let{bsPrefix:e,closeLabel:l="Close",closeVariant:A,closeButton:t=!0,className:n,children:o,...a}=I;e=He(e,"toast-header");const c=(0,g.useContext)(fl),d=kl((g=>{null==c||null==c.onClose||c.onClose(g)}));return(0,Xe.jsxs)("div",{ref:C,...a,className:Se()(e,n),children:[o,t&&(0,Xe.jsx)(Nl,{"aria-label":l,variant:A,onClick:d,"data-dismiss":"toast"})]})}));Kl.displayName="ToastHeader";const wl=Kl,Fl=g.forwardRef(((g,I)=>{let{className:C,bsPrefix:e,as:l="div",...A}=g;return e=He(e,"toast-body"),(0,Xe.jsx)(l,{ref:I,className:Se()(C,e),...A})}));Fl.displayName="ToastBody";const xl=Fl,zl=g.forwardRef(((I,C)=>{let{bsPrefix:e,className:l,transition:A=Xl,show:t=!0,animation:n=!0,delay:o=5e3,autohide:a=!1,onClose:c,onEntered:d,onExit:i,onExiting:s,onEnter:r,onEntering:b,onExited:m,bg:Z,...u}=I;e=He(e,"toast");const G=(0,g.useRef)(o),B=(0,g.useRef)(c);(0,g.useEffect)((()=>{G.current=o,B.current=c}),[o,c]);const h=Ue(),p=!(!a||!t),y=(0,g.useCallback)((()=>{p&&(null==B.current||B.current())}),[p]);(0,g.useEffect)((()=>{h.set(y,G.current)}),[h,y]);const W=(0,g.useMemo)((()=>({onClose:c})),[c]),V=!(!A||!n),S=(0,Xe.jsx)("div",{...u,ref:C,className:Se()(e,l,Z&&"bg-".concat(Z),!V&&(t?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"});return(0,Xe.jsx)(fl.Provider,{value:W,children:V&&A?(0,Xe.jsx)(A,{in:t,onEnter:r,onEntering:b,onEntered:d,onExit:i,onExiting:s,onExited:m,unmountOnExit:!0,children:S}):S})}));zl.displayName="Toast";const Ul=Object.assign(zl,{Body:xl,Header:wl}),Ql=g=>({type:kI,payload:g}),El=()=>({type:YI}),Ll=g=>({type:vI,payload:g}),Ml=g=>({type:HI,payload:g}),Dl=g=>({type:NI,payload:g}),Tl=g=>({type:wI,payload:g}),jl=g=>({type:FI,payload:g}),Pl=g=>({type:zI,payload:g}),Ol=g=>({type:QI,payload:g}),ql=g=>({type:EI,payload:g}),_l=g=>({type:LI,payload:g}),$l=g=>({type:TI,payload:g}),gA=g=>({type:jI,payload:g}),IA=g=>({type:PI,payload:g});const CA=function(){const g=j(),{showAlert:I,alertMessage:C,alertLevel:e}=B((g=>g.alertReducer));return(0,Xe.jsx)(Xe.Fragment,{children:I&&(0,Xe.jsx)(Ke,{position:"top-end",className:"p-3",style:{zIndex:1},children:(0,Xe.jsxs)(Ul,{bg:e,autohide:!0,show:I,onClose:()=>g(El()),children:[(0,Xe.jsxs)(Ul.Header,{children:[(0,Xe.jsx)("img",{src:"holder.js/20x20?text=%20",className:"rounded me-2",alt:""}),(0,Xe.jsx)("strong",{className:"me-auto",children:"Alert"})]}),(0,Xe.jsx)(Ul.Body,{className:"text-white",children:C})]})})})},eA="".concat(atob("aHR0cHM6Ly9kdGMucGVsb2NhbC5uZXQv")).concat("api/","v1"),lA=("".concat(eA,"/dmrc/process_payment/ZG1yYw/"),"https://api.whatsapp.com/send/?phone=".concat(atob("OTE4NzQ0MDczMjIz"))),AA=atob("YTlmMjAwZGUtMDhmZC00NGIzLWJiZjItOWY1NTYzNjA5NTky"),tA=atob("NjRkOTRjODY2NjRoc2RkNmRhYjY3NDk4NGdkZDljZGYzMmE2ZTc0N2UyYzE3ZTU4ZDc0OWZqaDM0NTQ5Zjc5NzZjYjA="),nA=atob("JmgidllFRDRdXWFOc3VkMCllb25bc2dZc3cxYlNfd3k="),oA=atob("ZXlKMGVYQWlPaUpLVjFRaUxDSmhiR2NpT2lKSVV6STFOaUo5LmV5SmpiR2xsYm5SZmFXUWlPaUpoT1dZeU1EQmtaUzB3T0daa0xUUTBZak10WW1KbU1pMDVaalUxTmpNMk1EazFPVElpTENKb1lYTm9Jam9pTkRWbFptWTVNbVV6T1dNeVpUQTRaVEF5Wm1JNE1EazRNR1ZoTkdFeU1UWTBZelExTVRrd01UWTNZMlE1WldVMVpUVTVPRGMyTjJZeE1tRTNOMkZoTUdabE5qWmpNVEZrWTJZeVlqYzVOVE0wT0dRNU5qUTRNV1E0TkRreFpXVmxabVF6TkRSbVlXRTBOVGhsTjJFMllUQTBNemc0WW1GbU1XTXdZVGszWlRVaUxDSmxlSEFpT2pFM05ETTJPRFk1TmpSOS5EUWpSN0tjY2EyU0xaSTV1a2hOanRiNjdTR0tfb1M4ZVZrUVptc3RXajE4"),aA="ZHRj",cA=("".concat(eA,"/dtc/fetch_route/bus/").concat(aA,"/"),"".concat(eA,"/dtc/fetch_route/").concat(aA,"/"),"".concat(eA,"/dtc/fare/").concat(aA,"/")),dA="".concat(eA,"/dtc/fetch_stop/source/").concat(aA,"/"),iA="".concat(eA,"/dtc/fetch_stop/destination/").concat(aA,"/"),sA="".concat(eA,"/dtc/fetch_route_by_stop/").concat(aA,"/"),rA="".concat(eA,"/dtc/other_initiate_payment/").concat(aA,"/"),bA="".concat(eA,"/dtc/upi_initiate_payment/").concat(aA,"/"),mA="".concat(eA,"/dtc/validate_ticket/").concat(aA,"/"),ZA="".concat(eA,"/dtc/get_last_journey/").concat(aA,"/"),uA="".concat(eA,"/dtc/validate_busno/").concat(aA,"/");var GA=C(9704),BA=C.n(GA);const hA=(g,I)=>{const C=BA().AES.decrypt(I,BA().enc.Utf8.parse(g),{mode:BA().mode.ECB});if(C){const g=C.toString(BA().enc.Utf8).trim();return JSON.parse(g)}return null},pA={home:"/cb/book-by-stop/:checksum",book_by_qr:"/cb/book-by-qr/:checksum",home_new:"/cb/:checksum/:bookTypeRequired",dtc_route:"/cb/:checksum/dtc-route",dtc_station:"/cb/:checksum/dtc-station",book_summary:"/cb/:checksum/book-summary",validate_ticket:"/cb/validate-ticket/:checksum",validate_ticket_success:"/cb/validate-ticket-success/:checksum",quike_book:"/cb/:checksum/quike-book",error:"/cb/:checksum/error",dtc_qna:"/cb/:checksum/qna"},yA=g=>{var I,C;const e=eC.getState(),l=null===e||void 0===e||null===(I=e.bookTicketReducer)||void 0===I?void 0:I.checksum,A=null===e||void 0===e||null===(C=e.bookTicketReducer)||void 0===C?void 0:C.isBookTypeRequired;let t=pA[g];return l&&t&&(t=t.replace(":checksum",l),t=t.replace(":bookTypeRequired",A)),t};const WA=function(I){const{getState:C}=eC,{isBookTypeRequired:e,bookType:l}=C().bookTicketReducer;return function(C){let A=PC(),t=qC(),n=function(){let{matches:I}=g.useContext(DC),C=I[I.length-1];return C?C.params:{}}();const{t:o,i18n:a}=BI(),c=j();return(0,g.useEffect)((()=>{if(n.checksum){const g=hA(nA,atob(n.checksum));if(console.log("key",g),"string"===typeof g&&g.includes("-")){const[I,C,A,o,d]=g.split("-");console.log("expTime",A),c({type:qI,payload:d}),c((g=>({type:KI,payload:g}))(n.checksum)),c(Dl(I)),a.changeLanguage(C),!e||l||n.bookTypeRequired||c(Tl(o)),A&&(parseInt(A)-Math.floor((new Date).getTime()/1e3))/60<=0&&(c((g=>({type:fI,payload:g}))(!0)),t(yA("error")))}}}),[n.checksum,a]),(0,Xe.jsx)(Xe.Fragment,{children:(0,Xe.jsx)(I,{...C,router:{location:A,navigate:t,params:n},t:o,i18n:a,whatsappnumber:n.whatsapp})})}},VA=g.forwardRef(((g,I)=>{let{bsPrefix:C,variant:e,animation:l="border",size:A,as:t="div",className:n,...o}=g;C=He(C,"spinner");const a="".concat(C,"-").concat(l);return(0,Xe.jsx)(t,{ref:I,...o,className:Se()(n,a,A&&"".concat(a,"-").concat(A),e&&"text-".concat(e))})}));VA.displayName="Spinner";const SA=VA,XA={type:Yl().string,tooltip:Yl().bool,as:Yl().elementType},RA=g.forwardRef(((g,I)=>{let{as:C="div",className:e,type:l="valid",tooltip:A=!1,...t}=g;return(0,Xe.jsx)(C,{...t,ref:I,className:Se()(e,"".concat(l,"-").concat(A?"tooltip":"feedback"))})}));RA.displayName="Feedback",RA.propTypes=XA;const kA=RA,JA=g.createContext({}),YA=g.forwardRef(((I,C)=>{let{id:e,bsPrefix:l,className:A,type:t="checkbox",isValid:n=!1,isInvalid:o=!1,as:a="input",...c}=I;const{controlId:d}=(0,g.useContext)(JA);return l=He(l,"form-check-input"),(0,Xe.jsx)(a,{...c,ref:C,type:t,id:e||d,className:Se()(A,l,n&&"is-valid",o&&"is-invalid")})}));YA.displayName="FormCheckInput";const vA=YA,HA=g.forwardRef(((I,C)=>{let{bsPrefix:e,className:l,htmlFor:A,...t}=I;const{controlId:n}=(0,g.useContext)(JA);return e=He(e,"form-check-label"),(0,Xe.jsx)("label",{...t,ref:C,htmlFor:A||n,className:Se()(l,e)})}));HA.displayName="FormCheckLabel";const NA=HA;const fA=g.forwardRef(((I,C)=>{let{id:e,bsPrefix:l,bsSwitchPrefix:A,inline:t=!1,reverse:n=!1,disabled:o=!1,isValid:a=!1,isInvalid:c=!1,feedbackTooltip:d=!1,feedback:i,feedbackType:s,className:r,style:b,title:m="",type:Z="checkbox",label:u,children:G,as:B="input",...h}=I;l=He(l,"form-check"),A=He(A,"form-switch");const{controlId:p}=(0,g.useContext)(JA),y=(0,g.useMemo)((()=>({controlId:e||p})),[p,e]),W=!G&&null!=u&&!1!==u||function(I,C){return g.Children.toArray(I).some((I=>g.isValidElement(I)&&I.type===C))}(G,NA),V=(0,Xe.jsx)(vA,{...h,type:"switch"===Z?"checkbox":Z,ref:C,isValid:a,isInvalid:c,disabled:o,as:B});return(0,Xe.jsx)(JA.Provider,{value:y,children:(0,Xe.jsx)("div",{style:b,className:Se()(r,W&&l,t&&"".concat(l,"-inline"),n&&"".concat(l,"-reverse"),"switch"===Z&&A),children:G||(0,Xe.jsxs)(Xe.Fragment,{children:[V,W&&(0,Xe.jsx)(NA,{title:m,children:u}),i&&(0,Xe.jsx)(kA,{type:s,tooltip:d,children:i})]})})})}));fA.displayName="FormCheck";const KA=Object.assign(fA,{Input:vA,Label:NA});C(2391);const wA=g.forwardRef(((I,C)=>{let{bsPrefix:e,type:l,size:A,htmlSize:t,id:n,className:o,isValid:a=!1,isInvalid:c=!1,plaintext:d,readOnly:i,as:s="input",...r}=I;const{controlId:b}=(0,g.useContext)(JA);return e=He(e,"form-control"),(0,Xe.jsx)(s,{...r,type:l,size:t,ref:C,readOnly:i,id:n||b,className:Se()(o,d?"".concat(e,"-plaintext"):e,A&&"".concat(e,"-").concat(A),"color"===l&&"".concat(e,"-color"),a&&"is-valid",c&&"is-invalid")})}));wA.displayName="FormControl";const FA=Object.assign(wA,{Feedback:kA}),xA=g.forwardRef(((g,I)=>{let{className:C,bsPrefix:e,as:l="div",...A}=g;return e=He(e,"form-floating"),(0,Xe.jsx)(l,{ref:I,className:Se()(C,e),...A})}));xA.displayName="FormFloating";const zA=xA,UA=g.forwardRef(((I,C)=>{let{controlId:e,as:l="div",...A}=I;const t=(0,g.useMemo)((()=>({controlId:e})),[e]);return(0,Xe.jsx)(JA.Provider,{value:t,children:(0,Xe.jsx)(l,{...A,ref:C})})}));UA.displayName="FormGroup";const QA=UA;function EA(I){let{as:C,bsPrefix:e,className:l,...A}=I;e=He(e,"col");const t=function(){const{breakpoints:I}=(0,g.useContext)(Je);return I}(),n=function(){const{minBreakpoint:I}=(0,g.useContext)(Je);return I}(),o=[],a=[];return t.forEach((g=>{const I=A[g];let C,l,t;delete A[g],"object"===typeof I&&null!=I?({span:C,offset:l,order:t}=I):C=I;const c=g!==n?"-".concat(g):"";C&&o.push(!0===C?"".concat(e).concat(c):"".concat(e).concat(c,"-").concat(C)),null!=t&&a.push("order".concat(c,"-").concat(t)),null!=l&&a.push("offset".concat(c,"-").concat(l))})),[{...A,className:Se()(l,...o,...a)},{as:C,bsPrefix:e,spans:o}]}const LA=g.forwardRef(((g,I)=>{const[{className:C,...e},{as:l="div",bsPrefix:A,spans:t}]=EA(g);return(0,Xe.jsx)(l,{...e,ref:I,className:Se()(C,!t.length&&A)})}));LA.displayName="Col";const MA=LA,DA=g.forwardRef(((I,C)=>{let{as:e="label",bsPrefix:l,column:A=!1,visuallyHidden:t=!1,className:n,htmlFor:o,...a}=I;const{controlId:c}=(0,g.useContext)(JA);l=He(l,"form-label");let d="col-form-label";"string"===typeof A&&(d="".concat(d," ").concat(d,"-").concat(A));const i=Se()(n,l,t&&"visually-hidden",A&&d);return o=o||c,A?(0,Xe.jsx)(MA,{ref:C,as:"label",className:i,htmlFor:o,...a}):(0,Xe.jsx)(e,{ref:C,className:i,htmlFor:o,...a})}));DA.displayName="FormLabel";const TA=DA,jA=g.forwardRef(((I,C)=>{let{bsPrefix:e,className:l,id:A,...t}=I;const{controlId:n}=(0,g.useContext)(JA);return e=He(e,"form-range"),(0,Xe.jsx)("input",{...t,type:"range",ref:C,className:Se()(l,e),id:A||n})}));jA.displayName="FormRange";const PA=jA,OA=g.forwardRef(((I,C)=>{let{bsPrefix:e,size:l,htmlSize:A,className:t,isValid:n=!1,isInvalid:o=!1,id:a,...c}=I;const{controlId:d}=(0,g.useContext)(JA);return e=He(e,"form-select"),(0,Xe.jsx)("select",{...c,size:A,ref:C,className:Se()(t,e,l&&"".concat(e,"-").concat(l),n&&"is-valid",o&&"is-invalid"),id:a||d})}));OA.displayName="FormSelect";const qA=OA,_A=g.forwardRef(((g,I)=>{let{bsPrefix:C,className:e,as:l="small",muted:A,...t}=g;return C=He(C,"form-text"),(0,Xe.jsx)(l,{...t,ref:I,className:Se()(e,C,A&&"text-muted")})}));_A.displayName="FormText";const $A=_A,gt=g.forwardRef(((g,I)=>(0,Xe.jsx)(KA,{...g,ref:I,type:"switch"})));gt.displayName="Switch";const It=Object.assign(gt,{Input:KA.Input,Label:KA.Label}),Ct=g.forwardRef(((g,I)=>{let{bsPrefix:C,className:e,children:l,controlId:A,label:t,...n}=g;return C=He(C,"form-floating"),(0,Xe.jsxs)(QA,{ref:I,className:Se()(e,C),controlId:A,...n,children:[l,(0,Xe.jsx)("label",{htmlFor:A,children:t})]})}));Ct.displayName="FloatingLabel";const et=Ct,lt={_ref:Yl().any,validated:Yl().bool,as:Yl().elementType},At=g.forwardRef(((g,I)=>{let{className:C,validated:e,as:l="form",...A}=g;return(0,Xe.jsx)(l,{...A,ref:I,className:Se()(C,e&&"was-validated")})}));At.displayName="Form",At.propTypes=lt;const tt=Object.assign(At,{Group:QA,Control:FA,Floating:zA,Check:KA,Switch:It,Label:TA,Text:$A,Range:PA,Select:qA,FloatingLabel:et}),nt=g.forwardRef(((g,I)=>{let{bsPrefix:C,bg:e="primary",pill:l=!1,text:A,className:t,as:n="span",...o}=g;const a=He(C,"badge");return(0,Xe.jsx)(n,{ref:I,...o,className:Se()(t,a,l&&"rounded-pill",A&&"text-".concat(A),e&&"bg-".concat(e))})}));nt.displayName="Badge";const ot=nt,at="st",ct="qr",dt=(g,I)=>{const{dispatch:C}=eC;C(((g,I,C)=>({type:JI,payload:{showAlert:g,message:I,level:C}}))(!0,g,I)),setTimeout((()=>{C(El())}),2e3)},it=["as","disabled"];function st(g){let{tagName:I,disabled:C,href:e,target:l,rel:A,role:t,onClick:n,tabIndex:o=0,type:a}=g;I||(I=null!=e||null!=l||null!=A?"a":"button");const c={tagName:I};if("button"===I)return[{type:a||"button",disabled:C},c];const d=g=>{(C||"a"===I&&function(g){return!g||"#"===g.trim()}(e))&&g.preventDefault(),C?g.stopPropagation():null==n||n(g)};return"a"===I&&(e||(e="#"),C&&(e=void 0)),[{role:null!=t?t:"button",disabled:void 0,tabIndex:C?void 0:o,href:e,target:"a"===I?l:void 0,"aria-disabled":C||void 0,rel:"a"===I?A:void 0,onClick:d,onKeyDown:g=>{" "===g.key&&(g.preventDefault(),d(g))}},c]}const rt=g.forwardRef(((g,I)=>{let{as:C,disabled:e}=g,l=function(g,I){if(null==g)return{};var C,e,l={},A=Object.keys(g);for(e=0;e<A.length;e++)C=A[e],I.indexOf(C)>=0||(l[C]=g[C]);return l}(g,it);const[A,{tagName:t}]=st(Object.assign({tagName:C,disabled:e},l));return(0,Xe.jsx)(t,Object.assign({},l,A,{ref:I}))}));rt.displayName="Button";const bt=g.forwardRef(((g,I)=>{let{as:C,bsPrefix:e,variant:l="primary",size:A,active:t=!1,disabled:n=!1,className:o,...a}=g;const c=He(e,"btn"),[d,{tagName:i}]=st({tagName:C,disabled:n,...a}),s=i;return(0,Xe.jsx)(s,{...d,...a,ref:I,disabled:n,className:Se()(o,c,t&&"active",l&&"".concat(c,"-").concat(l),A&&"".concat(c,"-").concat(A),a.href&&n&&"disabled")})}));bt.displayName="Button";const mt=bt,Zt=g=>{const{isDisabled:I,fromStation:C,destinationStation:e,setFrmStation:l,setDestStation:A,handleChangeStationEvent:t,isChangeRouteButtonEnable:n}=g,{t:o}=BI(),a=qC();return(0,Xe.jsxs)("form",{children:[(0,Xe.jsxs)("div",{className:"row",children:[(0,Xe.jsx)("div",{className:"col-5 pr-0 pl-3 text-center",children:(0,Xe.jsxs)(pe,{to:yA("dtc_station"),className:I?"disabled-link":"select-station-css",children:[(0,Xe.jsx)("label",{children:o("from")}),(0,Xe.jsx)("h6",{className:"my-1 destPoint text-center",children:C?C.stop_name:o("select_from")})]})}),(0,Xe.jsx)("div",{className:"col-2 d-flex justify-content-center align-items-center pointer-cursor",onClick:()=>{l(e),A(C),t(e,C)},children:(0,Xe.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAAAXNSR0IArs4c6QAACC9JREFUeF7tXH2MVNUV/503A6wtLIs1LHRnltmZZ+xardjSVtRIZ5Y2aY1KUaqkxmgTP9oElUBYUVM/WlugkGJNtLaJX9EoiigkjYllZiQt4gdpUShr45vd2ZnZ7kK1uyy0LOzMO819666zO5/vvftmZ8i+f9+9v3Pu75577r3n3HsJFf6iXv8isPIVXYEKIADmBSD6EoHnADR/RB3uZVA/mD8FUbcCaNB1DYR/BpOd+yupMjktLNrkW6iT+3oofAWBLrUtj/kkA/vBtFfh9LZgT/yAbcwiAI4QtLcxMPf0DF7JUG4GsNDJBgA4wDo/VTeMbZcdiR2VLUsqQbvntjQqM1ztDNxGhC/KVrYYHjP+S9Cf1E/xpqVHu47Iki2FoD2NC1oy06etBfFPAKqTpZw1HB4C01Ou08Oblxzp7rKG8Xkt2wTt9rR8TSHXcyBcZFcZqfUZH+icuWlpqutDO7iWCdoPTBv0+NdDUe4HMM2OEg7WHQbzL+qTsQ2LgGErciwRFG1SPazwiyC63IrQitdh/ivptDLYo6XMyjZNUMSrXgPipwGaY1bY5JbnfjDdEkpqO83oYYqgaFPLdbrL9TwBM8wIqZayDJxSMpkbgz1d28vVqWyCot7AGgZ+A6Ky65SrREXLMTMRrw4mOh8tR25ZjY02B25n0O/LAayVMsS8MpiMvVRK35IERb2BG3TgBSJSSoHV1H9GGrq+LNTT+adiehclKDxf/Trc/Bci+kJNNb5MZZn5f+50etGS3u6OQlUKEvTnOf7Zyiz6gEALypRXk8UYOHyWPrTo0lTqZL4GFCQo7FV3EeGqmmy1WaWZnw0lY2JjnfPlJSjqDSxjotfMyqnl8sT8w2Ay9vrENuQQdAiYftQb0EDkreUGm9adOTk3GVMvAE5n180hKNysPkjAA6YFFKkw8/xWtG7eAHd9Pf5+w40YSvXIhJeGxcBDbQntwYIECcfsmkVxgBpkSW1ZfSd8d68ag4tvfQxdv/2dLHjJONxPgxl/cCA+MAo8zoLCzeo9BPxahtQ6TxNaN29Ew+Jvj4OrboIABta3JbQNOQRFfb461l2dnwfOrdN0zveWGuS4Z9fngFQ9QYwexZVWg/H4kFB+zILC3sDNRPS0dVoAd/0sqD+/D/NXXFsQptoJEooz8y1tydgz4wiKeNW3QFhilSDhiC/8w+Oo83qKQvS+8ir6XtlhSsyJjg6kB4+bqmOrMGNPKKl9Z4yg6Dyfj6e5Oq3u1Cc6YlvK5al84h+H8f4PrpENWxiPmd3D1HhFn/ZvY4hZndqFIxZWM/Or5zuufHTBuY7LyBbA0Fe3JTq3GgRFvIHXQWS6ixbvfQuCpEp8lSYIzDtDydiyEYKaA/1W1j5nMkHM+E8oqZ1DkaaWi+ByWUrfGmudLZvQcMm3HDeiiluQaFEms5BkTO+OO+nDHXj/+1c73gkTBYjpnsLN6gYC2u1KN6b5Pz5R0if1bd+BXpPT/MA779pVz1J9BjaSVQedT6JYKJ77wP2Yd93yml4ojinPvFMQdBBEF1iiuEAlY6uxZZOxsp741cJKOougQxRuDsSdCKsWcuC1RBCDuwVBfQRqlGlB2Vi1Fe4YzwKDjwgnPeR0ptQImG3ZOBIwu/7HVRswy5nFgFMVIUiWdYphe/FLzyM9OIiOtffgxOGC2RopIkWqWgyxAQLNloLoMMjE4Soik8KnOfV9NsSc9UEylc+3IB3Y9y461rY7MmwNJ+3ENC+TlGIOf/Rf+pgYcu345M3dckUzH5K6UJSrXS5aqS2NCMZpDz8iL7gmFophT2ArKXSX042biC8WkTNbW02JnbdiedFwrgAbSqZw8LafSXHgxlYj7PXfQaQ8YUpTCYW/+cYuiOnfqU+GAzc2q3u+rF6cceNvTilaCDfY/bHjIm07cBHuYIAiXvUTIpztuMZZAipB0OiQ23d50ELTeCCUiM2xFXK1IHWsSsUISvVg32VGgsLclx1yjTb772IoW80h2CtdCYIG3nkPHWvWWVojEfS7xTlGw4JGrhK4Y1bTPlaoctpJ24oaiIOewxl/sC8eH8us2k0cWiGp4ZLxeftSGPNXLC8ajDN8TqoHB2/9qb1pfmLiUADLiE2XaqDd/6UWiiKc+/FDv7S9UMybehaHF/SMWyNCZRJdFtgqRJBISwtfI2erwb2kZPw5hxcMK5J4/MVC+0tWybtZteGI8wksePxFFI42+Bq43jgCU5X3MJyPTvJA5jj7vtvfeWyUvJwjeJFmdT2AX5XszkkoYATMtr0wEjBb027PEefX/95QQht3gGzqEOcoUeUe4jSG2tQx4DH7KniQPOINvAqiwhnASRhiTolkYHtbQluRD7/oVQTXLDoAkM8pxaoBl4EO/bi+ONsxZ+tV9DKLeCWBSXm7iu+k2uJYXGZRMplvBP8V/6gQUMnrUJEm/5Ws0K4z7ToUM+uk89W2rkONsnpGXqgD3xFMxJ4sZYIlLWgUIOwJrCKFqvWIfKl2jvvPOt/ZloqVlVArmyBj+p+61Fu6IyIedQkTdlQ6RFtas+IlmPEpMa4NpbQ9ZrBMWdCYT5p6WKA8jiNe9V4QHimv9CSVYtwXSmqW95aWLCi7qcbjJoryMkDnTRIF+cVO9uMm2Vp9dlPoYQCrquJ5HOCxUCK2TkaH2bagcdZkPLBE6xjK7RV/YAl8jJgf10/xo1X3wNLEnnrb4zn7pDL9JkC5lQCnL3IcYOjPKoP6M9k3BWVYj8CQakH5lBKp7bSCH0098lZml408E4jzoCiqDqjlPBMIIKbo0ED6R5V+JvD/patpBKGHqz4AAAAASUVORK5CYII=",width:"37",height:"32",alt:"swich station"})}),(0,Xe.jsx)("div",{className:"col-4 text-center",children:(0,Xe.jsxs)(pe,{to:yA("dtc_station"),className:I?"disabled-link":"select-station-css",children:[(0,Xe.jsx)("label",{children:o("destination")}),(0,Xe.jsx)("h6",{className:"my-2 pl-2 destPoint text-center",children:e?e.stop_name:o("select_destination")})]})})]}),(0,Xe.jsx)("div",{className:"row justify-content-center",children:(0,Xe.jsx)("div",{className:"col-6 text-center mt-1",children:(0,Xe.jsxs)(mt,{variant:"btn btn-outline-light btn-sm",style:{borderRadius:"40px",border:"2px solid #00245c"},onClick:()=>{a(yA("dtc_route"))},disabled:!n,children:[(0,Xe.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-search",style:{color:"#00245c"},viewBox:"0 0 16 16",children:(0,Xe.jsx)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"})}),"   "," ",(0,Xe.jsx)("span",{style:{color:"#00245c"},children:o("change_route_button_name")})]})})})]})},ut=I=>{const[C,e]=(0,g.useState)("");(0,g.useEffect)((()=>{I.handleBusNumberChange(C)}),[C]);return(0,Xe.jsx)("div",{className:"text-center mt-2",children:(0,Xe.jsx)("input",{style:{width:"120px",borderRadius:"0",WebkitAppearance:"none",MozAppearance:"textfield",border:"0"},type:"text",className:"input-number-value",value:C,onChange:g=>(g=>{g.target.value<=9999&&e(g.target.value)})(g),id:"otp_field"})})};var Gt=C(9008),Bt=C.n(Gt);C(2176);function ht(g){return"default"+g.charAt(0).toUpperCase()+g.substr(1)}function pt(g){var I=function(g,I){if("object"!==typeof g||null===g)return g;var C=g[Symbol.toPrimitive];if(void 0!==C){var e=C.call(g,I||"default");if("object"!==typeof e)return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===I?String:Number)(g)}(g,"string");return"symbol"===typeof I?I:String(I)}function yt(I,C){return Object.keys(C).reduce((function(e,l){var A,t=e,n=t[ht(l)],o=t[l],a=p(t,[ht(l),l].map(pt)),c=C[l],d=function(I,C,e){var l=(0,g.useRef)(void 0!==I),A=(0,g.useState)(C),t=A[0],n=A[1],o=void 0!==I,a=l.current;return l.current=o,!o&&a&&t!==C&&n(C),[o?I:t,(0,g.useCallback)((function(g){for(var I=arguments.length,C=new Array(I>1?I-1:0),l=1;l<I;l++)C[l-1]=arguments[l];e&&e.apply(void 0,[g].concat(C)),n(g)}),[e])]}(o,n,I[c]),i=d[0],s=d[1];return h({},a,((A={})[l]=i,A[c]=s,A))}),I)}function Wt(){var g=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==g&&void 0!==g&&this.setState(g)}function Vt(g){this.setState(function(I){var C=this.constructor.getDerivedStateFromProps(g,I);return null!==C&&void 0!==C?C:null}.bind(this))}function St(g,I){try{var C=this.props,e=this.state;this.props=g,this.state=I,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(C,e)}finally{this.props=C,this.state=e}}Wt.__suppressDeprecationWarning=!0,Vt.__suppressDeprecationWarning=!0,St.__suppressDeprecationWarning=!0;const Xt=I=>g.forwardRef(((g,C)=>(0,Xe.jsx)("div",{...g,ref:C,className:Se()(g.className,I)}))),Rt=Xt("h4");Rt.displayName="DivStyledAsH4";const kt=g.forwardRef(((g,I)=>{let{className:C,bsPrefix:e,as:l=Rt,...A}=g;return e=He(e,"alert-heading"),(0,Xe.jsx)(l,{ref:I,className:Se()(C,e),...A})}));kt.displayName="AlertHeading";const Jt=kt;const Yt="undefined"!==typeof C.g&&C.g.navigator&&"ReactNative"===C.g.navigator.product,vt="undefined"!==typeof document||Yt?g.useLayoutEffect:g.useEffect;new WeakMap;const Ht=["onKeyDown"];const Nt=g.forwardRef(((g,I)=>{let{onKeyDown:C}=g,e=function(g,I){if(null==g)return{};var C,e,l={},A=Object.keys(g);for(e=0;e<A.length;e++)C=A[e],I.indexOf(C)>=0||(l[C]=g[C]);return l}(g,Ht);const[l]=st(Object.assign({tagName:"a"},e)),A=kl((g=>{l.onKeyDown(g),null==C||C(g)}));return(t=e.href)&&"#"!==t.trim()&&"button"!==e.role?(0,Xe.jsx)("a",Object.assign({ref:I},e,{onKeyDown:C})):(0,Xe.jsx)("a",Object.assign({ref:I},e,l,{onKeyDown:A}));var t}));Nt.displayName="Anchor";const ft=Nt,Kt=g.forwardRef(((g,I)=>{let{className:C,bsPrefix:e,as:l=ft,...A}=g;return e=He(e,"alert-link"),(0,Xe.jsx)(l,{ref:I,className:Se()(C,e),...A})}));Kt.displayName="AlertLink";const wt=Kt,Ft=g.forwardRef(((g,I)=>{const{bsPrefix:C,show:e=!0,closeLabel:l="Close alert",closeVariant:A,className:t,children:n,variant:o="primary",onClose:a,dismissible:c,transition:d=Wl,...i}=yt(g,{show:"onClose"}),s=He(C,"alert"),r=kl((g=>{a&&a(!1,g)})),b=!0===d?Wl:d,m=(0,Xe.jsxs)("div",{role:"alert",...b?void 0:i,ref:I,className:Se()(t,s,o&&"".concat(s,"-").concat(o),c&&"".concat(s,"-dismissible")),children:[c&&(0,Xe.jsx)(Nl,{onClick:r,"aria-label":l,variant:A}),n]});return b?(0,Xe.jsx)(b,{unmountOnExit:!0,...i,ref:void 0,in:e,children:m}):e?m:null}));Ft.displayName="Alert";const xt=Object.assign(Ft,{Link:wt,Heading:Jt}),zt=I=>{const[C,e]=(0,g.useState)(""),[l,A]=(0,g.useState)(!1),[t,n]=(0,g.useState)(!1),{t:o}=BI(),a=(0,g.useCallback)((g=>{g&&g.text&&e(g.text)}),[]),c=(0,g.useCallback)((g=>{console.log("error===>>>====>>",g),console.error("error-----\x3e>",g.message)}),[]);return(0,g.useEffect)((()=>{if(C)try{const g=new URLSearchParams(C.split("?")[1]).get("bus_number");if(g){const C={bus_number:g};I.setscanneddata(C)}else{const g=JSON.parse(atob(C));A(!1),console.log("Decoded data:",g),I.setscanneddata(g),I.setscannedencryptdata(C)}}catch(g){console.error("Invalid QR code data:",g.message),A(!0)}}),[C]),(0,Xe.jsx)("div",{className:"container",children:(0,Xe.jsxs)("div",{className:"row justify-content-center",children:[l&&(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)(xt,{variant:"danger",children:o("invalid_qr")})}),(0,Xe.jsx)("div",{className:"col-6 text-center",children:(0,Xe.jsx)("div",{children:(0,Xe.jsx)("h5",{type:"button",onClick:()=>{n(!t)},className:"btn btn-success py-1 px-3",children:(0,Xe.jsx)("span",{className:"badge badge-success",style:{fontSize:"15px"},children:(0,Xe.jsx)("b",{children:o(t?"close_camera":"open_camera")})})})})}),(0,Xe.jsx)("div",{className:"col-12",children:t&&(0,Xe.jsx)(Bt(),{onScan:a,onError:c,style:{width:"100%",height:"95%"},constraints:{video:{facingMode:{exact:"environment"}}}})})]})})},Ut=g=>{let{handleClick:I,name:C,icon:e}=g;return(0,Xe.jsx)("div",{className:"d-grid gap-2 mb-2",children:(0,Xe.jsx)(mt,{variant:"light",onClick:I,className:"button-color rectangle-buy-again",children:(0,Xe.jsxs)("div",{className:"text-wrapper-buy-again",children:[e,(0,Xe.jsx)("b",{children:C})]})})})},Qt=(g,I,C,e)=>new Promise(((l,A)=>{const t={method:I,headers:C};var n,o;Object.keys(e).length>0&&(t.body=btoa((n=nA,o=JSON.stringify(e),BA().AES.encrypt(JSON.stringify(o),BA().enc.Utf8.parse(n),{mode:BA().mode.ECB}).toString()))),fetch(g,t).then((g=>g.ok?g.json():g.json().then((g=>{const I=hA(nA,g);throw new Error(I.message)})))).then((g=>{g&&g.status_code&&200!==g.status_code&&dt(g.message,"danger"),g=hA(nA,g),l(JSON.parse(g))})).catch((g=>{dt(g.message,"danger"),console.log("Error:",g),A(g)}))})),Et=g=>{var I,C,e;let{fromStation:l,destinationStation:A,route:t,noOfTicket:n,fare:o}=g;const{t:a}=BI();return(0,Xe.jsxs)(Xe.Fragment,{children:[(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsxs)("ul",{className:"list-group",children:[(0,Xe.jsx)("li",{className:" d-flex justify-content-between lh-sm",children:(0,Xe.jsxs)("div",{children:[(0,Xe.jsxs)("h6",{className:"destPoint",children:[l?l.stop_name:a("from"),(0,Xe.jsxs)("span",{children:[" ",(0,Xe.jsx)("div",{className:"arrow arrow-bar is-right mx-2"})," "]}),A?A.stop_name:a("destination"),"(",t?t.route_name:a("route_name"),")"," "]}),(0,Xe.jsxs)("small",{className:"text-muted",children:[(new Date).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"})," ","  "," ",(0,Xe.jsx)("b",{children:"|"})," ","  "," ",n," ",a("passenger")]})]})}),(0,Xe.jsxs)("li",{className:" d-flex justify-content-between mt-1",children:[(0,Xe.jsx)("div",{children:(0,Xe.jsx)("small",{className:"text-black",children:a("base_fare")})}),(0,Xe.jsxs)("span",{className:"text-black",children:["\u20b9",o.base_fare]})]}),(0,Xe.jsxs)("li",{className:" d-flex justify-content-between mt-1",children:[(0,Xe.jsx)("div",{children:(0,Xe.jsx)("small",{className:"text-black",children:a("toll")})}),(0,Xe.jsxs)("span",{className:"text-black",children:["\u20b9",null!==(I=o.toll)&&void 0!==I?I:0]})]}),(0,Xe.jsxs)("li",{className:" d-flex justify-content-between mt-2",children:[(0,Xe.jsx)("div",{children:(0,Xe.jsx)("small",{className:"text-black",children:a("passenger")})}),(0,Xe.jsx)("span",{className:"text-black",children:null!==n&&void 0!==n?n:0})]}),(0,Xe.jsxs)("li",{className:" d-flex justify-content-between mt-1",children:[(0,Xe.jsx)("div",{children:(0,Xe.jsx)("small",{className:"text-black",children:a("total_fare")})}),(0,Xe.jsx)("span",{className:"text-black",children:o.discount_amount>0?(0,Xe.jsxs)("s",{children:["\u20b9",o.total_fare]}):(0,Xe.jsxs)(Xe.Fragment,{children:["\u20b9",o.total_fare]})})]}),(0,Xe.jsx)("div",{style:{borderBottom:"1px dashed"},className:"my-2"}),(0,Xe.jsxs)("li",{className:" d-flex justify-content-between mt-1",children:[(0,Xe.jsx)("div",{children:(0,Xe.jsx)("small",{className:"text-black",children:a("discount")})}),(0,Xe.jsxs)("span",{className:"text-black",children:["- \u20b9",null!==(C=o.discount_amount)&&void 0!==C?C:0]})]}),(0,Xe.jsxs)("li",{className:" d-flex justify-content-between mt-1",children:[(0,Xe.jsx)("div",{children:(0,Xe.jsx)("small",{className:"text-black",children:a("convenience_fee")})}),(0,Xe.jsxs)("span",{className:"text-black",children:["+ \u20b9",null!==(e=o.service_charge)&&void 0!==e?e:0]})]})]})}),(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("hr",{className:"my-1"})}),(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsxs)("div",{className:" d-flex justify-content-between lh-sm",children:[(0,Xe.jsx)("div",{children:(0,Xe.jsx)("p",{className:"my-1",children:(0,Xe.jsx)("b",{children:a("grand_total")})})}),(0,Xe.jsx)("div",{children:(0,Xe.jsxs)("h6",{className:"my-1",children:["\u20b9 ",o.amount_payable_by_user]})})]})})]})},Lt={base_fare:0,total_fare:0,discount_percentage:0,amount_payable_by_user:0};class Mt extends g.Component{constructor(g){super(g),this.handleBusNumberSubmit=g=>{if(g.preventDefault(),!this.state.busNumberPrefix||!this.state.busNumberDigit||this.state.busNumberDigit.length<4)return void dt(this.props.t("enter_bus_numer_alert_msg"),"danger");console.log("Form submitted with bus number:","".concat(this.state.busNumberPrefix).concat(this.state.busNumberDigit));let I={bus_number:"".concat(this.state.busNumberPrefix).concat(this.state.busNumberDigit)};this.setScannedDataAndRedirect(I)},this.handleBusNumberChange=g=>{4===g.length?this.state.busNumberPrefix.length>2?this.setState({busNumberDigit:g,showBusNumber:!0}):(this.setState({busNumberDigit:g}),dt(this.props.t("prefix_error"),"danger")):this.setState({busNumberDigit:g})},this.handleSelectPrefix=g=>{4==this.state.busNumberDigit.length?this.setState({busNumberPrefix:g,showBusNumber:!0}):this.setState({busNumberPrefix:g})},this.handleFormChange=(g,I,C)=>{if(g&&I&&C&&parseInt(g.stop_id)>0&&parseInt(I.stop_id)>0&&parseInt(C.route_id)){var e,l;this.setState({showFareLoader:!0});const A=this.props.i18n.language,t=null!==(e=null===(l=this.props.scannedData)||void 0===l?void 0:l.bus_number)&&void 0!==e?e:"",n={route_id:parseInt(C.route_id),bus_no:t,source_stop_id:g.stop_id,destination_stop_id:parseInt(I.stop_id),is_ac:this.props.isAcBus,no_passengers:this.props.noOfTicket},o={"Content-Type":"application/json","Accept-Language":A,Authorization:oA,"Whatsapp-Account":this.props.whatsAppNumber};Qt(cA,"POST",o,n).then((g=>{g.success&&(this.props.setFare(g.data),this.setState({showFareLoader:!1}))})).catch((g=>{this.setState({showFareLoader:!1}),this.props.setFare(Lt),console.log("Error :: ",g)}))}},this.handleChangeStationEvent=(g,I)=>{g&&I&&parseInt(g.stop_id)>0&&parseInt(I.stop_id)>0&&(this.props.setFare(Lt),this.props.setRoute())},this.validateInputValues=()=>{this.props&&this.props.fromStation&&this.props.destinationStation&&parseInt(this.props.fromStation.stop_id)>0&&parseInt(this.props.destinationStation.stop_id)>0&&parseInt(this.props.route.route_id)>0?parseInt(this.props.fare.amount_payable_by_user)>0?this.props.router.navigate(yA("book_summary")):dt(this.props.t("fare_validation_error_msg"),"danger"):dt(this.props.t("Validation_error_msg"),"danger")},this.setScannedDataAndRedirect=g=>{this.props.setScannedData(g),this.props.router.navigate(yA("dtc_station"))},this.handleSwitchChange=()=>{this.props.setIsAcBus(!this.props.isAcBus)},this.addPassenger=this.addPassenger.bind(this),this.removePassenger=this.removePassenger.bind(this),this.state={showFareLoader:!1,dmrcStartTime:null,dmrcStopTime:null,metroStartTime:null,metroStopTime:null,isChangeRouteButtonEnable:!1,busNumber:"",busNumberDigit:"",busNumberPrefix:"",busNumberPrefixList:["DL1PB","DL1PC","DL1PD","DL51GD","DL51EV"],showBusNumber:!1}}addPassenger(){if(this.props&&this.props.fromStation&&this.props.destinationStation&&this.props.route&&parseInt(this.props.fromStation.stop_id)>0&&parseInt(this.props.destinationStation.stop_id)>0&&parseInt(this.props.route.route_id)>0){if(this.props.noOfTicket<6){var g,I;this.props.setNoOfTicket(this.props.noOfTicket+1),this.setState({showFareLoader:!0});const C=this.props.i18n.language,e=null!==(g=null===(I=this.props.scannedData)||void 0===I?void 0:I.bus_number)&&void 0!==g?g:"",l={route_id:parseInt(this.props.route.route_id),bus_no:e,source_stop_id:this.props.fromStation.stop_id,destination_stop_id:parseInt(this.props.destinationStation.stop_id),is_ac:this.props.isAcBus,no_passengers:this.props.noOfTicket+1},A={"Content-Type":"application/json","Accept-Language":C,Authorization:oA,"Whatsapp-Account":this.props.whatsAppNumber};Qt(cA,"POST",A,l).then((g=>{g.success&&(this.props.setFare(g.data),this.setState({showFareLoader:!1}))})).catch((g=>{this.setState({showFareLoader:!1}),this.props.setFare(Lt),console.log("Error :: ",g)}))}}else dt(this.props.t("Validation_error_msg"),"danger")}removePassenger(){if(this.props&&this.props.fromStation&&this.props.destinationStation&&this.props.route&&parseInt(this.props.fromStation.stop_id)>0&&parseInt(this.props.destinationStation.stop_id)>0&&parseInt(this.props.route.route_id)>0){if(this.props.noOfTicket>1){var g,I;this.props.setNoOfTicket(this.props.noOfTicket-1),this.setState({showFareLoader:!0});const C=this.props.i18n.language,e=null!==(g=null===(I=this.props.scannedData)||void 0===I?void 0:I.bus_number)&&void 0!==g?g:"",l={route_id:parseInt(this.props.route.route_id),bus_no:e,source_stop_id:this.props.fromStation.stop_id,destination_stop_id:parseInt(this.props.destinationStation.stop_id),is_ac:this.props.isAcBus,no_passengers:this.props.noOfTicket-1},A={"Content-Type":"application/json","Accept-Language":C,Authorization:oA,"Whatsapp-Account":this.props.whatsAppNumber};Qt(cA,"POST",A,l).then((g=>{g.success&&(this.props.setFare(g.data),this.setState({showFareLoader:!1}))})).catch((g=>{this.setState({showFareLoader:!1}),this.props.setFare(Lt),console.log("Error :: ",g)}))}}else dt(this.props.t("Validation_error_msg"),"danger")}setBookingTime(){var g,I,C,e,l,A;if(null!==(g=this.props)&&void 0!==g&&g.metroBookingTimeJson&&null!==(I=this.props)&&void 0!==I&&null!==(C=I.metroBookingTimeJson)&&void 0!==C&&C.n){const[g,I]=this.props.metroBookingTimeJson.n.split("_");this.setState({dmrcStartTime:g,dmrcStopTime:I})}if(null!==(e=this.props)&&void 0!==e&&e.metroBookingTimeJson&&null!==(l=this.props)&&void 0!==l&&null!==(A=l.metroBookingTimeJson)&&void 0!==A&&A.a){const[g,I]=this.props.metroBookingTimeJson.a.split("_");this.setState({metroStartTime:g,metroStopTime:I})}}getTimeWith12format(g){if(!g)return null;const[I,C]=g.split(":"),e=I>=12?"PM":"AM";return"".concat(I>12?I-12:I,":").concat(C," ").concat(e)}componentDidMount(){this.handleFormChange(this.props.fromStation,this.props.destinationStation,this.props.route),this.setBookingTime()}componentDidUpdate(g,I){console.log(I),this.props.isAcBus!==g.isAcBus&&this.handleFormChange(this.props.fromStation,this.props.destinationStation,this.props.route)}render(){var g,I;const{t:C}=this.props,e=this.props.bookType!==at;return(0,Xe.jsx)("div",{className:"container-sm",children:(0,Xe.jsxs)("main",{children:[(0,Xe.jsx)("div",{className:"row mt-2",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("div",{className:"card logo-box p-2",children:(0,Xe.jsx)("img",{src:"https://pelocal-dtc-bucket-production.s3.amazonaws.com/dtcImage.png",alt:"DMRC Logo"})})})}),(0,Xe.jsxs)("div",{className:"card p-1 my-2",children:[(0,Xe.jsxs)("div",{className:"row justify-content-around mb-2",children:[(0,Xe.jsx)("div",{className:"col-4 col-md-3 col-sm-4 text-center",children:(0,Xe.jsx)(Ut,{name:C("quick_book"),handleClick:()=>{this.props.router.navigate(yA("quike_book"))},icon:(0,Xe.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-ticket-perforated mx-2",viewBox:"0 0 16 16",children:[(0,Xe.jsx)("path",{d:"M4 4.85v.9h1v-.9zm7 0v.9h1v-.9zm-7 1.8v.9h1v-.9zm7 0v.9h1v-.9zm-7 1.8v.9h1v-.9zm7 0v.9h1v-.9zm-7 1.8v.9h1v-.9zm7 0v.9h1v-.9z"}),(0,Xe.jsx)("path",{d:"M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3zM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9z"})]})})}),(0,Xe.jsx)("div",{className:"col-4 col-md-3 col-sm-4 text-center",children:(0,Xe.jsx)(Ut,{name:C("qna_lable"),handleClick:()=>{this.props.router.navigate(yA("dtc_qna"))},icon:(0,Xe.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-wechat mx-2",viewBox:"0 0 16 16",children:[(0,Xe.jsx)("path",{d:"M11.176 14.429c-2.665 0-4.826-1.8-4.826-4.018 0-2.22 2.159-4.02 4.824-4.02S16 8.191 16 10.411c0 1.21-.65 2.301-1.666 3.036a.32.32 0 0 0-.12.366l.218.81a.6.6 0 0 1 .029.117.166.166 0 0 1-.162.162.2.2 0 0 1-.092-.03l-1.057-.61a.5.5 0 0 0-.256-.074.5.5 0 0 0-.142.021 5.7 5.7 0 0 1-1.576.22M9.064 9.542a.647.647 0 1 0 .557-1 .645.645 0 0 0-.646.647.6.6 0 0 0 .09.353Zm3.232.001a.646.646 0 1 0 .546-1 .645.645 0 0 0-.644.644.63.63 0 0 0 .098.356"}),(0,Xe.jsx)("path",{d:"M0 6.826c0 1.455.781 2.765 2.001 3.656a.385.385 0 0 1 .143.439l-.161.6-.1.373a.5.5 0 0 0-.032.14.19.19 0 0 0 .193.193q.06 0 .111-.029l1.268-.733a.6.6 0 0 1 .308-.088q.088 0 .171.025a6.8 6.8 0 0 0 1.625.26 4.5 4.5 0 0 1-.177-1.251c0-2.936 2.785-5.02 5.824-5.02l.15.002C10.587 3.429 8.392 2 5.796 2 2.596 2 0 4.16 0 6.826m4.632-1.555a.77.77 0 1 1-1.54 0 .77.77 0 0 1 1.54 0m3.875 0a.77.77 0 1 1-1.54 0 .77.77 0 0 1 1.54 0"})]})})})]})," "]}),(0,Xe.jsx)("div",{className:"row",children:(0,Xe.jsxs)("div",{className:"gap-2",children:[(this.props.bookType===at||this.props.disableBookType)&&(0,Xe.jsx)(Xe.Fragment,{children:(0,Xe.jsx)("div",{className:"card p-2",children:(0,Xe.jsx)(Zt,{isDisabled:e,fromStation:this.props.fromStation,destinationStation:this.props.destinationStation,setFrmStation:this.props.setFrmStation,setDestStation:this.props.setDestStation,handleChangeStationEvent:this.handleChangeStationEvent,isChangeRouteButtonEnable:!(null===(g=this.props.destinationStation)||void 0===g||!g.stop_id||null===(I=this.props.fromStation)||void 0===I||!I.stop_id)})})}),this.props.bookType===ct&&!this.props.disableBookType&&(0,Xe.jsxs)("div",{className:"card p-2",children:[(0,Xe.jsx)(zt,{setscanneddata:this.setScannedDataAndRedirect,setscannedencryptdata:this.props.setScannedEncryptData}),(0,Xe.jsx)("div",{className:"section-divider",children:(0,Xe.jsx)("span",{children:C("qr_option")})}),(0,Xe.jsx)("h4",{className:"text-center mb-1",children:(0,Xe.jsx)("b",{children:C("bus_number_title")})}),(0,Xe.jsxs)(tt,{children:[(0,Xe.jsx)(tt.Group,{children:(0,Xe.jsx)("div",{className:"row justify-content-start",children:this.state.busNumberPrefixList.map(((g,I)=>(0,Xe.jsx)("div",{className:"col-4",onClick:()=>{this.handleSelectPrefix(g)},children:(0,Xe.jsx)("h5",{className:"text-center",children:(0,Xe.jsx)(ot,{bg:"".concat(this.state.busNumberPrefix===g?"danger":"secondary"),children:g})})},I)))})}),(0,Xe.jsx)(ut,{handleBusNumberChange:this.handleBusNumberChange}),this.state.showBusNumber&&(0,Xe.jsx)("h3",{className:"text-danger text-center m-2",children:"".concat(this.state.busNumberPrefix).concat(this.state.busNumberDigit)}),(0,Xe.jsx)("div",{className:"d-grid mt-2",children:(0,Xe.jsx)(mt,{type:"submit",className:"btn btn-dark-updated text-white",onClick:this.handleBusNumberSubmit,children:C("submit_label")})})]})]})]})}),(this.props.bookType!==ct||this.props.disableBookType)&&(0,Xe.jsx)("div",{className:"row my-2",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("div",{className:"card px-2",children:(0,Xe.jsx)("ul",{className:"list-group",children:(0,Xe.jsxs)("li",{className:"d-flex justify-content-between",children:[(0,Xe.jsxs)("div",{children:[(0,Xe.jsx)("small",{className:"text-muted",children:C("fare_details")}),(0,Xe.jsx)("h6",{className:"my-1",children:this.state.showFareLoader?(0,Xe.jsx)(SA,{animation:"border",variant:"primary",size:"sm",className:"loader"}):"\u20b9".concat(this.props.fare.base_fare,"/ ").concat(C("per_person"))}),(0,Xe.jsx)("div",{className:"mx-4 my-1",style:{color:this.props.isAcBus?"red":"green",fontWeight:"bold"},children:(0,Xe.jsx)(tt.Check,{type:"switch",id:"custom-switch",label:this.props.isAcBus?C("ac_bus"):C("non_ac_bus"),defaultChecked:this.props.isAcBus,onChange:this.handleSwitchChange,style:{transform:"scale(1.2)"}})})]}),(0,Xe.jsxs)("div",{className:"text-right",children:[(0,Xe.jsx)("small",{className:"text-muted ",children:C("add_passenger")}),(0,Xe.jsx)("h6",{className:"my-2",children:(0,Xe.jsxs)("div",{className:"counter d-flex justify-content-center align-items-center",children:[(0,Xe.jsx)("span",{className:"minus",onClick:this.removePassenger,children:"-"}),(0,Xe.jsx)("span",{className:"num",children:this.props.noOfTicket}),(0,Xe.jsx)("span",{className:"plus",onClick:this.addPassenger,children:"+"})]})})]})]})})})})}),(this.props.bookType!==ct||this.props.disableBookType)&&(0,Xe.jsxs)(Xe.Fragment,{children:[(0,Xe.jsx)("div",{className:"row my-2",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("div",{className:"card py-2 px-3",children:(0,Xe.jsx)("div",{className:"row",children:(0,Xe.jsx)(Et,{fromStation:this.props.fromStation,destinationStation:this.props.destinationStation,route:this.props.route,noOfTicket:this.props.noOfTicket,fare:this.props.fare})})})})}),(0,Xe.jsx)("div",{className:"row d-flex justify-content-between px-2 align-items-center",children:(0,Xe.jsx)(mt,{onClick:()=>this.validateInputValues(),className:"btn btn-dark-updated text-white",variant:"button",children:C("continue")})})]})]})})}}const Dt=E((g=>({fromStation:g.bookTicketReducer.fromStation,destinationStation:g.bookTicketReducer.destinationStation,fare:g.bookTicketReducer.fare,noOfTicket:g.bookTicketReducer.noOfTicket,metroType:g.bookTicketReducer.metroType,whatsAppNumber:g.bookTicketReducer.whatsAppNumber,isairportlinedisable:g.bookTicketReducer.isAirportLineDisable,isnormallinedisable:g.bookTicketReducer.isNormalLineDisable,isAirportBookingDisable:g.bookTicketReducer.isAirportBookingDisable,isDMRCBookingDisable:g.bookTicketReducer.isDMRCBookingDisable,isAirportLineTicketAlreadyGen:g.bookTicketReducer.isAirportLineTicketAlreadyGen,airportLineTicketAlreadyGenMsg:g.bookTicketReducer.airportLineTicketAlreadyGenMsg,metroBookingTimeJson:g.bookTicketReducer.metroBookingTimeJson,checksum:g.bookTicketReducer.checksum,bookType:g.bookTicketReducer.bookType,route:g.bookTicketReducer.route,scannedData:g.bookTicketReducer.scannedData,isAcBus:g.bookTicketReducer.isAcBus,disableBookType:g.bookTicketReducer.disableBookType})),{setFrmStation:jl,setDestStation:Pl,setNoOfTicket:Ll,setMetroType:Ml,setFare:Ql,setWhatsappNumber:Dl,setBookType:Tl,setRoute:Ol,setScannedData:ql,setScannedEncryptData:_l,setIsAcBus:gA,setDisableBookType:IA})(WA(Mt));const Tt=function(){for(var g=arguments.length,I=new Array(g),C=0;C<g;C++)I[C]=arguments[C];return I.filter((g=>null!=g)).reduce(((g,I)=>{if("function"!==typeof I)throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return null===g?I:function(){for(var C=arguments.length,e=new Array(C),l=0;l<C;l++)e[l]=arguments[l];g.apply(this,e),I.apply(this,e)}}),null)},jt={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function Pt(g,I){const C=I["offset".concat(g[0].toUpperCase()).concat(g.slice(1))],e=jt[g];return C+parseInt(Al(I,e[0]),10)+parseInt(Al(I,e[1]),10)}const Ot={[De]:"collapse",[Pe]:"collapsing",[Te]:"collapsing",[je]:"collapse show"},qt=g.forwardRef(((I,C)=>{let{onEnter:e,onEntering:l,onEntered:A,onExit:t,onExiting:n,className:o,children:a,dimension:c="height",in:d=!1,timeout:i=300,mountOnEnter:s=!1,unmountOnExit:r=!1,appear:b=!1,getDimensionValue:m=Pt,...Z}=I;const u="function"===typeof c?c():c,G=(0,g.useMemo)((()=>Tt((g=>{g.style[u]="0"}),e)),[u,e]),B=(0,g.useMemo)((()=>Tt((g=>{const I="scroll".concat(u[0].toUpperCase()).concat(u.slice(1));g.style[u]="".concat(g[I],"px")}),l)),[u,l]),h=(0,g.useMemo)((()=>Tt((g=>{g.style[u]=null}),A)),[u,A]),p=(0,g.useMemo)((()=>Tt((g=>{g.style[u]="".concat(m(u,g),"px"),Zl(g)}),t)),[t,m,u]),y=(0,g.useMemo)((()=>Tt((g=>{g.style[u]=null}),n)),[u,n]);return(0,Xe.jsx)(hl,{ref:C,addEndListener:ml,...Z,"aria-expanded":Z.role?d:null,onEnter:G,onEntering:B,onEntered:h,onExit:p,onExiting:y,childRef:a.ref,in:d,timeout:i,mountOnEnter:s,unmountOnExit:r,appear:b,children:(I,C)=>g.cloneElement(a,{...C,className:Se()(o,a.props.className,Ot[I],"width"===u&&"collapse-horizontal")})})}));var _t=function(g,I){return _t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,I){g.__proto__=I}||function(g,I){for(var C in I)I.hasOwnProperty(C)&&(g[C]=I[C])},_t(g,I)};var $t=function(){return $t=Object.assign||function(g){for(var I,C=1,e=arguments.length;C<e;C++)for(var l in I=arguments[C])Object.prototype.hasOwnProperty.call(I,l)&&(g[l]=I[l]);return g},$t.apply(this,arguments)};var gn="Pixel",In="Percent",Cn={unit:In,value:.8};function en(g){return"number"===typeof g?{unit:In,value:100*g}:"string"===typeof g?g.match(/^(\d*(\.\d+)?)px$/)?{unit:gn,value:parseFloat(g)}:g.match(/^(\d*(\.\d+)?)%$/)?{unit:In,value:parseFloat(g)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),Cn):(console.warn("scrollThreshold should be string or number"),Cn)}var ln=function(I){function C(g){var C=I.call(this,g)||this;return C.lastScrollTop=0,C.actionTriggered=!1,C.startY=0,C.currentY=0,C.dragging=!1,C.maxPullDownDistance=0,C.getScrollableTarget=function(){return C.props.scrollableTarget instanceof HTMLElement?C.props.scrollableTarget:"string"===typeof C.props.scrollableTarget?document.getElementById(C.props.scrollableTarget):(null===C.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},C.onStart=function(g){C.lastScrollTop||(C.dragging=!0,g instanceof MouseEvent?C.startY=g.pageY:g instanceof TouchEvent&&(C.startY=g.touches[0].pageY),C.currentY=C.startY,C._infScroll&&(C._infScroll.style.willChange="transform",C._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},C.onMove=function(g){C.dragging&&(g instanceof MouseEvent?C.currentY=g.pageY:g instanceof TouchEvent&&(C.currentY=g.touches[0].pageY),C.currentY<C.startY||(C.currentY-C.startY>=Number(C.props.pullDownToRefreshThreshold)&&C.setState({pullToRefreshThresholdBreached:!0}),C.currentY-C.startY>1.5*C.maxPullDownDistance||C._infScroll&&(C._infScroll.style.overflow="visible",C._infScroll.style.transform="translate3d(0px, "+(C.currentY-C.startY)+"px, 0px)")))},C.onEnd=function(){C.startY=0,C.currentY=0,C.dragging=!1,C.state.pullToRefreshThresholdBreached&&(C.props.refreshFunction&&C.props.refreshFunction(),C.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame((function(){C._infScroll&&(C._infScroll.style.overflow="auto",C._infScroll.style.transform="none",C._infScroll.style.willChange="unset")}))},C.onScrollListener=function(g){"function"===typeof C.props.onScroll&&setTimeout((function(){return C.props.onScroll&&C.props.onScroll(g)}),0);var I=C.props.height||C._scrollableNode?g.target:document.documentElement.scrollTop?document.documentElement:document.body;C.actionTriggered||((C.props.inverse?C.isElementAtTop(I,C.props.scrollThreshold):C.isElementAtBottom(I,C.props.scrollThreshold))&&C.props.hasMore&&(C.actionTriggered=!0,C.setState({showLoader:!0}),C.props.next&&C.props.next()),C.lastScrollTop=I.scrollTop)},C.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:g.dataLength},C.throttledOnScrollListener=function(g,I,C,e){var l,A=!1,t=0;function n(){l&&clearTimeout(l)}function o(){var o=this,a=Date.now()-t,c=arguments;function d(){t=Date.now(),C.apply(o,c)}A||(e&&!l&&d(),n(),void 0===e&&a>g?d():!0!==I&&(l=setTimeout(e?function(){l=void 0}:d,void 0===e?g-a:g)))}return"boolean"!==typeof I&&(e=C,C=I,I=void 0),o.cancel=function(){n(),A=!0},o}(150,C.onScrollListener).bind(C),C.onStart=C.onStart.bind(C),C.onMove=C.onMove.bind(C),C.onEnd=C.onEnd.bind(C),C}return function(g,I){function C(){this.constructor=g}_t(g,I),g.prototype=null===I?Object.create(I):(C.prototype=I.prototype,new C)}(C,I),C.prototype.componentDidMount=function(){if("undefined"===typeof this.props.dataLength)throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"===typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!==typeof this.props.refreshFunction))throw new Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},C.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},C.prototype.componentDidUpdate=function(g){this.props.dataLength!==g.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},C.getDerivedStateFromProps=function(g,I){return g.dataLength!==I.prevDataLength?$t($t({},I),{prevDataLength:g.dataLength}):null},C.prototype.isElementAtTop=function(g,I){void 0===I&&(I=.8);var C=g===document.body||g===document.documentElement?window.screen.availHeight:g.clientHeight,e=en(I);return e.unit===gn?g.scrollTop<=e.value+C-g.scrollHeight+1:g.scrollTop<=e.value/100+C-g.scrollHeight+1},C.prototype.isElementAtBottom=function(g,I){void 0===I&&(I=.8);var C=g===document.body||g===document.documentElement?window.screen.availHeight:g.clientHeight,e=en(I);return e.unit===gn?g.scrollTop+C>=g.scrollHeight-e.value:g.scrollTop+C>=e.value/100*g.scrollHeight},C.prototype.render=function(){var I=this,C=$t({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),e=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),l=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return g.createElement("div",{style:l,className:"infinite-scroll-component__outerdiv"},g.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(g){return I._infScroll=g},style:C},this.props.pullDownToRefresh&&g.createElement("div",{style:{position:"relative"},ref:function(g){return I._pullDown=g}},g.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!e&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},C}(g.Component);const An=ln,tn=g=>(0,Xe.jsx)("ul",{className:"list-group text-station",children:g.stationlist.map(((I,C)=>(0,Xe.jsx)("li",{className:"d-flex justify-content-start ".concat(g.isRouteView?"p-1":""),onClick:C=>{C.preventDefault(),g.handlestopselect(I)},children:(0,Xe.jsx)("div",{className:"container",children:(0,Xe.jsx)("div",{className:"row justify-content-between",children:(0,Xe.jsxs)("div",{className:"col-12",children:[g.isRouteView?(0,Xe.jsx)("img",{className:"mx-3",src:0===C?"https://pelocal-dtc-bucket-production.s3.amazonaws.com/start_route.png":C===g.stationlist.length-1?"https://pelocal-dtc-bucket-production.s3.amazonaws.com/end_route.png":"https://pelocal-dtc-bucket-production.s3.amazonaws.com/middle_route.png",height:"50"}):(0,Xe.jsx)("img",{className:"mx-3",src:"https://pelocal-dtc-bucket-production.s3.amazonaws.com/bus-stop.svg"}),(0,Xe.jsx)("span",{style:{color:"#00245c"},children:I.stop_name})]})})})},I.stop_id)))}),nn=I=>{const[C,e]=(0,g.useState)({}),{t:l}=BI();return(0,Xe.jsx)("ul",{className:"list-group text-station",children:I.routelist.map((g=>(0,Xe.jsx)("li",{className:"d-flex justify-content-end",nonce:"rC4ZY4lEZ7zo1RPLMB8YTA",children:(0,Xe.jsxs)("div",{className:"container",children:[(0,Xe.jsxs)("div",{className:"row justify-content-between",children:[(0,Xe.jsxs)("div",{className:"col-10",onClick:()=>{I.handlerouteselect(g)},children:[(0,Xe.jsx)("b",{style:{color:"#00245c"},children:g.route_name}),g.arrival_time&&g.arrival_time.length>0&&(0,Xe.jsxs)("p",{className:"mb-0 mt-1",children:[(0,Xe.jsx)("b",{children:"Arrival Time : "})," ",g.arrival_time.slice(0,3).map(((g,I)=>(0,Xe.jsxs)("span",{className:"text-success",children:[g,(0,Xe.jsx)("b",{children:2!=I&&", "})]},I)))]}),(0,Xe.jsxs)("p",{className:"mb-0 mt-1",children:[g.stop?g.stop.length:0," ",l("stops")]})]}),(0,Xe.jsx)("div",{className:"col-2",children:(0,Xe.jsx)(Xe.Fragment,{children:(0,Xe.jsx)(mt,{onClick:()=>{return I=g.route_id,void e((g=>({...g,[I]:!g[I]})));var I},"aria-controls":"example-collapse-text-".concat(g.route_id),variant:"outlined","aria-expanded":C[g.route_id],style:{border:"2px solid #fd7e14",color:"#fd7e14"},children:C[g.route_id]?(0,Xe.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-caret-down-fill",viewBox:"0 0 16 16",children:(0,Xe.jsx)("path",{d:"M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})}):(0,Xe.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-caret-left-fill",viewBox:"0 0 16 16",children:(0,Xe.jsx)("path",{d:"m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z"})})})})})]}),(0,Xe.jsx)("div",{className:"row",children:(0,Xe.jsx)(qt,{in:C[g.route_id],children:(0,Xe.jsx)("div",{id:"example-collapse-text-".concat(g.route_id),children:(0,Xe.jsx)(tn,{handlestopselect:()=>{},isRouteView:!0,stationlist:g.stop})})})})]})},g.route_id)))})},on=E((g=>({bookType:g.bookTicketReducer.bookType,route:g.bookTicketReducer.route,scannedData:g.bookTicketReducer.scannedData,scannedEncryptedData:g.bookTicketReducer.scannedEncryptedData,fromStation:g.bookTicketReducer.fromStation,destinationStation:g.bookTicketReducer.destinationStation,whatsAppNumber:g.bookTicketReducer.whatsAppNumber})),{setRoute:Ol,setBookTypeTequired:$l,setBookType:Tl,setDisableBookType:IA})((I=>{const[C,e]=(0,g.useState)(!1),{t:l,i18n:A}=BI(),t=qC(),n=(0,g.useRef)(null),[o,a]=(0,g.useState)([]),[c,d]=(0,g.useState)(""),i=g=>{const C=A.language,l={source_stop_id:I.fromStation.stop_id,dest_stop_id:I.destinationStation.stop_id,offset:1,page_size:30,route_name:g},t={"Content-Type":"text/plain","Accept-Language":C,Authorization:oA,"Whatsapp-Account":I.whatsAppNumber};e(!0),Qt(sA,"POST",t,l).then((g=>{g.success&&a(g.data),e(!1)}))};return(0,g.useEffect)((()=>{var g,C;null!==(g=I.fromStation)&&void 0!==g&&g.stop_id&&null!==(C=I.destinationStation)&&void 0!==C&&C.stop_id&&i(c)}),[]),(0,Xe.jsx)("div",{className:"container-sm",children:(0,Xe.jsx)("div",{className:"customBox",children:(0,Xe.jsxs)("div",{className:"col-12 from-to-pop-up",children:[(0,Xe.jsxs)("div",{className:"row mb-0 stationBox",children:[(0,Xe.jsxs)("div",{className:"col-12",children:[(0,Xe.jsxs)("div",{className:"d-flex justify-content-between lh-sm p-2 py-3 ",children:[(0,Xe.jsx)("h5",{className:"my-1",children:l("routes_search")}),(0,Xe.jsx)("button",{type:"button",id:"close-button",className:"btn-close","aria-label":"Close",onClick:()=>{t(yA("home"))}})]}),(0,Xe.jsx)("div",{className:"d-flex justify-content-between lh-sm px-2",children:(0,Xe.jsxs)("h6",{children:[I.fromStation.stop_name," ",(0,Xe.jsx)("span",{children:(0,Xe.jsx)("div",{className:"arrow arrow-bar is-right mx-2"})}),I.destinationStation.stop_name]})})]}),(0,Xe.jsx)("div",{className:"col-12 ps-0 pe-0",children:(0,Xe.jsx)("hr",{className:"my-0"})})]}),(0,Xe.jsx)("div",{className:"tab-content",children:(0,Xe.jsxs)("div",{className:"tab-pane fade show show active",id:"fromTab",role:"tabpanel",children:[(0,Xe.jsx)("div",{className:"row my-0 searchSec",children:(0,Xe.jsx)("div",{className:"col-12 ps-0 pe-0",children:(0,Xe.jsx)("div",{className:"input-group",children:(0,Xe.jsx)("input",{type:"text",className:"form-control searchBox",placeholder:l("search_route_name_msg"),onChange:g=>{d(g.target.value);const I=g.target.value;(I.length>1||!I)&&i(I)},ref:n})})})}),C?(0,Xe.jsx)("div",{className:"row searchSec background-white",children:(0,Xe.jsx)("div",{className:"col-12 my-5 ps-0 pe-0 bg-white",children:(0,Xe.jsx)("div",{className:"text-center",children:(0,Xe.jsx)("div",{className:"spinner-grow text-primary",role:"status"})})})}):(0,Xe.jsx)("div",{className:"row my-0 bg-white",children:(0,Xe.jsx)("div",{className:"col-12 px-0",children:(0,Xe.jsx)("div",{className:"col-12 ps-0 pe-0",children:(0,Xe.jsx)(An,{dataLength:o.length,next:()=>{setTimeout((()=>{(void 0).setState({items:(void 0).state.items.concat(Array.from({length:20}))})}),1500)},hasMore:!1,loader:(0,Xe.jsx)("h4",{children:"Loading..."}),children:o.length>0?(0,Xe.jsx)(nn,{handlerouteselect:g=>{I.setRoute(g),I.setDisableBookType(!0),I.setBookTypeTequired(!1),t(yA("home_new"))},routelist:o,fromStation:I.fromStation,destinationStation:I.destinationStation}):(0,Xe.jsx)("ul",{className:"list-group text-station",children:(0,Xe.jsx)("li",{children:l("no_route_found")})})})})})})]})})]})})})})),an="fromTab",cn="destinationTab",dn=()=>(0,Xe.jsx)("p",{className:"d-flex text-station justify-content-start p-1",children:"Loading..."}),sn=E((g=>({whatsAppNumber:g.bookTicketReducer.whatsAppNumber,bookType:g.bookTicketReducer.bookType,stationlist:g.bookTicketReducer.stationList,airportlinestationlist:g.bookTicketReducer.airportLineStationList,fromStationList:g.bookTicketReducer.fromStationList,destinationStationList:g.bookTicketReducer.destinationStationList,fromStation:g.bookTicketReducer.fromStation,isAcBus:g.bookTicketReducer.isAcBus,scannedData:g.bookTicketReducer.scannedData})),{setFrmStation:jl,setDestStation:Pl,setBookType:Tl,setFromStationList:g=>({type:MI,payload:g}),setDestinationStationList:g=>({type:DI,payload:g}),setBookTypeTequired:$l,appendFrmStation:g=>({type:xI,payload:g}),appendDestStation:g=>({type:UI,payload:g}),setRoute:Ol})((I=>{var C;let{setDestStation:e,setFrmStation:l,fromStationList:A,destinationStationList:t,setFromStationList:n,setDestinationStationList:o,setBookTypeTequired:a,whatsAppNumber:c,fromStation:d,isAcBus:i,appendFrmStation:s,appendDestStation:r,setRoute:b,scannedData:m}=I;const{t:Z,i18n:u}=BI(),G=qC(),[B,h]=(0,g.useState)(an),[p,y]=(0,g.useState)(an),[W,V]=(0,g.useState)(""),[S,X]=(0,g.useState)(1),[R,k]=(0,g.useState)(1),[J,Y]=(0,g.useState)(""),[v,H]=(0,g.useState)(""),[N,f]=(0,g.useState)(""),K=(0,g.useRef)(null),w=(0,g.useRef)(null),F=g=>{y(g),g===an?K.current.focus():g===cn&&w.current.focus()},x=g=>{var I;const C=u.language,e={stop_name:g,offset:S,page_size:20,is_ac:i,bus_number:null!==(I=null===m||void 0===m?void 0:m.bus_number)&&void 0!==I?I:""},l={"Content-Type":"application/json","Accept-Language":C,Authorization:oA,"Whatsapp-Account":c};h(!0),Qt(dA,"POST",l,e).then((g=>{g.success&&(h(!1),n(g.data))})).catch((g=>{h(!1),console.log("Error :: ",g)}))},z=g=>{var I;const C=u.language,e={source_stop_id:d.stop_id,stop_name:g,offset:1,page_size:20,bus_number:null!==(I=null===m||void 0===m?void 0:m.bus_number)&&void 0!==I?I:""},l={"Content-Type":"text/plain","Accept-Language":C,Authorization:oA,"Whatsapp-Account":c};h(!0),Qt(iA,"POST",l,e).then((g=>{g.success&&(h(!1),o(g.data))})).catch((g=>{h(!1),console.log("Error :: ",g)}))};return(0,g.useEffect)((()=>{p==an?(console.log("activeTab: from",p),x(v)):p==cn&&(console.log("activeTab: des",p),z(N))}),[p,W,J]),(0,Xe.jsx)("div",{className:"container-sm",children:(0,Xe.jsx)("div",{className:"customBox",children:(0,Xe.jsxs)("div",{className:"col-12 from-to-pop-up",children:[(0,Xe.jsxs)("div",{className:"row mb-0 stationBox",children:[(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsxs)("div",{className:"d-flex justify-content-between lh-sm p-2 py-3 ",children:[(0,Xe.jsx)("h5",{className:"my-1",children:Z("stops_search")}),(0,Xe.jsx)("button",{type:"button",id:"close-button",className:"btn-close","aria-label":"Close",onClick:()=>{G(yA("home"))}})]})}),(0,Xe.jsx)("div",{className:"col-12 ps-0 pe-0",children:(0,Xe.jsx)("hr",{className:"my-0"})})]}),(0,Xe.jsx)("div",{className:"row mb-0 bg-white",children:(0,Xe.jsxs)("div",{className:"col-12 mt-3",children:[(0,Xe.jsxs)("ul",{className:"nav px-2 custom-nav-tabs",id:"myTab",role:"tablist",children:[(0,Xe.jsx)("li",{className:"nav-item",role:"presentation",children:(0,Xe.jsx)("button",{className:"btn ".concat(p===an?"btn-outline-danger active":"btn-outline-secondary"," select-station-hover btn-sm me-3"),id:"from-tab",onClick:g=>{g.preventDefault(),F(an)},children:Z("from")})}),(0,Xe.jsx)("li",{className:"nav-item",role:"presentation",children:(0,Xe.jsx)("button",{className:"btn ".concat(p===cn?"btn-outline-danger active":"btn-outline-secondary"," select-station-hover btn-sm"),id:"destination-tab",disabled:!W,onClick:()=>F(cn),children:Z("destination")})})]}),(0,Xe.jsx)("div",{className:"col-12 mx-2 my-2",children:(0,Xe.jsxs)("p",{children:[(0,Xe.jsx)("b",{children:"Source : "})," ",null!==(C=null===d||void 0===d?void 0:d.stop_name)&&void 0!==C?C:""]})})]})}),(0,Xe.jsxs)("div",{className:"tab-content",children:[(0,Xe.jsxs)("div",{className:"tab-pane fade show ".concat(p===an?"active":""),id:"fromTab",role:"tabpanel",children:[(0,Xe.jsx)("div",{className:"row my-0 searchSec",children:(0,Xe.jsx)("div",{className:"col-12 ps-0 pe-0",children:(0,Xe.jsx)("div",{className:"input-group",children:(0,Xe.jsx)("input",{type:"text",className:"form-control searchBox",placeholder:Z("search_from_station_msg"),onChange:g=>{H(g.target.value);let I=g.target.value;(I.length>1||!I)&&(X(1),x(I))},value:v,ref:K})})})}),B?(0,Xe.jsx)("div",{className:"row searchSec background-white",children:(0,Xe.jsx)("div",{className:"col-12 my-5 ps-0 pe-0 bg-white",children:(0,Xe.jsx)("div",{className:"text-center",children:(0,Xe.jsx)("div",{className:"spinner-grow text-primary",role:"status"})})})}):(0,Xe.jsx)("div",{className:"row my-0 bg-white",children:(0,Xe.jsx)("div",{className:"col-12 px-0",children:(0,Xe.jsx)("div",{className:"col-12 ps-0 pe-0",children:(0,Xe.jsx)(An,{dataLength:A.length,next:()=>{const g=S+1;X(g),((g,I)=>{var C;const e=u.language,l={stop_name:g,offset:I,page_size:20,is_ac:i,bus_number:null!==(C=null===m||void 0===m?void 0:m.bus_number)&&void 0!==C?C:""};Qt(dA,"POST",{"Content-Type":"application/json","Accept-Language":e,Authorization:oA,"Whatsapp-Account":c},l).then((g=>{g.success&&s(g.data)})).catch((g=>{console.log("Error :: ",g)}))})(v,g)},hasMore:!0,loader:dn,children:A.length>0?(0,Xe.jsx)(tn,{isRouteView:!1,handlestopselect:g=>{V(g),l(g),y(cn),b(null),e(null)},stationlist:A}):(0,Xe.jsx)("ul",{className:"list-group text-station",children:(0,Xe.jsx)("li",{children:Z("no_stop_found")})})})})})})]}),(0,Xe.jsxs)("div",{className:"tab-pane fade ".concat(p===cn?"show active":""),id:"destinationTab",role:"tabpanel",children:[(0,Xe.jsx)("div",{className:"row my-0 searchSec",children:(0,Xe.jsx)("div",{className:"col-12 ps-0 pe-0",children:(0,Xe.jsx)("form",{onSubmit:g=>{g.preventDefault()},children:(0,Xe.jsx)("div",{className:"input-group",children:(0,Xe.jsx)("input",{type:"text",className:"form-control searchBox",placeholder:Z("search_destination_station_msg"),onChange:g=>{f(g.target.value);let I=g.target.value;(I.length>1||!I)&&(k(1),z(I))},ref:w})})})})}),B?(0,Xe.jsx)("div",{className:"row searchSec background-white",children:(0,Xe.jsx)("div",{className:"col-12 my-5 ps-0 pe-0 bg-white",children:(0,Xe.jsx)("div",{className:"text-center",children:(0,Xe.jsx)("div",{className:"spinner-grow text-primary",role:"status"})})})}):(0,Xe.jsx)("div",{className:"row my-0 bg-white",children:(0,Xe.jsx)("div",{className:"col-12 px-0",children:(0,Xe.jsx)("div",{className:"col-12 ps-0 pe-0",children:(0,Xe.jsx)(An,{dataLength:t.length,next:()=>{const g=R+1;k(g),((g,I)=>{if(p==cn){var C;const e=u.language,l={source_stop_id:d.stop_id,stop_name:g,offset:I,page_size:20,bus_number:null!==(C=null===m||void 0===m?void 0:m.bus_number)&&void 0!==C?C:""};Qt(iA,"POST",{"Content-Type":"text/plain","Accept-Language":e,Authorization:oA,"Whatsapp-Account":c},l).then((g=>{g.success&&r(g.data)})).catch((g=>{console.log("Error :: ",g)}))}})(N,g)},hasMore:!0,loader:dn,children:A.length>0?(0,Xe.jsx)(tn,{handlestopselect:g=>{e(g),Y(g),a(!1),G(yA("dtc_route"))},stationlist:t}):(0,Xe.jsx)("ul",{className:"list-group text-station",children:(0,Xe.jsx)("li",{children:Z("no_stop_found")})})})})})})]})]})]})})})}));var rn;function bn(g){if((!rn&&0!==rn||g)&&tl){var I=document.createElement("div");I.style.position="absolute",I.style.top="-9999px",I.style.width="50px",I.style.height="50px",I.style.overflow="scroll",document.body.appendChild(I),rn=I.offsetWidth-I.clientWidth,document.body.removeChild(I)}return rn}function mn(g){void 0===g&&(g=$e());try{var I=g.activeElement;return I&&I.nodeName?I:null}catch(Bo){return g.body}}function Zn(g,I){return g.contains?g.contains(I):g.compareDocumentPosition?g===I||!!(16&g.compareDocumentPosition(I)):void 0}const un=(Gn="modal-open","".concat("data-rr-ui-").concat(Gn));var Gn;const Bn=class{constructor(){let{ownerDocument:g,handleContainerOverflow:I=!0,isRTL:C=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.handleContainerOverflow=I,this.isRTL=C,this.modals=[],this.ownerDocument=g}getScrollbarWidth(){return function(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const I=g.defaultView;return Math.abs(I.innerWidth-g.documentElement.clientWidth)}(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(g){}removeModalAttributes(g){}setContainerStyle(g){const I={overflow:"hidden"},C=this.isRTL?"paddingLeft":"paddingRight",e=this.getElement();g.style={overflow:e.style.overflow,[C]:e.style[C]},g.scrollBarWidth&&(I[C]="".concat(parseInt(Al(e,C)||"0",10)+g.scrollBarWidth,"px")),e.setAttribute(un,""),Al(e,I)}reset(){[...this.modals].forEach((g=>this.remove(g)))}removeContainerStyle(g){const I=this.getElement();I.removeAttribute(un),Object.assign(I.style,g.style)}add(g){let I=this.modals.indexOf(g);return-1!==I?I:(I=this.modals.length,this.modals.push(g),this.setModalAttributes(g),0!==I||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),I)}remove(g){const I=this.modals.indexOf(g);-1!==I&&(this.modals.splice(I,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(g))}isTopModal(g){return!!this.modals.length&&this.modals[this.modals.length-1]===g}},hn=(0,g.createContext)(tl?window:void 0);hn.Provider;function pn(){return(0,g.useContext)(hn)}const yn=(g,I)=>tl?null==g?(I||$e()).body:("function"===typeof g&&(g=g()),g&&"current"in g&&(g=g.current),g&&("nodeType"in g||g.getBoundingClientRect)?g:null):null;const Wn=function(I){let{children:C,in:e,onExited:l,mountOnEnter:A,unmountOnExit:t}=I;const n=(0,g.useRef)(null),o=(0,g.useRef)(e),a=kl(l);(0,g.useEffect)((()=>{e?o.current=!0:a(n.current)}),[e,a]);const c=Gl(n,C.ref),d=(0,g.cloneElement)(C,{ref:c});return e?d:t||!o.current&&A?null:d};function Vn(I){let{children:C,in:e,onExited:l,onEntered:A,transition:t}=I;const[n,o]=(0,g.useState)(!e);e&&n&&o(!1);const a=function(I){let{in:C,onTransition:e}=I;const l=(0,g.useRef)(null),A=(0,g.useRef)(!0),t=kl(e);return vt((()=>{if(!l.current)return;let g=!1;return t({in:C,element:l.current,initial:A.current,isStale:()=>g}),()=>{g=!0}}),[C,t]),vt((()=>(A.current=!1,()=>{A.current=!0})),[]),l}({in:!!e,onTransition:g=>{Promise.resolve(t(g)).then((()=>{g.isStale()||(g.in?null==A||A(g.element,g.initial):(o(!0),null==l||l(g.element)))}),(I=>{throw g.in||o(!0),I}))}}),c=Gl(a,C.ref);return n&&!e?null:(0,g.cloneElement)(C,{ref:c})}function Sn(g,I,C){return g?(0,Xe.jsx)(g,Object.assign({},C)):I?(0,Xe.jsx)(Vn,Object.assign({},C,{transition:I})):(0,Xe.jsx)(Wn,Object.assign({},C))}const Xn=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];let Rn;function kn(I){const C=pn(),e=I||function(g){return Rn||(Rn=new Bn({ownerDocument:null==g?void 0:g.document})),Rn}(C),l=(0,g.useRef)({dialog:null,backdrop:null});return Object.assign(l.current,{add:()=>e.add(l.current),remove:()=>e.remove(l.current),isTopModal:()=>e.isTopModal(l.current),setDialogRef:(0,g.useCallback)((g=>{l.current.dialog=g}),[]),setBackdropRef:(0,g.useCallback)((g=>{l.current.backdrop=g}),[])})}const Jn=(0,g.forwardRef)(((I,C)=>{let{show:e=!1,role:l="dialog",className:A,style:n,children:o,backdrop:a=!0,keyboard:c=!0,onBackdropClick:d,onEscapeKeyDown:i,transition:s,runTransition:r,backdropTransition:b,runBackdropTransition:m,autoFocus:Z=!0,enforceFocus:u=!0,restoreFocus:G=!0,restoreFocusOptions:B,renderDialog:h,renderBackdrop:p=(g=>(0,Xe.jsx)("div",Object.assign({},g))),manager:y,container:W,onShow:V,onHide:S=(()=>{}),onExit:X,onExited:R,onExiting:k,onEnter:J,onEntering:Y,onEntered:v}=I,H=function(g,I){if(null==g)return{};var C,e,l={},A=Object.keys(g);for(e=0;e<A.length;e++)C=A[e],I.indexOf(C)>=0||(l[C]=g[C]);return l}(I,Xn);const N=pn(),f=function(I,C){const e=pn(),[l,A]=(0,g.useState)((()=>yn(I,null==e?void 0:e.document)));if(!l){const g=yn(I);g&&A(g)}return(0,g.useEffect)((()=>{C&&l&&C(l)}),[C,l]),(0,g.useEffect)((()=>{const g=yn(I);g!==l&&A(g)}),[I,l]),l}(W),K=kn(y),w=we(),F=function(I){const C=(0,g.useRef)(null);return(0,g.useEffect)((()=>{C.current=I})),C.current}(e),[x,z]=(0,g.useState)(!e),U=(0,g.useRef)(null);(0,g.useImperativeHandle)(C,(()=>K),[K]),tl&&!F&&e&&(U.current=mn(null==N?void 0:N.document)),e&&x&&z(!1);const Q=kl((()=>{if(K.add(),j.current=il(document,"keydown",D),T.current=il(document,"focus",(()=>setTimeout(L)),!0),V&&V(),Z){var g,I;const C=mn(null!=(g=null==(I=K.dialog)?void 0:I.ownerDocument)?g:null==N?void 0:N.document);K.dialog&&C&&!Zn(K.dialog,C)&&(U.current=C,K.dialog.focus())}})),E=kl((()=>{var g;(K.remove(),null==j.current||j.current(),null==T.current||T.current(),G)&&(null==(g=U.current)||null==g.focus||g.focus(B),U.current=null)}));(0,g.useEffect)((()=>{e&&f&&Q()}),[e,f,Q]),(0,g.useEffect)((()=>{x&&E()}),[x,E]),Fe((()=>{E()}));const L=kl((()=>{if(!u||!w()||!K.isTopModal())return;const g=mn(null==N?void 0:N.document);K.dialog&&g&&!Zn(K.dialog,g)&&K.dialog.focus()})),M=kl((g=>{g.target===g.currentTarget&&(null==d||d(g),!0===a&&S())})),D=kl((g=>{c&&function(g){return"Escape"===g.code||27===g.keyCode}(g)&&K.isTopModal()&&(null==i||i(g),g.defaultPrevented||S())})),T=(0,g.useRef)(),j=(0,g.useRef)();if(!f)return null;const P=Object.assign({role:l,ref:K.setDialogRef,"aria-modal":"dialog"===l||void 0},H,{style:n,className:A,tabIndex:-1});let O=h?h(P):(0,Xe.jsx)("div",Object.assign({},P,{children:g.cloneElement(o,{role:"document"})}));O=Sn(s,r,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!e,onExit:X,onExiting:k,onExited:function(){z(!0),null==R||R(...arguments)},onEnter:J,onEntering:Y,onEntered:v,children:O});let q=null;return a&&(q=p({ref:K.setBackdropRef,onClick:M}),q=Sn(b,m,{in:!!e,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:q})),(0,Xe.jsx)(Xe.Fragment,{children:t.createPortal((0,Xe.jsxs)(Xe.Fragment,{children:[q,O]}),f)})}));Jn.displayName="Modal";const Yn=Object.assign(Jn,{Manager:Bn});var vn=Function.prototype.bind.call(Function.prototype.call,[].slice);function Hn(g,I){return vn(g.querySelectorAll(I))}function Nn(g,I){return g.replace(new RegExp("(^|\\s)"+I+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const fn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Kn=".sticky-top",wn=".navbar-toggler";class Fn extends Bn{adjustAndStore(g,I,C){const e=I.style[g];I.dataset[g]=e,Al(I,{[g]:"".concat(parseFloat(Al(I,g))+C,"px")})}restore(g,I){const C=I.dataset[g];void 0!==C&&(delete I.dataset[g],Al(I,{[g]:C}))}setContainerStyle(g){super.setContainerStyle(g);const I=this.getElement();var C,e;if(e="modal-open",(C=I).classList?C.classList.add(e):function(g,I){return g.classList?!!I&&g.classList.contains(I):-1!==(" "+(g.className.baseVal||g.className)+" ").indexOf(" "+I+" ")}(C,e)||("string"===typeof C.className?C.className=C.className+" "+e:C.setAttribute("class",(C.className&&C.className.baseVal||"")+" "+e)),!g.scrollBarWidth)return;const l=this.isRTL?"paddingLeft":"paddingRight",A=this.isRTL?"marginLeft":"marginRight";Hn(I,fn).forEach((I=>this.adjustAndStore(l,I,g.scrollBarWidth))),Hn(I,Kn).forEach((I=>this.adjustAndStore(A,I,-g.scrollBarWidth))),Hn(I,wn).forEach((I=>this.adjustAndStore(A,I,g.scrollBarWidth)))}removeContainerStyle(g){super.removeContainerStyle(g);const I=this.getElement();var C,e;e="modal-open",(C=I).classList?C.classList.remove(e):"string"===typeof C.className?C.className=Nn(C.className,e):C.setAttribute("class",Nn(C.className&&C.className.baseVal||"",e));const l=this.isRTL?"paddingLeft":"paddingRight",A=this.isRTL?"marginLeft":"marginRight";Hn(I,fn).forEach((g=>this.restore(l,g))),Hn(I,Kn).forEach((g=>this.restore(A,g))),Hn(I,wn).forEach((g=>this.restore(A,g)))}}let xn;const zn=g.forwardRef(((g,I)=>{let{className:C,bsPrefix:e,as:l="div",...A}=g;return e=He(e,"modal-body"),(0,Xe.jsx)(l,{ref:I,className:Se()(C,e),...A})}));zn.displayName="ModalBody";const Un=zn,Qn=g.createContext({onHide(){}}),En=g.forwardRef(((g,I)=>{let{bsPrefix:C,className:e,contentClassName:l,centered:A,size:t,fullscreen:n,children:o,scrollable:a,...c}=g;C=He(C,"modal");const d="".concat(C,"-dialog"),i="string"===typeof n?"".concat(C,"-fullscreen-").concat(n):"".concat(C,"-fullscreen");return(0,Xe.jsx)("div",{...c,ref:I,className:Se()(d,e,t&&"".concat(C,"-").concat(t),A&&"".concat(d,"-centered"),a&&"".concat(d,"-scrollable"),n&&i),children:(0,Xe.jsx)("div",{className:Se()("".concat(C,"-content"),l),children:o})})}));En.displayName="ModalDialog";const Ln=En,Mn=g.forwardRef(((g,I)=>{let{className:C,bsPrefix:e,as:l="div",...A}=g;return e=He(e,"modal-footer"),(0,Xe.jsx)(l,{ref:I,className:Se()(C,e),...A})}));Mn.displayName="ModalFooter";const Dn=Mn,Tn=g.forwardRef(((I,C)=>{let{closeLabel:e="Close",closeVariant:l,closeButton:A=!1,onHide:t,children:n,...o}=I;const a=(0,g.useContext)(Qn),c=kl((()=>{null==a||a.onHide(),null==t||t()}));return(0,Xe.jsxs)("div",{ref:C,...o,children:[n,A&&(0,Xe.jsx)(Nl,{"aria-label":e,variant:l,onClick:c})]})})),jn=g.forwardRef(((g,I)=>{let{bsPrefix:C,className:e,closeLabel:l="Close",closeButton:A=!1,...t}=g;return C=He(C,"modal-header"),(0,Xe.jsx)(Tn,{ref:I,...t,className:Se()(e,C),closeLabel:l,closeButton:A})}));jn.displayName="ModalHeader";const Pn=jn,On=Xt("h4"),qn=g.forwardRef(((g,I)=>{let{className:C,bsPrefix:e,as:l=On,...A}=g;return e=He(e,"modal-title"),(0,Xe.jsx)(l,{ref:I,className:Se()(C,e),...A})}));qn.displayName="ModalTitle";const _n=qn;function $n(g){return(0,Xe.jsx)(Wl,{...g,timeout:null})}function go(g){return(0,Xe.jsx)(Wl,{...g,timeout:null})}const Io=g.forwardRef(((I,C)=>{let{bsPrefix:e,className:l,style:A,dialogClassName:t,contentClassName:n,children:o,dialogAs:a=Ln,"aria-labelledby":c,"aria-describedby":d,"aria-label":i,show:s=!1,animation:r=!0,backdrop:b=!0,keyboard:m=!0,onEscapeKeyDown:Z,onShow:u,onHide:G,container:B,autoFocus:h=!0,enforceFocus:p=!0,restoreFocus:y=!0,restoreFocusOptions:W,onEntered:V,onExit:S,onExiting:X,onEnter:R,onEntering:k,onExited:J,backdropClassName:Y,manager:v,...H}=I;const[N,f]=(0,g.useState)({}),[K,w]=(0,g.useState)(!1),F=(0,g.useRef)(!1),x=(0,g.useRef)(!1),z=(0,g.useRef)(null),[U,Q]=(0,g.useState)(null),E=Gl(C,Q),L=kl(G),M=function(){const{dir:I}=(0,g.useContext)(Je);return"rtl"===I}();e=He(e,"modal");const D=(0,g.useMemo)((()=>({onHide:L})),[L]);function T(){return v||function(g){return xn||(xn=new Fn(g)),xn}({isRTL:M})}function j(g){if(!tl)return;const I=T().getScrollbarWidth()>0,C=g.scrollHeight>$e(g).documentElement.clientHeight;f({paddingRight:I&&!C?bn():void 0,paddingLeft:!I&&C?bn():void 0})}const P=kl((()=>{U&&j(U.dialog)}));Fe((()=>{dl(window,"resize",P),null==z.current||z.current()}));const O=()=>{F.current=!0},q=g=>{F.current&&U&&g.target===U.dialog&&(x.current=!0),F.current=!1},_=()=>{w(!0),z.current=rl(U.dialog,(()=>{w(!1)}))},$=g=>{"static"!==b?x.current||g.target!==g.currentTarget?x.current=!1:null==G||G():(g=>{g.target===g.currentTarget&&_()})(g)},gg=(0,g.useCallback)((g=>(0,Xe.jsx)("div",{...g,className:Se()("".concat(e,"-backdrop"),Y,!r&&"show")})),[r,Y,e]),Ig={...A,...N};Ig.display="block";return(0,Xe.jsx)(Qn.Provider,{value:D,children:(0,Xe.jsx)(Yn,{show:s,ref:E,backdrop:b,container:B,keyboard:!0,autoFocus:h,enforceFocus:p,restoreFocus:y,restoreFocusOptions:W,onEscapeKeyDown:g=>{m?null==Z||Z(g):(g.preventDefault(),"static"===b&&_())},onShow:u,onHide:G,onEnter:(g,I)=>{g&&j(g),null==R||R(g,I)},onEntering:(g,I)=>{null==k||k(g,I),cl(window,"resize",P)},onEntered:V,onExit:g=>{null==z.current||z.current(),null==S||S(g)},onExiting:X,onExited:g=>{g&&(g.style.display=""),null==J||J(g),dl(window,"resize",P)},manager:T(),transition:r?$n:void 0,backdropTransition:r?go:void 0,renderBackdrop:gg,renderDialog:g=>(0,Xe.jsx)("div",{role:"dialog",...g,style:Ig,className:Se()(l,e,K&&"".concat(e,"-static"),!r&&"show"),onClick:b?$:void 0,onMouseUp:q,"aria-label":i,"aria-labelledby":c,"aria-describedby":d,children:(0,Xe.jsx)(a,{...H,onMouseDown:O,className:t,contentClassName:n,children:o})})})})}));Io.displayName="Modal";const Co=Object.assign(Io,{Body:Un,Header:Pn,Title:_n,Footer:Dn,Dialog:Ln,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),eo=I=>{let{is_success:C,show_model:e,error_msg:l,payment_link:A,hide_model:t}=I;const{t:n}=BI();(0,g.useEffect)((()=>{if(C&&e){const g=setTimeout((()=>{window.location.href=A,window.close()}),5e3);return()=>clearTimeout(g)}}),[A]);return(0,Xe.jsx)(Co,{show:e,onHide:()=>t(!1),centered:!0,backdrop:"static",children:(0,Xe.jsx)(Co.Body,{className:"text-align-center",children:C?(0,Xe.jsxs)(Xe.Fragment,{children:[(0,Xe.jsx)("p",{className:"model-body-width",children:(0,Xe.jsx)("b",{dangerouslySetInnerHTML:{__html:n("payment_link_redirect_msg")}})}),(0,Xe.jsx)(mt,{variant:"success",className:"edit-button-background-color",onClick:()=>{e&&C&&(window.location.href=A,window.close())},children:n("continue")})]}):(0,Xe.jsxs)(Xe.Fragment,{children:[(0,Xe.jsxs)("p",{children:["Error: ",l]}),(0,Xe.jsx)(mt,{variant:"danger",onClick:()=>{t(!1)},children:"Close"})]})})})},lo=E((g=>({noOfTicket:g.bookTicketReducer.noOfTicket,fare:g.bookTicketReducer.fare,fromStation:g.bookTicketReducer.fromStation,destinationStation:g.bookTicketReducer.destinationStation,metroType:g.bookTicketReducer.metroType,checksum:g.bookTicketReducer.checksum,route:g.bookTicketReducer.route,bookType:g.bookTicketReducer.bookType,scannedData:g.bookTicketReducer.scannedData,isAcBus:g.bookTicketReducer.isAcBus,whatsAppNumber:g.bookTicketReducer.whatsAppNumber})),{setFrmStation:jl,setDestStation:Pl,setFare:Ql})((I=>{let{bookType:C,scannedData:e,fromStation:l,destinationStation:A,noOfTicket:t,fare:n,whatsAppNumber:o,isAcBus:a,route:c}=I;const d=qC(),{t:i,i18n:s}=BI(),[r,b]=(0,g.useState)(!1),[m,Z]=(0,g.useState)(!1),[u,G]=(0,g.useState)(!1),[B,h]=(0,g.useState)("#"),p=()=>{d(yA("home"))},y=g=>{const I=s.language,n={source_station_id:l.stop_id,destination_station_id:A.stop_id,no_passengers:t,phone_number:o,bus_number:e?e.bus_number:"",is_ac_bus:a,route_name:c.route_name,route_id:c.route_id,language_code:I,booking_type:C};var d,i,r,m,u,B,p,y,W,V,S,X;(d=AA,i=n.source_station_id,r=n.destination_station_id,m=n.no_passengers,u=n.language_code,B=n.phone_number,p=n.booking_type,y=n.bus_number,W=tA,V=n.is_ac_bus,S=n.route_name,X=n.route_id,new Promise(((g,I)=>{const C="".concat(d,"|").concat(i,"|").concat(r,"|").concat(m,"|").concat(B,"|").concat(y,"|").concat(V,"|").concat(S,"|").concat(p,"|").concat(u,"|").concat(X,"|").concat(W),e=(new TextEncoder).encode(C);crypto.subtle.digest("SHA-512",e).then((I=>{const C=Array.from(new Uint8Array(I)).map((g=>g.toString(16).padStart(2,"0"))).join("");g(C)})).catch((g=>{console.error("Error computing SHA-512 hash:",g),I(g)}))}))).then((C=>{n.checksum=C;const e={"Content-Type":"text/plain","Accept-Language":I,"Whatsapp-Account":o,Authorization:oA};let l=null;l=g?bA:rA,b(!0),Qt(l,"POST",e,n).then((g=>{g.success&&(Z(!0),G(!0),h(g.data.link),b(!0))})).catch((g=>{console.log("Error while makeing initiatePaymentRequest",g)}))})).catch((g=>{console.log("Error while converting in SHA512",g)}))};return(0,Xe.jsx)("div",{className:"container-sm",children:(0,Xe.jsxs)("div",{className:"customBox",children:[(0,Xe.jsx)(eo,{is_success:u,show_model:m,error_msg:i("payment_link_gen_err"),payment_link:B,hide_model:g=>{Z(g),b(g)}}),(0,Xe.jsxs)("div",{className:"col-12 from-to-pop-up",children:[(0,Xe.jsx)("div",{className:"row mb-0 stationBox",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsxs)("div",{className:"d-flex justify-content-between lh-sm py-3 ",children:[(0,Xe.jsx)("h5",{className:"my-1",children:i("booking_summary")}),(0,Xe.jsx)("button",{type:"button",id:"close-button",className:"btn-close","aria-label":"Close",onClick:p})]})})}),(0,Xe.jsx)("div",{className:"row p-2",children:(0,Xe.jsx)("div",{className:"card p-3",style:{backgroundColor:"rgb(217 231 248)"},children:(0,Xe.jsx)(Et,{fromStation:l,destinationStation:A,route:c,noOfTicket:t,fare:n})})})]}),(0,Xe.jsxs)("div",{className:"row justify-content-start text-black",children:[(0,Xe.jsx)("div",{className:"col-12",children:i("charges_msg")}),(0,Xe.jsx)("div",{className:"col-12 my-1",children:(0,Xe.jsxs)("b",{children:[i("payment_charges_title")," :"]})}),(0,Xe.jsx)("div",{className:"col-12 my-1",children:i("debit_card")}),(0,Xe.jsx)("div",{className:"col-12 my-1",children:i("credit_card")}),(0,Xe.jsx)("div",{className:"col-12 my-1",children:i("upi_charges")}),(0,Xe.jsx)("div",{className:"col-12 my-1",children:(0,Xe.jsx)("h6",{className:"text-danger p-0 m-0",children:(0,Xe.jsx)("span",{dangerouslySetInnerHTML:{__html:i("upi_payment_note")}})})}),(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("b",{children:i("edit_details_note")})})]}),(0,Xe.jsxs)("div",{className:"row justify-content-start",children:[(0,Xe.jsx)("div",{className:"col-6 my-1",children:(0,Xe.jsx)("div",{className:"d-grid",children:(0,Xe.jsx)("div",{className:"buttonBox",children:(0,Xe.jsx)("button",{className:"btn py-2 px-0 btn-sm payment",onClick:()=>y(!1),disabled:r,children:r?(0,Xe.jsx)(SA,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):i("pay_with_other")})})})}),(0,Xe.jsx)("div",{className:"col-6 my-1",children:(0,Xe.jsx)("div",{className:"d-grid gap-2",children:(0,Xe.jsx)("div",{className:"buttonBox",children:(0,Xe.jsx)("button",{className:"btn py-2 px-0 btn-sm payment",onClick:()=>y(!0),disabled:r,children:r?(0,Xe.jsx)(SA,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):i("pay_with_upi")})})})}),(0,Xe.jsx)("div",{className:"d-grid gap-2 my-2",children:(0,Xe.jsx)(mt,{variant:"primary",className:"btn-sm edit-button-background-color p-2",onClick:p,disabled:r,children:r?(0,Xe.jsx)(SA,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):i("edit")})})]})]})})})),Ao=E((g=>({scannedData:g.bookTicketReducer.scannedData,validateBusNumber:g.bookTicketReducer.validateBusNumber})),{setScannedData:ql,setScannedEncryptData:_l})(WA((I=>{const{t:C,i18n:e}=BI(),[l,A]=(0,g.useState)(""),[t,n]=(0,g.useState)(""),[o,a]=(0,g.useState)(!1),c=g=>{I.setScannedData(g),I.router.navigate(yA("validate_ticket_success"))};return(0,Xe.jsxs)("div",{className:"container-sm",children:[(0,Xe.jsx)("div",{className:"row mt-2",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("div",{className:"card logo-box p-3",children:(0,Xe.jsx)("img",{src:"https://pelocal-dtc-bucket-production.s3.amazonaws.com/dtcImage.png",alt:"DMRC Logo"})})})}),(0,Xe.jsx)("div",{className:"card p-0 my-2",children:(0,Xe.jsx)("div",{className:"row justify-content-around",children:(0,Xe.jsx)("div",{className:"col-12 text-center",children:(0,Xe.jsx)(zt,{setscanneddata:c,setscannedencryptdata:g=>{console.log(g)}})})})}),(0,Xe.jsx)("div",{children:(0,Xe.jsxs)(tt,{children:[(0,Xe.jsxs)(tt.Group,{children:[(0,Xe.jsx)("div",{className:"section-divider",children:(0,Xe.jsx)("span",{children:C("qr_option")})}),(0,Xe.jsx)("h4",{className:"text-center mb-1",children:(0,Xe.jsx)("b",{children:C("bus_number_title")})}),(0,Xe.jsx)("div",{className:"row justify-content-start",children:["DL1PB","DL1PC","DL1PD","DL51GD","DL51EV"].map(((g,I)=>(0,Xe.jsx)("div",{className:"col-4",onClick:()=>{(g=>{4==l.length?(n(g),a(!0)):n(g)})(g)},children:(0,Xe.jsx)("h5",{className:"text-center",children:(0,Xe.jsx)(ot,{bg:"".concat(t===g?"danger":"secondary"),children:g})})},I)))})]}),(0,Xe.jsx)(ut,{handleBusNumberChange:g=>{4===g.length?(A(g),t.length>2?(a(!0),A(g)):(A(g),dt(C("prefix_error"),"danger"))):A(g)}}),o&&(0,Xe.jsx)("h3",{className:"text-danger text-center m-2",children:"".concat(t).concat(l)}),(0,Xe.jsx)("div",{className:"d-grid mt-2",children:(0,Xe.jsx)(mt,{type:"submit",className:"btn btn-dark-updated text-white",onClick:g=>{if(g.preventDefault(),!t||!l||l.length<4)return void dt(C("enter_bus_numer_alert_msg"),"danger");console.log("Form submitted with bus number:","".concat(t).concat(l));let A="".concat(t).concat(l),n={bus_number:A};if("yes"===I.validateBusNumber.toLowerCase()){const g={bus_number:A},C={"Content-Type":"application/json","Accept-Language":e.language,Authorization:oA,"Whatsapp-Account":I.whatsAppNumber};Qt(uA,"POST",C,g).then((g=>{if(g.success)return dt(g.message,"success"),console.log(n),void c(n)})).catch((g=>{console.log("error",g)}))}else c(n)},children:C("submit_label")})})]})})]})}))),to=E((g=>({scannedData:g.bookTicketReducer.scannedData,whatsAppNumber:g.bookTicketReducer.whatsAppNumber,checksum:g.bookTicketReducer.checksum})),null)((I=>{const[C,e]=(0,g.useState)(!0),[l,A]=(0,g.useState)(!1),{t:t,i18n:n}=BI();(0,g.useEffect)((()=>{const g=n.language,C={bus_number:I.scannedData.bus_number,checksum:I.checksum},l={"Content-Type":"text/plain","Accept-Language":g,Authorization:oA,"Whatsapp-Account":I.whatsAppNumber};e(!0),Qt(mA,"POST",l,C).then((g=>{g.success&&e(!1)})).catch((g=>{console.log("Error :: ",g),e(!1),A(!0)}))}),[]);return(0,Xe.jsx)("div",{className:"container-sm my-2",children:C?(0,Xe.jsx)("div",{className:"row searchSec background-white",children:(0,Xe.jsx)("div",{className:"col-12 my-5 ps-0 pe-0 bg-white",children:(0,Xe.jsx)("div",{className:"text-center",children:(0,Xe.jsx)("div",{className:"spinner-grow text-primary",role:"status"})})})}):(0,Xe.jsxs)("div",{className:"card",children:[(0,Xe.jsxs)("div",{className:"card-body",children:[(0,Xe.jsx)("h5",{className:"card-title",children:t(l?"error_msg_title_while_api_call":"ticket_validation_status_title")}),(0,Xe.jsx)("p",{className:"card-text",children:(0,Xe.jsx)("span",{dangerouslySetInnerHTML:{__html:t(l?"error_msg_desc_while_api_call":"ticket_validation_status_desc")}})})]}),(0,Xe.jsx)("div",{className:"card-body text-cetner",children:(0,Xe.jsx)("button",{type:"button",className:"btn btn-success active",onClick:()=>{window.location.href=lA},children:t("continue")})})]})})})),no="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXMAAAEsCAYAAAAxYlOwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAB8ESURBVHgB7d0/dhtHl/fxq5dO3shyNplLK5CUPZnBbDLTKzCUTSbycAGGFsAjagWEViA6m0xw5kz0ClRage1sJuDh1FUXHkMUiKruru6uqv5+zukDSl0UKRL49UX960cCADN1enq6cA8v3fHMHcYdf7nj+eXlpZXCfCMAMEMuyN+7h8W9v37sjit3HEth/p8AwMy4IP9Fvg7yrYU7/1gKQ5gDmBUX1CfuYRVo9kwKQ5gDmA0X5MY9vI5oaqUwhDmAOdHuFRNoc13iAChhDmAWXFW+dA/LQDPrjjMp0CMBgMr57hWdvWICTZ+UWJUrKnMAcxDTvfKq1CBXVOYAquZnr7wLNNu4IC9ubvkuKnMAtYuZvfJCCkeYA6jW2dmZLtU3gWZFd69s0c0CoEqRg57WBfkTqQCVOYBaRVXlUgkqcwDV8VX5x0Cz4gc9d1GZA6jRLxFtih/03MUWuACq4qvyZaDZeqpBTx2Uvbu7W0mz3e6NO96472UtPVGZA6jNzxFt3srI9CLjjncuyC+lCXKluzNe+S15eyHMAdRmGTivfeUbGZGfIvnBHScPNFn5ux51RjcLgGr4zbRMoNloVbnv8rly1fgiorlW6RvpiMocQE1CXSw2Rf90DN91otX4QkZAZQ6gCr4KXgSaDT6v3HeX6BYCbe9WdCM9EOYAahEziLiRgfj7hur3cCrt9e7HLzrMd67ET6XpJ9Mr4WP5Z6T4IX/54xArYaE2+jX+jmgzyvfiniyhrwOULFQJb4aajuir8SsJ99fvs5EEc96LC3N/9dORYR0V7nrT1ZjAN1IZ97MLNeEih5KFXtPJBz59HmmIn3T4dH3evXDPv2tJoJgw91c+fQuzEAyFi9x+qS4sMf/OpwT/hpUE30uBOwn+Joefn0lCc+ve4p+23rhjlbKQyH5vlu3UHiHEgRzZwPmYi89um0/+37Rt+5B9VujskX3hqtvcriSBnplkpanGN5JY1mHup/asBMBcbdzxqzuuY94puMz4vKJS/umC1YuEBvmlJOAzSd/KZVGN78oyzKnGAeyxccfbmHnivi/7caquoh7TDdXGHWfue7mRAWUX5v7KqvfrMwIAX7PSVNtrGVjP6YZJ3xWEZBXmPsj1ziBd3sIAmBetdH/KebrhmIPI2YR5wiDfHUwxAqB2ZymrX1+Na5fKUtobtRrflUWYR96rbx/9wel0I52SpFdp23ZwwX/tQ2Km66Wa0ve95PO9ACXR/DyTnvxGXRrkXYrKtTQXlkEGOENyCXO9vZNp8SlWmpHhNQs+hlHhRS7ma8X+O8iTFnTHXTIh1+mGbUwe5i2nH+ov6U2q+aJAW4kucsok+Hf0/LfS7+uk+l5y0TrQfbeKzk830t6g0w3bmHQFqH9hrCKbW2l+SVaAifD82287FTDQzATOP/Zt9ND9lhbS3jNpKuyfWnzOibQPcr1onE1dje+atDJv0b3S+e0TgDLtbKSn796NtBPdh663cpP4vVWy7R2YLMz9QMNVRFOCHJg5nxdtQ/04pnJuEeYbGXm6YRtT3mkoZu9hK808UoIcmDG/QOi5NH3Usa5890/IH4Hzmj/apZJ1N+8kYe4n45uIptleBQGMS4s6d5y6D2OnIBqJKxov5eENw67d8WSKeeNtTVWZh+7Tp9Y5DS4AyIMP1mMJ78aoTkMzkPw7f/33dvc73+41XkzPwFRhHtM/Nfi9+gCUyRd6sRV6sDrXHgB3LN2H37njiTTV+FoKMvoAqO9ieR9oplV579soAaiby5OVxHWlfFf72NsUlXlMVf5WACDATxHcRDQ9lcpNEeZPA+ctfeUAWojpko0ZpyvaFGH+LHB+IwAQyRd/m0Azc35+Htrjp2ijhnnkkt/QnE8AuC9Ynd/e3rZZ4l+csStzE9HmRgCgBV+dhwY4Q128RRt7o62Y1Vis9gTQhU6ceHng/EIys9NbsT3Mzsff3vs7zcYH74E66a6J+xwdHf0pANBe6F29kQHdC2YjX4b09zvfg9n5uK2F+zp6wfpqv6rswhwAOrKhBjoIenFx8Uk68GtkfpSvK2mRce/epZNIdG79F4umptxoCwBSsqEGbhD0O+nA30RHFzvqfPWlNOtlFvJlpT2m5f1NxAhzAHPS+o5JLW+iMxb9f3wxzZswB4DDYrYLmMIXYwSEOQAcFlroOIU39wdACXMAKMtG9nT7MJsFAA7T+etjV+d/3Tus//tfXUV+ve8TCHMAOEBvhuEHQV9KN7uBvP34b/kypO324653Vxs1zB89evTt3d3dwTa3t7dP3A9ushtNI2/cRhBTaPL8VAccdZ65kS+D+JM8UEmP+XwdPDT9XEi9oi1lmvmYqM/2xaLHb+64Ydtk+Or5Y6DZca3PlcEqc/+D1Sk9SwHS2s6x1UMXb+jzTQN+445f3XFd+11lgPuSh/lOJb4SYDz6vDvxx5V7Hq6lmb7FLpyYhaRTE301rkteVwJMa+mOD+45+d7vqQFULVmYuxeMvuX9IHlOsMd8LdyhgX7liw2gSknC3Ae5VuSt9z0ARrJ0x0e/YRJQnd5h7qudd0KQowwr95z9SJWO2vQaAPWDnVqRG2nP7hxAyL6N/7sy0lTpZ7ogRIAK9J3Nom9ZTYv2G2mWxjJ1DL34rj0jzeyVH6RbQfHa/Tvfuudi8GbAQO46LxraGfCMsXHHKxZ2YCj++Xgq3YJ97Z6bLwRFY9FQd+8i2+lc31MBBuTnky/9C1qrdV3rYCI/fekvBse8Y0SpOg2Auif+UuJeKK8IcoxJ98Lw/eDH7njT4lM1zF8LUKius1l+jmijQb4SYAI+1LWQeCLxg+xaoRPoKFLrMPfzdBeBZmuCHDnwu9Y9l2bgPcYpc9FRolZh7pdFryKaMjsA2dB+cHcsJf55qXPR6R5EUaLD3M8pv4poumbPaeTIv1uMDfTX7OmCkrSpzGPnlFOVI1stA/2dn+UCZC8qzP10r5i3nTdU5cidD/SYmS76bvQdS/9RgtjKPHZA6DcBCuBnusQMihppdl1k7yFkLRjmvipZShwrQDk00GNuXmGEQEfmYirzNtO0rACF8Ks9f5K45y2LipC1g2HesipXLIVGUfwYj64WtRHNl8xBR65ClXnbubZGgML4QNcKPaYYWRHoyFEozH+UduhTRJH8Rl2xOyeuzs7OYra0AEbzYJj7BRNG2iHMUSwX6Nfu4Sym7d3d3Zo56MjJocr8RNr7XoCC+R0XYxcVvWcOOnJxKMx/kPa+E6BwLRcVEejIwt4w9/Npu7yFpDJHFfyiok1EUyNNoNPlgkk9VJl3fWLSZ46a6AyX2EVFH9hpEVNKHeZGgEq0XFSkdKfFK7pdMIWHwrxLf/lnLHlGTXYWFcUuiFtKU6X/QqhjTA+FuZGOjo6OvhWgIjuBHksLmpU0femvCXWMIXU3i9ze3j4RoDItFxVtGWlWUX90ga7BvmSgdHKm1ovro/t/4btJ/pTuXrgn/lqACmkgS9wdtw7RLpsb/8h+RulodrVZH6O/AyvN1t0bf8Eu1jd7/q5v5UCfOaqlhYoLdA1gDfSuz3X9vIVgas/88fkC4H6vVpoFY5sSb7Kzr5ulbxgT5qiaX/b/XNjyuTZGmov0xxIHsIcIcxYOoXq+ctNAj7lbEcqzkmYAeymF2BfmRvphST9mQeehu2MpzcCoFdTGuEPXDRRxU5LYe4C2QWWOWdF+dHfoLC5CvU66uPdD7t0uQ4Q5feaYpXuhvhHURAdKs74P7BDdLIQ5Zs2Hui4y0mDX/dE3ghoYd7yXTO2bZ752D33vovKd39cCgHyxE6keRpruyMc7B8ZlpDvd9j7qJiZjGiTMj46OzMXFxScBgAztXFyX0uxFZaSdYxfoG8nINzKA29tbndFCmAPIku852Phju7JXb9RtIv8JneXyPKceiH195im+OSMAUAi/BYmOc1xHfoqRZt+dbAwV5vQBAiiKLgRzh+5fH3sP2Jc5zW4ZYmqiMgIABfL3gI0JdA3ybKpzKnMAuKfFTb0738gntaHCnBtUACjdSsJ5uDg/P89i1TvdLACwh5+pEuxuub29/UkysC/MrfRnBADKt5aI6lwyQJ85ADzAV+e/Bpo9lQwQ5gBw2CZw3kgGvgrzVLdLymVQAAB6sqEGOeTdQwOgvatzv6QfAEpnpQCDhbkwCAqgDkYK8FCY30h/9JsDqEERWfZQmP8t/RkBgPKZUAPXrZwiM3sZspuFyhxADUJZ9lcOW+E+FOZW+mNJP4AamMB5KxlgABQADgtNO8ziBhVDVuZGAKB+k/eXqyHDHABqYALnrWRgqF0TlREAKJ8JnM+3m4Ul/QDw+UbPJqKZlQwcqsytAMC8mYg2VjLwzYFzKfZneeIePgkwQ/5mv0tptkjV19Mf/i7wqEsW3SyHwty645n0YwSYIf/2/L3cew24v//FPRyn6srE4ExEGysZONTNkmK6DatAMVdfBbmnf/c+si8W0zOhBjms/lSDdrMIlTlmyAX1Qg4/9/WcBvpoFbrv8jHSFFg3uQRQAUIFqZVMDD0AypJ+zJGJbDNKhX52dvbSPXx0xwdp3jH86b7ua0GM0Iw8K5k4FOYprtzcoAJ4mJGBA1376O/u7i7l6wrzlECPEqrMs1j9qUIDoH0xz3wE/i20Vl+n0jz59EJ87Y4z3k5PQn/2GpQxY0ZGBupy8YOtq8NNTt+6r5vi/gW1MoHzVjIxdDdLVQOgGpruOHHH0veLTs4Hub51Xsk/P+/tlLgP/jxG5C+gr1p8ipHEFXpEkG/1nbFWOxM4n02xNORyfmWkEq7f8Wdp+h3fueNKmhffxylnJewE+UMvSCNNtY6RuUDXro1JAr1FkCsu9g+ILISsZOLBME/1lq+GylCrcdfvuJavn/hGJppmFhHkWz8KJuFeQysZOdBbBrmii+VhJqKNlUyEKnMrPR0dHdUwo+XlgXNGRg70FkGuqLwmNGagdwjytfv+NoKHxLx2iulmSbWkv3SLwHkjIwV6yyBXfwgmNUagd6zIzwSHmIg2VjIxeGUu81k4ZGT4aWZtg1xdCyY3ZKB3DPJjZjoFmVCDnH6GoTBnSX9jE9nOyECB3jHIX7GxUz6GCHSCfFDFrP5Ug3ezSB1hPvU0s65BvhJkJWWgE+SDK2b1pxqjm6X4hUN+kOhFi08xkm6aGUFemRSBTpCPopjVn2qMyryKJf2+u2LUQCfI69Un0Any0ZjAeSsZoTJvYcxAJ8jr1zHQdbOsVYvPIci7M4HzWf1MxwjzquY5jxHoBPl8dAj0Nq8ngryj0lZ/qqGX86vqFq0MGegE+fx0CPQYBHk/JqKNlYwcDPNES/of17Ck/74hAp0gn6/EgU6Q91dcZsVU5lZ6qmRJ/1dSBjpBjkSBTpCnYUINXK59lIzEhHmKJf3V3qQiRaAT5NjqGegEeTrByvzi4uKTZGSUylwqX9LfJ9AJctznf7cbae8FQZ6MCZy3kpmYMGdJf4SugS4EOe7x88gX0t67MXfvrFxoSnV2F81RullkJpttdQx0ghz/1mFB0C4jE+2vX6FQAVpkmFvpbzb3Au0Q6LEI8sr1DPItIwR6CkVtsqXGqsxnZYBAJ8grlyjIt4wQ6H2ZwPmsBj8VA6ADSRjoBHnlEgf5lhECvQ+6WR5gZIYSBDpBXrkOQW5btDVCoLcW+fOykpkxlvOr6mezPMQHepfbc10S5HXruPvhc5l4f/0ZMBFtyqvMUy3pl5ny88h/lvZOeAHWq882tmPeJHqmgnmV2+pPFVuZW+np/Px8NjNatjouCNoywguwSin2IyfQB2VCDXJb/aliw5wl/S31DPItI7wAq5LyxhIE+mCKG/xUo1XmMqNB0ERBvmWEF2AVhrhDEIE+CBM4byVDsWHOkv5IiYN8ywgvwKKdDnirNwI9ueKW8qvRullkBpX5QEG+ZYQXYJFOR7hnJ4GeVHGrP9WY3SxVV+Zddz+UkW8SjXGNEeRbBHoyJnA+u8FPNWZlXuUNKlSfbWzHvEk0xjVmkG8R6EkwABpgpEIp9iMn0Ku1bNG2d5Bv9Qj0WYxrHVLq6k9FmPdwmvDGEgR6XdzvZSHxz/lkQb7VMdBPBSaiTdGVOe45HeAOQQT6LCUP8q0OgT7EwH1pilz9qaLCPNGSfiOVOB3wVm8EejVuItsMes/OloFe7bhWCybUIMfVn6pNZW6lpxqW9A8Z5FsEevl8QL850GTwIN/5XlYSF+hWUOTgp6KbpYUxgnyrR6DPfhArF+53qH3Q+wJ9IyMF+c73spJwoLfpkqmVCZy3kqlRK/Pb29snUqgxg3yrY6AziJURH+j6vD/zh4b4qEG+872sZH9g6/fyIlF3aumKXP2pvmnRNkU/kZECTRHkWxro7uvrh1eRn6Lb7a4E2fAheSkZ0Oekez6t3Ycn0rwerTvWU1xcMhV6Z5tia5NBtAnzFL/sUrsAdPHH6EG+1TLQ6WbBQTldXDJkAuetZGrUbhYpd0bLSYu2g9zqrUWXS8wsCgD7Fbkvi2oT5nNe0m8i2w16z87IQH8rAForefWnGjvMS71BRcz/fZSbL/tA/0n2P6le+fMA2jMRbaqYmmilv1Lnmb8JnB8lyLfc17p2D8fSVOlrab6/4zG/B2CmqpjNMucBUB0s+lH2D4K+miJE/SDW2h8A+jMRbaxkKroyn/OSfn9H9OfSVMIbaX6hn6tjqmGgGibUIOcpnG0qc6X/kV7Vtc7ZLnVOq++PXguAGpnAeSsZa7ucv3cIHx0dsZkPgByFsslKxtqGuZWeSl7SD6Bqxa7+VG3DfLZL+gFUzwTOW8nY6N0swnJzAHkygfNZj/UR5gBmL3LraCsZG73PXMpdOASgXiaijZWMTVGZl7qkH0C9YirzqrpZrPRHZQ4gNyaijZWM0WcOAIWv/lSEOQAUvI/5Vqsw91emvoH+mJsOA8hMqPvXSubaVuaKJf0AalP06k/VJcyt9MSSfgCZMYHzVjLXJcxTLOmnmwVATkzgfPY7vXYJ8xQIcwBZqGH1p5qkm0XYbAtAPkxEGyuZmyrMWTgEIBdV9BRM1c0CALkwoQZHR0cfJXN0swCYOxNqcHFxkWLix6AIcwBzV/zqTzXJoiFhNguAfBS/+lO1DvNEm80Q5gByMesBUCs9nZ+fM6MFQA5m282ielfnt7e33KQCQA5M4Hz2g59qsspcGAQFMDG/+jNUmWe/lF99I92k2EGMfnNsX0zGHc+keU587x+3hznw6btbMltpKqi//Mefj9xvKIDJmYg2VgrQNcxTvECMYFZccBv3sHDHU2nCexvgQ35Nfa7e+OM3aQL+RoBG8ff+3Ooa5lb6ozKvnAvShTSB/aOMENwP0K+58MepyBcB/6s+unDfCOYq+JwsYfWnmrIy5wYVlfFdJifu+ME/5nrB3g34bbhfS1O5X9M1Mysm1KCE1Z+Kbhb04gN84Y6XMl313Zd+z0t/XLn/kwa7Vu0Ee/2qGPxUU3azGEGxfBeKdp8spb4usxN/vPbB/paumGqZwHkrhZiyMkeBXLhpyGkVvpD6/btid/9v6x5fuVBfC2oSWrxYd2XuntDWPbmlJyMogu9K0QDXX/pcB66NNF0wv7jHtTTVuhWUrorVn6prZa70itXrha1L+ksZXJijiUP8/hzyhxj5Z076GIw7Vnq4n89ammrdCkplAueLyadJw9wv6SfMM3R2dvby7u5uJcOGpJVmiuAn/2j98VeXgUc/j10P/Z51MPap/DNzZQhLd5y4r3spVOqlmv0AqLLSv6vESPMiRib8wOaVC3IjaX0xt1ua+d1JXyg+TK3/4/XuOff/2i5SWkgzddJIGhoGK2n61elTL4i/+IdYKUSfME9RUc+1/zU7/ol9JWmr2I00c7c3U88G8as+9Vjrn3dWo+qMnBPpz8g/ferHVOlFMBFtZlGZp0CYZyBxl8pGmgBf5xxo/ntb67EzV15D/Wfpx7jjo+96eUOoZ62a1Z+qbzdLX0YwmW017oJ8If1o9fJWmkU2GymM7+7Rbplr9zNZyZeLoLrSQeMTul6yZkINSpqgMXWYs6R/Iomq8Y00feDrWlZK3qvYNcw1lLtW60aarpen7t89E+SmmsFPNXU3CzeoGJnvUnjtgnwp3W2kmZK3kYr5fvalr9b16Brqp36xFX3peTGB81YK0vXmFMpKf9w6bkS+W+WDNFPquthIE0jHc1rergHsjqX78Ik03UldGHd8OE2w2g7JVLP6U00d5gyAjsR1q2hVqUFupD0rMwzx+xKE+ud3RX7GC6YXyp8UN+EZTZ8wZ+fEQmh4uG6VtbS/eOrv+JU7nrPR1D/uhbqV9nT16IfIec4Yjgmct1KQzmGeasDL9+FiIO7n+1qa/t62NtKE+IptYPfzoa6BroObbX9GOrj6nkCfVDX7sqg+lbmy0tPR0REzWgagF0l36CKgtn20GkpnvkvFCoLcz0nnlD+X5gLYhhECfRK1rf5UfcO8t9vb2yeCpPy7nffSfqBzI001filoxVfpx9J0S7VhpBkY7TOnHe2ZiDazGQBVVvozgmR2grxtOLyiGu9Pu6WkfV/6598ZgZ6dWYU5+7NkpGOQ6xP22IcQEvAXRO12aTPjhUAfl4loY6UgfcM8xZWLME+gY5BbYabKIHTQ2M94adPtsg10XhPDM6EGpQ385xDmLBxKQ2ettAnyjTRBbgWD8e942izl396qDsMygfNWCpNDnzlL+nvyi1CWLT7lre8fZ8rhCHZmu8T+vKnMhxcqIq0Uhsq8cP4t+arFp7zyb/8xIr/Piwa6jWjORXZ6Ra3+VPSZl6/Nz+8VA53T8V1aOn3RBppeC4ZmAuetFCaHbhbCvJ/YCypBnoGIQOcG0eMwgfPFvTvKojJn9L473++9CTQjyDOyE+g6dXH7Gtq44wW/p+FF5o2VwvTaz1yDJMWOnn5JP/2E3b2QZlqi2XPuDQGRHx/oS8EUTEQbK4VJsZzfSk8s6e/nXqW39XnHQ3eu/9UWqEtMZV5ccZniTkNshZuBbaXnb36gT9a/mHoI7GUi2lgpTC5hjkR8gPM7AR5mQg1KLIRSdLOk2J/FCACMo6p9zLdShDkLhwCUpLrVnyqXMAeAsVR178+tLGazCN0sAMZjAuetFCiXytwIAIzDBM4X2duQS5izAhTA4Gpd/aly6WYhzAGMwUS0sVKgbAZAz8/PmdECYGhVrv5UvcM81eT629tbblIBYGgm1ODo6OhPKVCKylxZ6c8IAAzLhBpcXFykWAg5ulRhngL95gCGVuXqT0VlDmBOqlz9qVKFeYq3JVTmAIZWbc7k1M3yrQDAsOhmCbDSnxEAGJYJnC9y8FMR5gBmwa/+DFXmxW4cyGwWAHNhItpYKVROlTlhDmBI1a7+VDmFOUv6AQwpGOZHR0cfpVA5dbOwpB/AkEyoQamrP1WSMPd3hk/BCAAMo9rBT5WyMmdfcwA5M4HzVgpGmAOYi9CYHJW5Z6U/IwAwjGpXf6rcKnOW9AMYigmcL3bwU6UM87+lv2cCAImdnp4aCVfmN1Kw3LpZnkXecBUA2lhEtLFSsNzCXC0FANL6OXDeXl5eUpl7qUaCfxQASMR3sSwCzTZSuJRhnuqqtnA//IUAQBrvItr8KoVLFuZ+FWiq6vyKvnMAfbkc+UXCEyu0i+VaCpd6bxYraRiJu5oCwF7+Hf4qoulGKpA6zP+QdLS75UoAoCUf5LEF4SupQOowTz0avHS/lI9+AAMAgs7Ozl66h/cStz3Iq4QbBU7qG0lrI+kZd3xwgX7pHt/W8oMHkJavxn+5u7tbRH6KdcdaKvFIEnM/0D9luA2zrDQXjLfuuHHBXvTGOAD68e/aT6SZ0ryQdn6qYeBza4gwX0t4gn4qVpoZNIQ6MB+P7x1daPfKSiqSuptFrWW8MDcCAO28rS3I1RC3jdNBUCplADnSIF9KhY4ksd9///1//vWvf/1/ad9/BQBDeuOC/L+kUsn7zJVfvfmnAEAedDbcdsm+/fdfVjQ7bpAwV34q4UsBgPxtJ1JY/6gLILXL+KaUwB8yzLU6/yjc1xNA2aw7dArjm5yDPXmf+ZbvO/9f9+F/CgCUSwvSf7nj1GWaZttvkqHBwly5//Tv7j//nTQ/CAAo3cJlmnHRlt2WuYOGuXL/6f92/3ldofUfAgDle+Yy7ZHLto1kZIh55vscS+E3SwWAHS9zu+fCKGGue6i447n78I0AQPk0yBeSkbEq889coJ+6hzMp/C7YACCZzdQbNcyVC3Sdf67dLm8FAMplJSODzTOP4bevXMl4G3MBQCrf5bQN96RhvuVDfSlNqBsBgLytXZC/kIxkEea7XLDrnbR1KuMPwmZdAPKj1fjz3FaDZhfmu/zUHw33hTueSlO1PxMAmE6WdyjKOsz32Qn43cen/rQRumkADEMr8he53mquuDCP4QNfD7Pz1+beo/reP+7efmr3YyMA0Nx7+EXOG21VGeZD8IO06v59Bx/6++/3tNn35/vnAORBK3GdQn3tQnwjmSPMM7Nz0VD7blhrAn/W9t8G2jz0b/e5QS6Qku14PnSD908R/6Y+2tJuXEGYI8q9i8yu0AUg5gJhpJ3vJZ0pLmChwOnq747/rm3RNuZ7j2qT0xxtAACy8H/eyHRQxjK+0AAAAABJRU5ErkJggg==",oo=()=>{const{t:g}=BI();return(0,Xe.jsx)("div",{className:"container-sm",children:(0,Xe.jsx)("main",{children:(0,Xe.jsxs)("div",{className:"center-container",children:[(0,Xe.jsx)("div",{className:"row my-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("form",{className:"needs-validation",children:(0,Xe.jsx)("div",{className:"row g-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("ul",{className:"list-group",children:(0,Xe.jsx)("li",{className:"d-flex justify-content-between",children:(0,Xe.jsx)("div",{className:"sad-box",children:(0,Xe.jsx)("img",{className:"x",src:no})})})})})})})})}),(0,Xe.jsx)("div",{className:"row my-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("form",{className:"needs-validation",children:(0,Xe.jsx)("div",{className:"row g-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("ul",{className:"list-group",children:(0,Xe.jsx)("li",{className:"d-flex justify-content-between",children:(0,Xe.jsx)("div",{className:"label-text1",children:(0,Xe.jsx)("p",{className:"text-wrapper",children:g("no_recent_journey")})})})})})})})})}),(0,Xe.jsx)("div",{className:"row my-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("form",{className:"needs-validation",children:(0,Xe.jsx)("div",{className:"row g-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("ul",{className:"list-group",children:(0,Xe.jsx)("li",{className:"d-flex justify-content-between",children:(0,Xe.jsx)("div",{className:"label-text2",children:(0,Xe.jsxs)("p",{className:"we-re-unable-to-find",children:[g("empty_ticket_error_msg"),(0,Xe.jsx)("br",{}),(0,Xe.jsx)("br",{}),g("empty_ticket_error_msg_next")]})})})})})})})})}),(0,Xe.jsx)("div",{className:"row my-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("div",{children:(0,Xe.jsx)("form",{className:"needs-validation",children:(0,Xe.jsx)("div",{className:"row g-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("ul",{className:"list-group",children:(0,Xe.jsx)("li",{className:"d-flex justify-content-between",children:(0,Xe.jsx)(pe,{to:yA("home"),className:"select-station-css",children:(0,Xe.jsx)("button",{className:"btn btn-danger box-1 mt-3 btn-sm",children:g("buy_ticket")})})})})})})})})})})]})})})},ao=g=>{let{recentJourney:I,handleBuyAgain:C,isairportlinedisable:e,isnormallinedisable:l}=g;const{t:A}=BI();return(0,Xe.jsx)("div",{className:"row mt-2",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("div",{className:"card p-2",children:(0,Xe.jsx)("form",{className:"needs-validation",children:(0,Xe.jsx)("div",{className:"row g-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("ul",{className:"list-group",children:(0,Xe.jsxs)("li",{className:"d-flex justify-content-between",children:[(0,Xe.jsxs)("div",{children:[(0,Xe.jsx)("div",{className:"frame-metro-name",children:(0,Xe.jsx)("div",{className:"text-wrapper",children:(0,Xe.jsx)("b",{children:I.route_name})})}),(0,Xe.jsxs)("h6",{className:"my-1 destPoint",children:[I.source_stop_name,(0,Xe.jsxs)("span",{children:[" ",(0,Xe.jsx)("div",{className:"arrow arrow-bar is-right mx-2"})," "]}),I.destination_stop_name]}),(0,Xe.jsx)("small",{className:"text-muted",children:I.date})]}),(0,Xe.jsx)("div",{className:"d-flex align-items-center",children:(0,Xe.jsx)(mt,{variant:"light",className:"frame-buy",onClick:()=>C(I),disabled:"a"===I.line_type&&e||"n"===I.line_type&&l,children:(0,Xe.jsx)("div",{className:"text-wrapper",children:A("buy_again")})})})]})})})})})})})})},co=E((g=>({recentJourneys:g.bookTicketReducer.recentJourneys||[],whatsAppNumber:g.bookTicketReducer.whatsAppNumber,isairportlinedisable:g.bookTicketReducer.isAirportLineDisable,isnormallinedisable:g.bookTicketReducer.isNormalLineDisable,checksum:g.bookTicketReducer.checksum})),{setFrmStation:jl,setDestStation:Pl,setMetroType:Ml,setNoOfTicket:Ll,setRecentJourneys:g=>({type:OI,payload:g}),setRoute:Ol})((I=>{let{recentJourneys:C,whatsAppNumber:e,setFrmStation:l,setDestStation:A,setMetroType:t,setNoOfTicket:n,isairportlinedisable:o,isnormallinedisable:a,setRecentJourneys:c,setRoute:d}=I;const i=qC(),{t:s,i18n:r}=BI(),[b,m]=(0,g.useState)(!1);(0,g.useEffect)((()=>{const g={"Content-Type":"application/json","Accept-Language":r.language,"Whatsapp-Account":e,Authorization:oA};m(!0),Qt(ZA,"GET",g,{}).then((g=>{200===g.status_code&&(c(g.data),m(!1))})).catch((g=>{console.log("Error :: ",g),m(!1)}))}),[]);const Z=g=>{const I={stop_id:g.source_stop_id,stop_name:g.source_stop_name},C={stop_id:g.destination_stop_id,stop_name:g.destination_stop_name};l(I),A(C),t(g.line_type),n(g.no_of_passenger),d({route_id:g.route_id,route_name:g.route_name}),i(yA("home"))};return(0,Xe.jsx)("div",{className:"container-sm",children:(0,Xe.jsxs)("div",{className:"customBox",children:[(0,Xe.jsx)("div",{className:"col-12 from-to-pop-up",children:(0,Xe.jsx)("div",{className:"row mb-0 stationBox",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsxs)("div",{className:"d-flex justify-content-between lh-sm p-2 py-3",children:[(0,Xe.jsx)("h5",{className:"my-1",children:s("quick_book")}),(0,Xe.jsx)("button",{type:"button",id:"close-button",className:"btn-close","aria-label":"Close",onClick:()=>{i(yA("home"))}})]})})})}),b?(0,Xe.jsx)("div",{className:"text-center mt-5",children:(0,Xe.jsx)(SA,{animation:"border",variant:"primary",className:"loader"})}):C&&C.length>0?C.map(((g,I)=>(0,Xe.jsx)(ao,{recentJourney:g,handleBuyAgain:Z,isairportlinedisable:o,isnormallinedisable:a},I))):(0,Xe.jsx)(oo,{})]})})})),io={base_fare:0,total_fare:0,discount_percentage:0,amount_payable_by_user:0};class so extends g.Component{constructor(g){super(g),this.handleBusNumberSubmit=g=>{if(g.preventDefault(),!this.state.busNumberPrefix||!this.state.busNumberDigit||this.state.busNumberDigit.length<4)return void dt(this.props.t("enter_bus_numer_alert_msg"),"danger");console.log("Form submitted with bus number:","".concat(this.state.busNumberPrefix).concat(this.state.busNumberDigit));let I={bus_number:"".concat(this.state.busNumberPrefix).concat(this.state.busNumberDigit)};this.setScannedDataAndRedirect(I)},this.handleBusNumberChange=g=>{4===g.length?this.state.busNumberPrefix.length>2?this.setState({busNumberDigit:g,showBusNumber:!0}):(this.setState({busNumberDigit:g}),dt(this.props.t("prefix_error"),"danger")):this.setState({busNumberDigit:g})},this.handleSelectPrefix=g=>{4==this.state.busNumberDigit.length?this.setState({busNumberPrefix:g,showBusNumber:!0}):this.setState({busNumberPrefix:g})},this.handleFormChange=(g,I,C)=>{if(g&&I&&C&&parseInt(g.stop_id)>0&&parseInt(I.stop_id)>0&&parseInt(C.route_id)){var e,l;this.setState({showFareLoader:!0});const A=this.props.i18n.language,t=null!==(e=null===(l=this.props.scannedData)||void 0===l?void 0:l.bus_number)&&void 0!==e?e:"",n={route_id:parseInt(C.route_id),bus_no:t,source_stop_id:g.stop_id,destination_stop_id:parseInt(I.stop_id),is_ac:this.props.isAcBus},o={"Content-Type":"application/json","Accept-Language":A,Authorization:oA,"Whatsapp-Account":this.props.whatsAppNumber};Qt(cA,"POST",o,n).then((g=>{g.success&&(this.props.setFare(g.data),this.setState({showFareLoader:!1}))})).catch((g=>{this.setState({showFareLoader:!1}),this.props.setFare(io),console.log("Error :: ",g)}))}},this.handleChangeStationEvent=(g,I)=>{g&&I&&parseInt(g.stop_id)>0&&parseInt(I.stop_id)>0&&(this.props.setFare(io),this.props.setRoute())},this.validateInputValues=()=>{this.props&&this.props.fromStation&&this.props.destinationStation&&parseInt(this.props.fromStation.stop_id)>0&&parseInt(this.props.destinationStation.stop_id)>0&&parseInt(this.props.route.route_id)>0&&parseInt(this.props.fare.amount_payable_by_user)>0?this.props.router.navigate(yA("book_summary")):dt(this.props.t("Validation_error_msg"),"danger")},this.setScannedDataAndRedirect=g=>{this.props.setScannedData(g),this.props.router.navigate(yA("dtc_station"))},this.handleSwitchChange=()=>{this.props.setIsAcBus(!this.props.isAcBus)},this.addPassenger=this.addPassenger.bind(this),this.removePassenger=this.removePassenger.bind(this),this.state={showFareLoader:!1,dmrcStartTime:null,dmrcStopTime:null,metroStartTime:null,metroStopTime:null,isChangeRouteButtonEnable:!1,busNumber:"",busNumberDigit:"",busNumberPrefix:"",busNumberPrefixList:["DL1PB","DL1PC","DL1PD","DL51GD","DL51EV"],showBusNumber:!1}}addPassenger(){this.props&&this.props.fromStation&&this.props.destinationStation&&this.props.route&&parseInt(this.props.fromStation.stop_id)>0&&parseInt(this.props.destinationStation.stop_id)>0&&parseInt(this.props.route.route_id)>0?this.props.noOfTicket<6&&this.props.setNoOfTicket(this.props.noOfTicket+1):dt(this.props.t("Validation_error_msg"),"danger")}removePassenger(){this.props&&this.props.fromStation&&this.props.destinationStation&&this.props.route&&parseInt(this.props.fromStation.stop_id)>0&&parseInt(this.props.destinationStation.stop_id)>0&&parseInt(this.props.route.route_id)>0?this.props.noOfTicket>1&&this.props.setNoOfTicket(this.props.noOfTicket-1):dt(this.props.t("Validation_error_msg"),"danger")}setBookingTime(){var g,I,C,e,l,A;if(null!==(g=this.props)&&void 0!==g&&g.metroBookingTimeJson&&null!==(I=this.props)&&void 0!==I&&null!==(C=I.metroBookingTimeJson)&&void 0!==C&&C.n){const[g,I]=this.props.metroBookingTimeJson.n.split("_");this.setState({dmrcStartTime:g,dmrcStopTime:I})}if(null!==(e=this.props)&&void 0!==e&&e.metroBookingTimeJson&&null!==(l=this.props)&&void 0!==l&&null!==(A=l.metroBookingTimeJson)&&void 0!==A&&A.a){const[g,I]=this.props.metroBookingTimeJson.a.split("_");this.setState({metroStartTime:g,metroStopTime:I})}}getTimeWith12format(g){if(!g)return null;const[I,C]=g.split(":"),e=I>=12?"PM":"AM";return"".concat(I>12?I-12:I,":").concat(C," ").concat(e)}componentDidMount(){this.handleFormChange(this.props.fromStation,this.props.destinationStation,this.props.route),this.setBookingTime()}componentDidUpdate(g,I){console.log(I),this.props.isAcBus!==g.isAcBus&&this.handleFormChange(this.props.fromStation,this.props.destinationStation,this.props.route)}render(){const{t:g}=this.props;return(0,Xe.jsx)("div",{className:"container-sm",children:(0,Xe.jsxs)("main",{children:[(0,Xe.jsx)("div",{className:"row my-2",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("div",{className:"card logo-box p-2",children:(0,Xe.jsx)("img",{src:"https://pelocal-dtc-bucket-production.s3.amazonaws.com/dtcImage.png",alt:"DMRC Logo"})})})}),(0,Xe.jsx)("div",{className:"row",children:(0,Xe.jsxs)("div",{className:"gap-2",children:[(0,Xe.jsx)(zt,{setscanneddata:this.setScannedDataAndRedirect,setscannedencryptdata:this.props.setScannedEncryptData}),(0,Xe.jsx)("div",{className:"section-divider",children:(0,Xe.jsx)("span",{children:g("qr_option")})}),(0,Xe.jsx)("h4",{className:"text-center mb-1",children:(0,Xe.jsx)("b",{children:g("bus_number_title")})}),(0,Xe.jsxs)(tt,{children:[(0,Xe.jsx)(tt.Group,{children:(0,Xe.jsx)("div",{className:"row justify-content-start",children:this.state.busNumberPrefixList.map(((g,I)=>(0,Xe.jsx)("div",{className:"col-4",onClick:()=>{this.handleSelectPrefix(g)},children:(0,Xe.jsx)("h5",{className:"text-center",children:(0,Xe.jsx)(ot,{bg:"".concat(this.state.busNumberPrefix===g?"danger":"secondary"),children:g})})},I)))})}),(0,Xe.jsx)(ut,{handleBusNumberChange:this.handleBusNumberChange}),this.state.showBusNumber&&(0,Xe.jsx)("h3",{className:"text-danger text-center m-2",children:"".concat(this.state.busNumberPrefix).concat(this.state.busNumberDigit)}),(0,Xe.jsx)("div",{className:"d-grid mt-2",children:(0,Xe.jsx)(mt,{type:"submit",className:"btn btn-dark-updated text-white",onClick:this.handleBusNumberSubmit,children:g("submit_label")})})]})]})})]})})}}const ro=E((g=>({fromStation:g.bookTicketReducer.fromStation,destinationStation:g.bookTicketReducer.destinationStation,fare:g.bookTicketReducer.fare,noOfTicket:g.bookTicketReducer.noOfTicket,metroType:g.bookTicketReducer.metroType,whatsAppNumber:g.bookTicketReducer.whatsAppNumber,isairportlinedisable:g.bookTicketReducer.isAirportLineDisable,isnormallinedisable:g.bookTicketReducer.isNormalLineDisable,isAirportBookingDisable:g.bookTicketReducer.isAirportBookingDisable,isDMRCBookingDisable:g.bookTicketReducer.isDMRCBookingDisable,isAirportLineTicketAlreadyGen:g.bookTicketReducer.isAirportLineTicketAlreadyGen,airportLineTicketAlreadyGenMsg:g.bookTicketReducer.airportLineTicketAlreadyGenMsg,metroBookingTimeJson:g.bookTicketReducer.metroBookingTimeJson,checksum:g.bookTicketReducer.checksum,bookType:g.bookTicketReducer.bookType,route:g.bookTicketReducer.route,scannedData:g.bookTicketReducer.scannedData,isAcBus:g.bookTicketReducer.isAcBus,disableBookType:g.bookTicketReducer.disableBookType})),{setFrmStation:jl,setDestStation:Pl,setNoOfTicket:Ll,setMetroType:Ml,setFare:Ql,setWhatsappNumber:Dl,setBookType:Tl,setRoute:Ol,setScannedData:ql,setScannedEncryptData:_l,setIsAcBus:gA,setDisableBookType:IA})(WA(so)),bo=[{id:1,question:"How to Pre-Book a Ticket?",answer:"After selecting 'Book Ticket,' click on the 'Book By Stops' option to choose source and destination either from the provided list of stops or by typing the stops in the search bar. Then select on the booking page: the Bus route, Bus type [AC / Non-AC], and the number of tickets to book [Max 6].Ticket details can be viewed on the ticket summary page and desired payment option [Pay With Other Modes (card) / Pay With UPI] can be selected. The ticket details get delivered on the DTC Chatbot, and after reviewing, for payment click on 'Pay Now'.Upon successful payment, the Pre-Booked Ticket gets issued which then gets validated when boarding the bus, either by using the 'Scan Bus QR' option or 'Mark Complete'. The ticket is only valid for 1 day.  "},{id:2,question:"How to Book a Ticket when you're already in the Bus?",answer:"When already aboard the bus, select the 'Scan QR' option from Book Ticket.' Then scan the Bus QR code or manually enter the bus number, which directs to the stops' page. Then select the source and destination stops, either from the provided list of stops or by typing the stop in the search bar. Ticket details can be viewed on the ticket summary page and desired payment option [Pay With Other Modes (card) / Pay With UPI] can be selected. The ticket details get delivered on the DTC Chatbot, and after reviewing, for payment click on 'Pay Now'.Upon successful payment, the Pre-Booked Ticket gets issued which then gets validated when boarding the bus, either by using the 'Scan Bus QR' option or 'Mark Complete'. The ticket is only valid for 1 day and can be checked from check validity option.  "},{id:3,question:"How to search and select for Bus Stops (Source/Destination)?",answer:"After selecting 'Book Ticket,' there will be 2 options available: [Book By Stops / Book By QR] to book a Bus ticket.In the 'Book By Stops' option, select the source and destination either through a provided list or by typing in the search bar.In the 'Book By QR' option, scan the Bus QR code or enter the bus number to be directed to the stops page."},{id:4,question:"How to choose for the Bus Route?",answer:"Upon selecting the destination stop, all available bus routes will be shown along with their respective stops. Bus routes can also be searched in the search bar. The selected details can be edited on the main booking page [Change Route]."},{id:5,question:"What is the maximun number of tickets that can be booked at one time?",answer:"At most 6 tickets can be booked at a time.  "},{id:6,question:"How to review the ticket details?",answer:"The ticket details can be reviewed on the Ticket Summary page and can also go back and edit them. "},{id:7,question:"How to Pay for the ticket?",answer:"After selecting the payment method [Pay With Other Modes / Pay With UPI] from Ticket Summary page, the ticket details gets delivered on the DTC chatbot. Review and proceed with payment by clicking on 'Pay Now.' "},{id:8,question:"What all Payment options are available?",answer:"The customer can pay through Card [Credit/Debit] in Pay With Other Modes option or can Pay By UPI through WhatsApp by slecting the gateway from the list after clicking on 'Pay Now.'"},{id:9,question:"Where will I get the Bus Ticket?",answer:"The Booked ticket gets delivered on DTC WhatsApp Chatbot after successful payment."},{id:10,question:"How to validate the Booked ticket?",answer:"To validate the ticket click on the 'Scan Bus QR' option on the booked ticket and the validated ticket will be issued and can check its validity for the same.Alternatively, by selecting 'Mark Complete' option after boarding the bus. A boarding message then gets delivered."},{id:11,question:"What to do if the booked ticket does not get delivered on WhatsApp?",answer:"In case if the ticket is not delivered, click on the 'Download Ticket' option from the main menu. From a list of tickets booked on that day select the un-delivered ticket. The same gets delivered.    "},{id:12,question:"What is the difference between Booked and Validated Ticket?",answer:"Booked' ticket is delivered after successful payment which has to be Validated to board the bus either byScan Bus QR or Mark Complete.  The Validated ticket gets delivered."},{id:13,question:"How to see the previous transactions in the DTC chatbot?",answer:"Select 'Last Transactions' from the main menu. Last 5 successful transactions in the past 7 days gets delivered.   "}],mo=[{id:1,question:"\u091f\u093f\u0915\u091f \u092a\u094d\u0930\u0940-\u092c\u0941\u0915 \u0915\u0948\u0938\u0947 \u0915\u0930\u0947\u0902?",answer:"\u092c\u0941\u0915 \u091f\u093f\u0915\u091f' \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0928\u0947 \u0915\u0947 \u092c\u093e\u0926, \u0926\u093f\u090f \u0917\u090f \u0938\u094d\u091f\u0949\u092a \u0915\u0940 \u0938\u0942\u091a\u0940 \u0938\u0947 \u092f\u093e \u091f\u093e\u0907\u092a \u0915\u0930\u0915\u0947 \u0938\u094d\u0930\u094b\u0924 \u0914\u0930 \u0917\u0902\u0924\u0935\u094d\u092f \u091a\u0941\u0928\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f '\u0938\u094d\u091f\u0949\u092a \u0926\u094d\u0935\u093e\u0930\u093e \u092c\u0941\u0915 \u0915\u0930\u0947\u0902' \u0935\u093f\u0915\u0932\u094d\u092a \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902\u0964 \u0916\u094b\u091c \u092c\u093e\u0930 \u092e\u0947\u0902 \u0930\u0941\u0915\u0924\u093e \u0939\u0948. \u092b\u093f\u0930 \u092c\u0941\u0915\u093f\u0902\u0917 \u092a\u0943\u0937\u094d\u0920 \u092a\u0930 \u091a\u092f\u0928 \u0915\u0930\u0947\u0902: \u092c\u0938 \u092e\u093e\u0930\u094d\u0917, \u092c\u0938 \u0915\u093e \u092a\u094d\u0930\u0915\u093e\u0930 [\u090f\u0938\u0940/\u0928\u0949\u0928-\u090f\u0938\u0940], \u0914\u0930 \u092c\u0941\u0915 \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f \u091f\u093f\u0915\u091f\u094b\u0902 \u0915\u0940 \u0938\u0902\u0916\u094d\u092f\u093e [\u0905\u0927\u093f\u0915\u0924\u092e 6]\u0964\u091f\u093f\u0915\u091f \u0935\u093f\u0935\u0930\u0923 \u091f\u093f\u0915\u091f \u0938\u093e\u0930\u093e\u0902\u0936 \u092a\u0943\u0937\u094d\u0920 \u092a\u0930 \u0926\u0947\u0916\u093e \u091c\u093e \u0938\u0915\u0924\u093e \u0939\u0948 \u0914\u0930 \u0935\u093e\u0902\u091b\u093f\u0924 \u092d\u0941\u0917\u0924\u093e\u0928 \u0935\u093f\u0915\u0932\u094d\u092a [\u0905\u0928\u094d\u092f \u092e\u094b\u0921 (\u0915\u093e\u0930\u094d\u0921) \u0915\u0947 \u0938\u093e\u0925 \u092d\u0941\u0917\u0924\u093e\u0928 / \u092f\u0942\u092a\u0940\u0906\u0908 \u0915\u0947 \u0938\u093e\u0925 \u092d\u0941\u0917\u0924\u093e\u0928] \u0915\u093e \u091a\u092f\u0928 \u0915\u093f\u092f\u093e \u091c\u093e \u0938\u0915\u0924\u093e \u0939\u0948\u0964 \u091f\u093f\u0915\u091f \u0935\u093f\u0935\u0930\u0923 \u0921\u0940\u091f\u0940\u0938\u0940 \u091a\u0948\u091f\u092c\u0949\u091f \u092a\u0930 \u0935\u093f\u0924\u0930\u093f\u0924 \u0915\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948, \u0914\u0930 \u0938\u092e\u0940\u0915\u094d\u0937\u093e \u0915\u0947 \u092c\u093e\u0926, \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0947 \u0932\u093f\u090f '\u0905\u092d\u0940 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0930\u0947\u0902' \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902\u0964\u0938\u092b\u0932 \u092d\u0941\u0917\u0924\u093e\u0928 \u092a\u0930, \u092a\u094d\u0930\u0940-\u092c\u0941\u0915 \u091f\u093f\u0915\u091f \u091c\u093e\u0930\u0940 \u0915\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948 \u091c\u093f\u0938\u0947 \u092c\u0938 \u092e\u0947\u0902 \u091a\u0922\u093c\u0924\u0947 \u0938\u092e\u092f \u092f\u093e \u0924\u094b \u0909\u092a\u092f\u094b\u0917 \u0915\u0930\u0915\u0947 \u092e\u093e\u0928\u094d\u092f \u0915\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948 '\u0938\u094d\u0915\u0948\u0928 \u092c\u0938 \u0915\u094d\u092f\u0942\u0906\u0930' \u0935\u093f\u0915\u0932\u094d\u092a \u092f\u093e '\u092a\u0942\u0930\u094d\u0923 \u091a\u093f\u0939\u094d\u0928\u093f\u0924 \u0915\u0930\u0947\u0902'\u0964 \u091f\u093f\u0915\u091f \u0915\u0947\u0935\u0932 1 \u0926\u093f\u0928 \u0915\u0947 \u0932\u093f\u090f \u0935\u0948\u0927 \u0939\u0948\u0964  "},{id:2,question:"\u091c\u092c \u0906\u092a \u092a\u0939\u0932\u0947 \u0938\u0947 \u0939\u0940 \u092c\u0938 \u092e\u0947\u0902 \u0939\u094b\u0902 \u0924\u094b \u091f\u093f\u0915\u091f \u0915\u0948\u0938\u0947 \u092c\u0941\u0915 \u0915\u0930\u0947\u0902?",answer:"\u091c\u092c \u0906\u092a \u092a\u0939\u0932\u0947 \u0938\u0947 \u0939\u0940 \u092c\u0938 \u092e\u0947\u0902 \u091a\u0922\u093c \u091a\u0941\u0915\u0947 \u0939\u094b\u0902, \u0924\u094b \u091f\u093f\u0915\u091f \u092c\u0941\u0915 \u0915\u0930\u0947\u0902' \u092e\u0947\u0902 \u0938\u0947 '\u0938\u094d\u0915\u0948\u0928 \u0915\u094d\u092f\u0942\u0906\u0930' \u0935\u093f\u0915\u0932\u094d\u092a \u091a\u0941\u0928\u0947\u0902\u0964' \u092b\u093f\u0930 \u092c\u0938 \u0915\u094d\u092f\u0942\u0906\u0930 \u0915\u094b\u0921 \u0915\u094b \u0938\u094d\u0915\u0948\u0928 \u0915\u0930\u0947\u0902 \u092f\u093e \u092e\u0948\u0928\u094d\u092f\u0941\u0905\u0932 \u0930\u0942\u092a \u0938\u0947 \u0926\u0930\u094d\u091c \u0915\u0930\u0947\u0902 \u092c\u0938 \u0928\u0902\u092c\u0930, \u091c\u094b \u0938\u094d\u091f\u0949\u092a \u0915\u0947 \u092a\u0947\u091c \u092a\u0930 \u0932\u0947 \u091c\u093e\u0924\u093e \u0939\u0948\u0964 \u092b\u093f\u0930 \u0938\u094d\u0930\u094b\u0924 \u0914\u0930 \u0917\u0902\u0924\u0935\u094d\u092f \u0938\u094d\u091f\u0949\u092a \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0947\u0902, \u092f\u093e \u0924\u094b \u0938\u094d\u091f\u0949\u092a \u0915\u0940 \u0926\u0940 \u0917\u0908 \u0938\u0942\u091a\u0940 \u0938\u0947 \u092f\u093e \u091f\u093e\u0907\u092a \u0915\u0930\u0915\u0947 \u0916\u094b\u091c \u092c\u093e\u0930 \u092e\u0947\u0902 \u0930\u0941\u0915\u0947\u0902. \u091f\u093f\u0915\u091f \u0915\u093e \u0935\u093f\u0935\u0930\u0923 \u091f\u093f\u0915\u091f \u0938\u093e\u0930\u093e\u0902\u0936 \u092a\u0943\u0937\u094d\u0920 \u0914\u0930 \u0935\u093e\u0902\u091b\u093f\u0924 \u092d\u0941\u0917\u0924\u093e\u0928 \u0935\u093f\u0915\u0932\u094d\u092a \u092a\u0930 \u0926\u0947\u0916\u093e \u091c\u093e \u0938\u0915\u0924\u093e \u0939\u0948 [\u0905\u0928\u094d\u092f \u0924\u0930\u0940\u0915\u094b\u0902 \u0938\u0947 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0930\u0947\u0902 (\u0915\u093e\u0930\u094d\u0921) / \u092f\u0942\u092a\u0940\u0906\u0908 \u0938\u0947 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0930\u0947\u0902] \u091a\u0941\u0928\u093e \u091c\u093e \u0938\u0915\u0924\u093e \u0939\u0948. \u091f\u093f\u0915\u091f \u0915\u093e \u0935\u093f\u0935\u0930\u0923 \u0921\u0940\u091f\u0940\u0938\u0940 \u091a\u0948\u091f\u092c\u0949\u091f \u092a\u0930 \u0921\u093f\u0932\u0940\u0935\u0930 \u0939\u094b \u091c\u093e\u0924\u093e \u0939\u0948 \u0914\u0930 \u0938\u092e\u0940\u0915\u094d\u0937\u093e \u0915\u0947 \u092c\u093e\u0926 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0947 \u0932\u093f\u090f '\u0905\u092d\u0940 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0930\u0947\u0902' \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902\u0964\u0938\u092b\u0932 \u092d\u0941\u0917\u0924\u093e\u0928 \u092a\u0930, \u092a\u094d\u0930\u0940-\u092c\u0941\u0915 \u091f\u093f\u0915\u091f \u091c\u093e\u0930\u0940 \u0915\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948 \u091c\u093f\u0938\u0947 \u092c\u0938 \u092e\u0947\u0902 \u091a\u0922\u093c\u0924\u0947 \u0938\u092e\u092f \u092f\u093e \u0924\u094b \u0909\u092a\u092f\u094b\u0917 \u0915\u0930\u0915\u0947 \u092e\u093e\u0928\u094d\u092f \u0915\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948 \u0938\u094d\u0915\u0948\u0928 \u092c\u0938 \u0915\u094d\u092f\u0942\u0906\u0930' \u0935\u093f\u0915\u0932\u094d\u092a \u092f\u093e '\u092a\u0942\u0930\u094d\u0923 \u091a\u093f\u0939\u094d\u0928\u093f\u0924 \u0915\u0930\u0947\u0902'\u0964 \u091f\u093f\u0915\u091f \u0915\u0947\u0935\u0932 1 \u0926\u093f\u0928 \u0915\u0947 \u0932\u093f\u090f \u0935\u0948\u0927 \u0939\u0948 \u0914\u0930 \u0907\u0938\u0947 \u091a\u0947\u0915 \u0935\u0948\u0927\u0924\u093e \u0935\u093f\u0915\u0932\u094d\u092a \u0938\u0947 \u091a\u0947\u0915 \u0915\u093f\u092f\u093e \u091c\u093e \u0938\u0915\u0924\u093e \u0939\u0948\u0964  "},{id:3,question:"\u092c\u0938 \u0938\u094d\u091f\u0949\u092a (\u0938\u094d\u0930\u094b\u0924/\u0917\u0902\u0924\u0935\u094d\u092f) \u0915\u0948\u0938\u0947 \u0916\u094b\u091c\u0947\u0902 \u0914\u0930 \u091a\u0941\u0928\u0947\u0902?",answer:"\u092c\u0941\u0915 \u091f\u093f\u0915\u091f' \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0928\u0947 \u0915\u0947 \u092c\u093e\u0926, \u092c\u0938 \u091f\u093f\u0915\u091f \u092c\u0941\u0915 \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f 2 \u0935\u093f\u0915\u0932\u094d\u092a \u0909\u092a\u0932\u092c\u094d\u0927 \u0939\u094b\u0902\u0917\u0947: [\u0938\u094d\u091f\u0949\u092a \u0926\u094d\u0935\u093e\u0930\u093e \u092c\u0941\u0915 \u0915\u0930\u0947\u0902 / \u0915\u094d\u092f\u0942\u0906\u0930 \u0926\u094d\u0935\u093e\u0930\u093e \u092c\u0941\u0915 \u0915\u0930\u0947\u0902]\u0964\u0938\u094d\u091f\u0949\u092a\u094d\u0938 \u0926\u094d\u0935\u093e\u0930\u093e \u092c\u0941\u0915 \u0915\u0930\u0947\u0902' \u0935\u093f\u0915\u0932\u094d\u092a \u092e\u0947\u0902, \u0926\u0940 \u0917\u0908 \u0938\u0942\u091a\u0940 \u0915\u0947 \u092e\u093e\u0927\u094d\u092f\u092e \u0938\u0947 \u092f\u093e \u0916\u094b\u091c \u092c\u093e\u0930 \u092e\u0947\u0902 \u091f\u093e\u0907\u092a \u0915\u0930\u0915\u0947 \u0938\u094d\u0930\u094b\u0924 \u0914\u0930 \u0917\u0902\u0924\u0935\u094d\u092f \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0947\u0902\u0964\u092c\u0941\u0915 \u092c\u093e\u092f \u0915\u094d\u092f\u0942\u0906\u0930' \u0935\u093f\u0915\u0932\u094d\u092a \u092e\u0947\u0902, \u092c\u0938 \u0915\u094d\u092f\u0942\u0906\u0930 \u0915\u094b\u0921 \u0915\u094b \u0938\u094d\u0915\u0948\u0928 \u0915\u0930\u0947\u0902 \u092f\u093e \u0938\u094d\u091f\u0949\u092a \u092a\u0947\u091c \u092a\u0930 \u0928\u093f\u0930\u094d\u0926\u0947\u0936\u093f\u0924 \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f \u092c\u0938 \u0928\u0902\u092c\u0930 \u0926\u0930\u094d\u091c \u0915\u0930\u0947\u0902\u0964"},{id:4,question:"\u092c\u0938 \u0930\u0942\u091f \u0915\u093e \u091a\u092f\u0928 \u0915\u0948\u0938\u0947 \u0915\u0930\u0947\u0902?",answer:"\u0917\u0902\u0924\u0935\u094d\u092f \u0938\u094d\u091f\u0949\u092a \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0928\u0947 \u092a\u0930, \u0938\u092d\u0940 \u0909\u092a\u0932\u092c\u094d\u0927 \u092c\u0938 \u092e\u093e\u0930\u094d\u0917\u094b\u0902 \u0915\u094b \u0909\u0928\u0915\u0947 \u0938\u0902\u092c\u0902\u0927\u093f\u0924 \u0938\u094d\u091f\u0949\u092a \u0915\u0947 \u0938\u093e\u0925 \u0926\u093f\u0916\u093e\u092f\u093e \u091c\u093e\u090f\u0917\u093e\u0964 \u092c\u0938 \u092e\u093e\u0930\u094d\u0917\u094b\u0902 \u0915\u094b \u092d\u0940 \u0916\u094b\u091c\u093e \u091c\u093e \u0938\u0915\u0924\u093e \u0939\u0948\u0916\u094b\u091c \u092c\u093e\u0930 \u092e\u0947\u0902. \u091a\u092f\u0928\u093f\u0924 \u0935\u093f\u0935\u0930\u0923 \u092e\u0941\u0916\u094d\u092f \u092c\u0941\u0915\u093f\u0902\u0917 \u092a\u0943\u0937\u094d\u0920 [\u092e\u093e\u0930\u094d\u0917 \u092c\u0926\u0932\u0947\u0902] \u092a\u0930 \u0938\u0902\u092a\u093e\u0926\u093f\u0924 \u0915\u093f\u092f\u093e \u091c\u093e \u0938\u0915\u0924\u093e \u0939\u0948\u0964"},{id:5,question:"\u090f\u0915 \u0938\u092e\u092f \u092e\u0947\u0902 \u092c\u0941\u0915 \u0915\u093f\u092f\u0947 \u091c\u093e \u0938\u0915\u0928\u0947 \u0935\u093e\u0932\u0947 \u091f\u093f\u0915\u091f\u094b\u0902 \u0915\u0940 \u0905\u0927\u093f\u0915\u0924\u092e \u0938\u0902\u0916\u094d\u092f\u093e \u0915\u094d\u092f\u093e \u0939\u0948?",answer:"\u090f\u0915 \u092c\u093e\u0930 \u092e\u0947\u0902 \u0905\u0927\u093f\u0915\u0924\u092e 6 \u091f\u093f\u0915\u091f \u092c\u0941\u0915 \u0915\u093f\u090f \u091c\u093e \u0938\u0915\u0924\u0947 \u0939\u0948\u0902\u0964"},{id:6,question:"\u091f\u093f\u0915\u091f \u0935\u093f\u0935\u0930\u0923 \u0915\u0940 \u0938\u092e\u0940\u0915\u094d\u0937\u093e \u0915\u0948\u0938\u0947 \u0915\u0930\u0947\u0902?",answer:"\u091f\u093f\u0915\u091f \u0935\u093f\u0935\u0930\u0923 \u0915\u0940 \u0938\u092e\u0940\u0915\u094d\u0937\u093e \u091f\u093f\u0915\u091f \u0938\u093e\u0930\u093e\u0902\u0936 \u092a\u0943\u0937\u094d\u0920 \u092a\u0930 \u0915\u0940 \u091c\u093e \u0938\u0915\u0924\u0940 \u0939\u0948 \u0914\u0930 \u0935\u093e\u092a\u0938 \u091c\u093e\u0915\u0930 \u0909\u0928\u094d\u0939\u0947\u0902 \u0938\u0902\u092a\u093e\u0926\u093f\u0924 \u092d\u0940 \u0915\u093f\u092f\u093e \u091c\u093e \u0938\u0915\u0924\u093e \u0939\u0948\u0964"},{id:7,question:"\u091f\u093f\u0915\u091f \u0915\u093e \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0948\u0938\u0947 \u0915\u0930\u0947\u0902?",answer:"\u091f\u093f\u0915\u091f \u0938\u093e\u0930\u093e\u0902\u0936 \u092a\u0943\u0937\u094d\u0920 \u0938\u0947 \u092d\u0941\u0917\u0924\u093e\u0928 \u0935\u093f\u0927\u093f [\u0905\u0928\u094d\u092f \u092e\u094b\u0921 \u0915\u0947 \u0938\u093e\u0925 \u092d\u0941\u0917\u0924\u093e\u0928 / \u092f\u0942\u092a\u0940\u0906\u0908 \u0915\u0947 \u0938\u093e\u0925 \u092d\u0941\u0917\u0924\u093e\u0928] \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0928\u0947 \u0915\u0947 \u092c\u093e\u0926, \u091f\u093f\u0915\u091f \u0915\u093e \u0935\u093f\u0935\u0930\u0923 \u0921\u0940\u091f\u0940\u0938\u0940 \u092a\u0930 \u0921\u093f\u0932\u0940\u0935\u0930 \u0939\u094b \u091c\u093e\u0924\u093e \u0939\u0948\u0964\u091a\u0948\u091f\u092c\u0949\u091f. \u0938\u092e\u0940\u0915\u094d\u0937\u093e \u0915\u0930\u0947\u0902 \u0914\u0930 '\u0905\u092d\u0940 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0930\u0947\u0902' \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0915\u0947 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0947 \u0932\u093f\u090f \u0906\u0917\u0947 \u092c\u0922\u093c\u0947\u0902\u0964"},{id:8,question:"\u092d\u0941\u0917\u0924\u093e\u0928 \u0935\u093f\u0915\u0932\u094d\u092a \u0915\u094d\u092f\u093e \u0909\u092a\u0932\u092c\u094d\u0927 \u0939\u0948\u0902?",answer:"\u0917\u094d\u0930\u093e\u0939\u0915 \u0915\u093e\u0930\u094d\u0921 [\u0915\u094d\u0930\u0947\u0921\u093f\u091f/\u0921\u0947\u092c\u093f\u091f] \u0915\u0947 \u092e\u093e\u0927\u094d\u092f\u092e \u0938\u0947 \u0905\u0928\u094d\u092f \u092e\u094b\u0921 \u0915\u0947 \u0938\u093e\u0925 \u092d\u0941\u0917\u0924\u093e\u0928 \u0935\u093f\u0915\u0932\u094d\u092a \u092e\u0947\u0902 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0930 \u0938\u0915\u0924\u093e \u0939\u0948 \u092f\u093e \u092f\u0942\u092a\u0940\u0906\u0908 \u0915\u0947 \u092e\u093e\u0927\u094d\u092f\u092e \u0938\u0947 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0930 \u0938\u0915\u0924\u093e \u0939\u0948'\u0905\u092d\u0940 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0930\u0947\u0902' \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0928\u0947 \u0915\u0947 \u092c\u093e\u0926 \u0938\u0942\u091a\u0940 \u0938\u0947 \u0917\u0947\u091f\u0935\u0947 \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0915\u0947 \u0935\u094d\u0939\u093e\u091f\u094d\u0938\u090f\u092a \u0915\u0930\u0947\u0902\u0964"},{id:9,question:"\u092e\u0941\u091d\u0947 \u092c\u0938 \u091f\u093f\u0915\u091f \u0915\u0939\u093e\u0902 \u092e\u093f\u0932\u0947\u0917\u093e?",answer:"\u0938\u092b\u0932 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0947 \u092c\u093e\u0926 \u092c\u0941\u0915 \u0915\u093f\u092f\u093e \u0917\u092f\u093e \u091f\u093f\u0915\u091f \u0921\u0940\u091f\u0940\u0938\u0940 \u0935\u094d\u0939\u093e\u091f\u094d\u0938\u090f\u092a \u091a\u0948\u091f\u092c\u0949\u091f \u092a\u0930 \u0921\u093f\u0932\u0940\u0935\u0930 \u0939\u094b \u091c\u093e\u0924\u093e \u0939\u0948\u0964"},{id:10,question:"\u092c\u0941\u0915 \u0915\u093f\u090f \u0917\u090f \u091f\u093f\u0915\u091f \u0915\u094b \u0915\u0948\u0938\u0947 \u0938\u0924\u094d\u092f\u093e\u092a\u093f\u0924 \u0915\u0930\u0947\u0902?",answer:"\u091f\u093f\u0915\u091f \u0915\u094b \u092e\u093e\u0928\u094d\u092f \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f \u092c\u0941\u0915 \u0915\u093f\u090f \u0917\u090f \u091f\u093f\u0915\u091f \u092a\u0930 '\u0938\u094d\u0915\u0948\u0928 \u092c\u0938 \u0915\u094d\u092f\u0942\u0906\u0930' \u0935\u093f\u0915\u0932\u094d\u092a \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902 \u0914\u0930 \u092e\u093e\u0928\u094d\u092f \u091f\u093f\u0915\u091f \u091c\u093e\u0930\u0940 \u0915\u093f\u092f\u093e \u091c\u093e\u090f\u0917\u093e \u0914\u0930 \u0906\u092a \u0907\u0938\u0915\u0940 \u0935\u0948\u0927\u0924\u093e \u0915\u0940 \u091c\u093e\u0902\u091a \u0915\u0930 \u0938\u0915\u0924\u0947 \u0939\u0948\u0902\u0964\u0935\u0948\u0915\u0932\u094d\u092a\u093f\u0915 \u0930\u0942\u092a \u0938\u0947, \u092c\u0938 \u092e\u0947\u0902 \u091a\u0922\u093c\u0928\u0947 \u0915\u0947 \u092c\u093e\u0926 '\u092e\u093e\u0930\u094d\u0915 \u0915\u092e\u094d\u092a\u094d\u0932\u0940\u091f' \u0935\u093f\u0915\u0932\u094d\u092a \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0915\u0947\u0964 \u092b\u093f\u0930 \u090f\u0915 \u092c\u094b\u0930\u094d\u0921\u093f\u0902\u0917 \u0938\u0902\u0926\u0947\u0936 \u0921\u093f\u0932\u0940\u0935\u0930 \u0939\u094b \u091c\u093e\u0924\u093e \u0939\u0948\u0964"},{id:11,question:"\u0905\u0917\u0930 \u092c\u0941\u0915 \u0915\u093f\u092f\u093e \u0917\u092f\u093e \u091f\u093f\u0915\u091f \u0935\u094d\u0939\u093e\u091f\u094d\u0938\u090f\u092a \u092a\u0930 \u0921\u093f\u0932\u0940\u0935\u0930 \u0928 \u0939\u094b \u0924\u094b \u0915\u094d\u092f\u093e \u0915\u0930\u0947\u0902?",answer:"\u092f\u0926\u093f \u091f\u093f\u0915\u091f \u0935\u093f\u0924\u0930\u093f\u0924 \u0928\u0939\u0940\u0902 \u0939\u0941\u0906 \u0939\u0948, \u0924\u094b \u092e\u0941\u0916\u094d\u092f \u092e\u0947\u0928\u0942 \u0938\u0947 '\u0921\u093e\u0909\u0928\u0932\u094b\u0921 \u091f\u093f\u0915\u091f' \u0935\u093f\u0915\u0932\u094d\u092a \u092a\u0930 \u0915\u094d\u0932\u093f\u0915 \u0915\u0930\u0947\u0902\u0964 \u0915\u0940 \u0938\u0942\u091a\u0940 \u0938\u0947\u0909\u0938 \u0926\u093f\u0928 \u092c\u0941\u0915 \u0915\u093f\u090f \u0917\u090f \u091f\u093f\u0915\u091f \u092c\u093f\u0928\u093e \u0921\u093f\u0932\u0940\u0935\u0930 \u0939\u0941\u090f \u091f\u093f\u0915\u091f \u0915\u093e \u091a\u092f\u0928 \u0915\u0930\u0947\u0902\u0964 \u0935\u0939\u0940 \u0935\u093f\u0924\u0930\u093f\u0924 \u0915\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948\u0964"},{id:12,question:"\u092c\u0941\u0915 \u0915\u093f\u090f \u0917\u090f \u0914\u0930 \u092e\u093e\u0928\u094d\u092f \u091f\u093f\u0915\u091f \u0915\u0947 \u092c\u0940\u091a \u0915\u094d\u092f\u093e \u0905\u0902\u0924\u0930 \u0939\u0948?",answer:"\u092c\u0941\u0915 \u0915\u093f\u092f\u093e \u0917\u092f\u093e' \u091f\u093f\u0915\u091f \u0938\u092b\u0932 \u092d\u0941\u0917\u0924\u093e\u0928 \u0915\u0947 \u092c\u093e\u0926 \u0935\u093f\u0924\u0930\u093f\u0924 \u0915\u093f\u092f\u093e \u091c\u093e\u0924\u093e \u0939\u0948 \u091c\u093f\u0938\u0947 \u092c\u0938 \u092e\u0947\u0902 \u091a\u0922\u093c\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f \u0938\u0924\u094d\u092f\u093e\u092a\u093f\u0924 \u0915\u0930\u0928\u093e \u0939\u094b\u0924\u093e \u0939\u0948\u092c\u0938 \u0915\u094d\u092f\u0942\u0906\u0930 \u0938\u094d\u0915\u0948\u0928 \u0915\u0930\u0947\u0902 \u092f\u093e \u092a\u0942\u0930\u094d\u0923 \u091a\u093f\u0939\u094d\u0928\u093f\u0924 \u0915\u0930\u0947\u0902\u0964 \u0935\u0948\u0927 \u091f\u093f\u0915\u091f \u0935\u093f\u0924\u0930\u093f\u0924 \u0939\u094b \u091c\u093e\u0924\u093e \u0939\u0948\u0964"},{id:13,question:"\u0921\u0940\u091f\u0940\u0938\u0940 \u091a\u0948\u091f\u092c\u0949\u091f \u092e\u0947\u0902 \u092a\u093f\u091b\u0932\u0947 \u0932\u0947\u0928\u0926\u0947\u0928 \u0915\u0948\u0938\u0947 \u0926\u0947\u0916\u0947\u0902?",answer:"\u092e\u0941\u0916\u094d\u092f \u092e\u0947\u0928\u0942 \u0938\u0947 '\u092a\u0942\u0930\u094d\u0935 \u092f\u093e\u0924\u094d\u0930\u093e \u0935\u093f\u0935\u0930\u0923' \u091a\u0941\u0928\u0947\u0902\u0964 \u092a\u093f\u091b\u0932\u0947 7 \u0926\u093f\u0928\u094b\u0902 \u092e\u0947\u0902 \u0905\u0902\u0924\u093f\u092e 5 \u0938\u092b\u0932 \u0932\u0947\u0928\u0926\u0947\u0928 \u0935\u093f\u0924\u0930\u093f\u0924 \u0939\u094b \u091c\u093e\u0924\u0947 \u0939\u0948\u0902\u0964"}],Zo=E((g=>({whatsAppNumber:g.bookTicketReducer.whatsAppNumber})),null)((()=>{const[I,C]=(0,g.useState)(!1),[e,l]=(0,g.useState)([]);console.log(C);const{t:A,i18n:t}=BI(),n=qC(),o=t.language;(0,g.useEffect)((()=>{l("hi"==o?mo:bo)}),[]);return(0,Xe.jsxs)("div",{className:"container-sm",children:[(0,Xe.jsx)("div",{className:"customBox",children:(0,Xe.jsx)("div",{className:"col-12 from-to-pop-up",children:(0,Xe.jsxs)("div",{className:"row mb-0 stationBox",children:[(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsxs)("div",{className:"d-flex justify-content-between lh-sm p-2 py-3 ",children:[(0,Xe.jsx)("h5",{className:"my-1",children:A("dtc_qna")}),(0,Xe.jsx)("button",{type:"button",id:"close-button",className:"btn-close","aria-label":"Close",onClick:()=>{n(yA("home"))}})]})}),(0,Xe.jsx)("div",{className:"col-12 ps-0 pe-0",children:(0,Xe.jsx)("hr",{className:"my-0"})})]})})}),I?(0,Xe.jsx)("div",{className:"row searchSec background-white",children:(0,Xe.jsx)("div",{className:"col-12 my-5 ps-0 pe-0 bg-white",children:(0,Xe.jsx)("div",{className:"text-center",children:(0,Xe.jsx)("div",{className:"spinner-grow text-primary",role:"status"})})})}):(0,Xe.jsx)("div",{className:"mt-3",children:e.map((g=>(0,Xe.jsxs)("div",{children:[(0,Xe.jsxs)("h5",{children:[g.id,". ",g.question]}),(0,Xe.jsx)("p",{children:g.answer})]},g.id)))})]})})),uo=()=>{const g=B((g=>g.bookTicketReducer.isLinkExpire)),{t:I}=BI(),C=g=>{let I;g&&(I="&text=".concat(encodeURIComponent("hi"))),window.location.href=I?"".concat(lA).concat(I):lA};return(0,Xe.jsx)("div",{className:"container-sm",children:(0,Xe.jsx)("main",{children:(0,Xe.jsxs)("div",{className:"center-container",children:[(0,Xe.jsx)("div",{className:"row my-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("form",{className:"needs-validation",children:(0,Xe.jsx)("div",{className:"row g-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("ul",{className:"list-group",children:(0,Xe.jsx)("li",{className:"d-flex justify-content-between",children:(0,Xe.jsx)("div",{className:"sad-box",children:(0,Xe.jsx)("img",{className:"x",src:no})})})})})})})})}),(0,Xe.jsx)("div",{className:"row my-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("form",{className:"needs-validation",children:(0,Xe.jsx)("div",{className:"row g-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("ul",{className:"list-group",children:(0,Xe.jsx)("li",{className:"d-flex justify-content-between",children:(0,Xe.jsx)("div",{className:"label-text1",children:(0,Xe.jsx)("p",{className:"text-wrapper",children:I(g?"link_exp_msg_title":"error_msg_title")})})})})})})})})}),(0,Xe.jsx)("div",{className:"row my-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("form",{className:"needs-validation",children:(0,Xe.jsx)("div",{className:"row g-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("ul",{className:"list-group",children:(0,Xe.jsx)("li",{className:"d-flex justify-content-between",children:(0,Xe.jsx)("div",{className:"label-text2",children:(0,Xe.jsx)("p",{className:"we-re-unable-to-find",children:I(g?"link_exp_msg_description":"error_msg_description")})})})})})})})})}),(0,Xe.jsx)("div",{className:"row my-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("div",{children:(0,Xe.jsx)("form",{className:"needs-validation",children:(0,Xe.jsx)("div",{className:"row g-3",children:(0,Xe.jsx)("div",{className:"col-12",children:(0,Xe.jsx)("ul",{className:"list-group",children:(0,Xe.jsx)("li",{className:"d-flex justify-content-between",children:g?(0,Xe.jsx)("button",{className:"btn btn-danger box-1 mt-3 btn-sm",onClick:g=>{g.preventDefault(),C(!0)},children:I("continue")}):(0,Xe.jsx)("button",{className:"btn btn-danger box-1 mt-3 btn-sm",onClick:g=>{g.preventDefault(),C(!1)},children:I("continue")})})})})})})})})})]})})})};const Go=function(){return(0,Xe.jsxs)("div",{className:"App",children:[(0,Xe.jsx)(CA,{}),(0,Xe.jsx)(Ge,{children:(0,Xe.jsxs)(se,{children:[(0,Xe.jsx)(de,{path:pA.home,element:(0,Xe.jsx)(Dt,{}),name:"home"}),(0,Xe.jsx)(de,{path:pA.home_new,element:(0,Xe.jsx)(Dt,{}),name:"home_new"}),(0,Xe.jsx)(de,{path:pA.book_by_qr,element:(0,Xe.jsx)(ro,{}),name:"dtc_route"}),(0,Xe.jsx)(de,{path:pA.dtc_route,element:(0,Xe.jsx)(on,{}),name:"dtc_route"}),(0,Xe.jsx)(de,{path:pA.dtc_station,element:(0,Xe.jsx)(sn,{}),name:"dtc_station"}),(0,Xe.jsx)(de,{path:pA.book_summary,element:(0,Xe.jsx)(lo,{}),name:"book_summary"}),(0,Xe.jsx)(de,{path:pA.validate_ticket,element:(0,Xe.jsx)(Ao,{}),name:"validate_ticket"}),(0,Xe.jsx)(de,{path:pA.validate_ticket_success,element:(0,Xe.jsx)(to,{}),name:"validate_ticket_success"}),(0,Xe.jsx)(de,{path:pA.quike_book,element:(0,Xe.jsx)(co,{}),name:"quike_book"}),(0,Xe.jsx)(de,{path:pA.dtc_qna,element:(0,Xe.jsx)(Zo,{}),name:"dtc_qna"}),(0,Xe.jsx)(de,{path:pA.error,element:(0,Xe.jsx)(uo,{}),name:"error"})]})})]})};e.createRoot(document.getElementById("root")).render((0,Xe.jsx)(g.StrictMode,{children:(0,Xe.jsx)(L,{store:eC,children:(0,Xe.jsx)(Go,{})})})),q()})()})();
//# sourceMappingURL=main.441f1ef8.js.map